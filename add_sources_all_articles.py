#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import requests
from requests.auth import HTTPBasicAuth
import json
import re
import time
from datetime import datetime

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ WordPress API
WP_API_URL = "https://ecopackpro.ru/wp-json/wp/v2"
WP_USERNAME = "rtep1976@me.com"
WP_APP_PASSWORD = "7EKI VWpH 96dg VI3H ovlI hI4E"

# –°–ª–æ–≤–∞—Ä—å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –ø–æ —Ç–µ–º–∞—Ç–∏–∫–∞–º
SOURCES_BY_THEME = {
    # –ö—É—Ä—å–µ—Ä—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã
    '–∫—É—Ä—å–µ—Ä—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã': [
        {'title': '–ì–û–°–¢ –† 51760-2001 - –ü–∞–∫–µ—Ç—ã –∏–∑ –ø–æ–ª–∏–º–µ—Ä–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –ø–æ–ª–∏–º–µ—Ä–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–∏', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –¢–∏–ø—ã –∫—É—Ä—å–µ—Ä—Å–∫–∏—Ö –ø–∞–∫–µ—Ç–æ–≤', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã —É–ø–∞–∫–æ–≤–∫–∏ –¥–ª—è –ª–æ–≥–∏—Å—Ç–∏–∫–∏', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ü–æ—á—Ç–æ–≤—ã–µ –∫–æ—Ä–æ–±–∫–∏
    '–ø–æ—á—Ç–æ–≤—ã–µ –∫–æ—Ä–æ–±–∫–∏': [
        {'title': '–ü—Ä–∞–≤–∏–ª–∞ –ø–æ—á—Ç–æ–≤–æ–π –ø–µ—Ä–µ—Å—ã–ª–∫–∏ - –ü–æ—á—Ç–∞ –†–æ—Å—Å–∏–∏', 'url': 'https://www.pochta.ru/'},
        {'title': '–ì–û–°–¢ –† 53636-2009 - –£–ø–∞–∫–æ–≤–∫–∞ –∏–∑ –∫–∞—Ä—Ç–æ–Ω–∞', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã —É–ø–∞–∫–æ–≤–∫–∏ –¥–ª—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–π –ø–æ—á—Ç—ã', 'url': 'https://www.unipack.ru/'},
        {'title': '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–æ—á—Ç–æ–≤–æ–π —É–ø–∞–∫–æ–≤–∫–µ', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # Zip lock –ø–∞–∫–µ—Ç—ã
    'zip lock': [
        {'title': '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É–ø–∞–∫–æ–≤–∫–µ –ø–∏—â–µ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –ø–æ–ª–∏–º–µ—Ä–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–∏', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - Zip lock —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –ø–∏—â–µ–≤–æ–π —É–ø–∞–∫–æ–≤–∫–∏ - –†–æ—Å–ø–æ—Ç—Ä–µ–±–Ω–∞–¥–∑–æ—Ä', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ó–∏–ø –ø–∞–∫–µ—Ç—ã
    '–∑–∏–ø –ø–∞–∫–µ—Ç—ã': [
        {'title': '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É–ø–∞–∫–æ–≤–∫–µ –ø–∏—â–µ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –ø–æ–ª–∏–º–µ—Ä–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–∏', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - Zip lock —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –ø–∏—â–µ–≤–æ–π —É–ø–∞–∫–æ–≤–∫–∏ - –†–æ—Å–ø–æ—Ç—Ä–µ–±–Ω–∞–¥–∑–æ—Ä', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ö–æ–Ω–≤–µ—Ä—Ç—ã —Å –≤–æ–∑–¥—É—à–Ω–æ–π –ø–æ–¥—É—à–∫–æ–π
    '–∫–æ–Ω–≤–µ—Ä—Ç—ã —Å –≤–æ–∑–¥—É—à–Ω–æ–π –ø–æ–¥—É—à–∫–æ–π': [
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã —É–ø–∞–∫–æ–≤–∫–∏ –¥–ª—è —Ö—Ä—É–ø–∫–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∑–∞—â–∏—Ç–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–∏', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –í–æ–∑–¥—É—à–Ω–æ-–ø—É–∑—ã—Ä—á–∞—Ç–∞—è –ø–ª–µ–Ω–∫–∞', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É–ø–∞–∫–æ–≤–∫–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ö–æ–Ω–≤–µ—Ä—Ç—ã —Å –≤–æ–∑–¥—É—à–Ω–æ–π –ø—Ä–æ—Å–ª–æ–π–∫–æ–π
    '–∫–æ–Ω–≤–µ—Ä—Ç—ã —Å –≤–æ–∑–¥—É—à–Ω–æ–π –ø—Ä–æ—Å–ª–æ–π–∫–æ–π': [
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã —É–ø–∞–∫–æ–≤–∫–∏ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∑–∞—â–∏—Ç–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–∏', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –í–æ–∑–¥—É—à–Ω–æ-–ø—É–∑—ã—Ä—á–∞—Ç–∞—è –ø–ª–µ–Ω–∫–∞', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É–ø–∞–∫–æ–≤–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ö—Ä–∞—Ñ—Ç–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã
    '–∫—Ä–∞—Ñ—Ç–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã': [
        {'title': '–ì–û–°–¢ –† 53636-2009 - –£–ø–∞–∫–æ–≤–∫–∞ –∏–∑ –∫–∞—Ä—Ç–æ–Ω–∞', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–≠–∫–æ–ª–æ–≥–∏—á–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞ - —Ç—Ä–µ–Ω–¥—ã 2025', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –ö—Ä–∞—Ñ—Ç-–±—É–º–∞–≥–∞', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —É–ø–∞–∫–æ–≤–∫–∏', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ö—Ä–∞—Ñ—Ç–æ–≤—ã–µ –∫–æ–Ω–≤–µ—Ä—Ç—ã
    '–∫—Ä–∞—Ñ—Ç–æ–≤—ã–µ –∫–æ–Ω–≤–µ—Ä—Ç—ã': [
        {'title': '–ì–û–°–¢ –† 53636-2009 - –£–ø–∞–∫–æ–≤–∫–∞ –∏–∑ –∫–∞—Ä—Ç–æ–Ω–∞', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–≠–∫–æ–ª–æ–≥–∏—á–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞ - —Ç—Ä–µ–Ω–¥—ã 2025', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –ö—Ä–∞—Ñ—Ç-–±—É–º–∞–≥–∞', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —É–ø–∞–∫–æ–≤–∫–∏', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ü—É–∑—ã—Ä—á–∞—Ç—ã–µ –ø–∞–∫–µ—Ç—ã –í–ü–ü
    '–ø—É–∑—ã—Ä—á–∞—Ç—ã–µ –ø–∞–∫–µ—Ç—ã': [
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã —É–ø–∞–∫–æ–≤–∫–∏ –¥–ª—è —Ö—Ä—É–ø–∫–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∑–∞—â–∏—Ç–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–∏', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –í–æ–∑–¥—É—à–Ω–æ-–ø—É–∑—ã—Ä—á–∞—Ç–∞—è –ø–ª–µ–Ω–∫–∞', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É–ø–∞–∫–æ–≤–∫–µ —Ö—Ä—É–ø–∫–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ö–æ—Ä–æ–±–∫–∏ –¥–ª—è –ø–æ—á—Ç—ã/–æ—Ç–ø—Ä–∞–≤–∫–∏
    '–∫–æ—Ä–æ–±–∫–∏ –¥–ª—è': [
        {'title': '–ü—Ä–∞–≤–∏–ª–∞ –ø–æ—á—Ç–æ–≤–æ–π –ø–µ—Ä–µ—Å—ã–ª–∫–∏ - –ü–æ—á—Ç–∞ –†–æ—Å—Å–∏–∏', 'url': 'https://www.pochta.ru/'},
        {'title': '–ì–û–°–¢ –† 53636-2009 - –£–ø–∞–∫–æ–≤–∫–∞ –∏–∑ –∫–∞—Ä—Ç–æ–Ω–∞', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã —É–ø–∞–∫–æ–≤–∫–∏ –¥–ª—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–π –ø–æ—á—Ç—ã', 'url': 'https://www.unipack.ru/'},
        {'title': '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–æ—á—Ç–æ–≤–æ–π —É–ø–∞–∫–æ–≤–∫–µ', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –°–∞–º–æ–∫–ª–µ—è—â–∏–µ—Å—è –∫–∞—Ä–º–∞–Ω—ã
    '—Å–∞–º–æ–∫–ª–µ—è—â–∏–µ—Å—è –∫–∞—Ä–º–∞–Ω—ã': [
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã —É–ø–∞–∫–æ–≤–∫–∏ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –æ—Ñ–∏—Å–∞', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –°–∞–º–æ–∫–ª–µ—è—â–∏–µ—Å—è –º–∞—Ç–µ—Ä–∏–∞–ª—ã', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É–ø–∞–∫–æ–≤–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ê–Ω—Ç–∏–º–∞–≥–Ω–∏—Ç–Ω–∞—è –ø–ª–æ–º–±–∞
    '–∞–Ω—Ç–∏–º–∞–≥–Ω–∏—Ç–Ω–∞—è –ø–ª–æ–º–±–∞': [
        {'title': '–§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –∑–∞–∫–æ–Ω –æ –∑–∞—â–∏—Ç–µ –ø—Ä–∏–±–æ—Ä–æ–≤ —É—á–µ—Ç–∞', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∑–∞—â–∏—Ç—ã –æ—Ç –º–∞–≥–Ω–∏—Ç–Ω–æ–≥–æ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –ó–∞—â–∏—Ç–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–ª–æ–º–±–∏—Ä–æ–≤–∞–Ω–∏—é –ø—Ä–∏–±–æ—Ä–æ–≤ —É—á–µ—Ç–∞', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ü–ª–æ–º–±–∏—Ä–∞—Ç–æ—Ä
    '–ø–ª–æ–º–±–∏—Ä–∞—Ç–æ—Ä': [
        {'title': '–§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –∑–∞–∫–æ–Ω –æ –∑–∞—â–∏—Ç–µ –ø—Ä–∏–±–æ—Ä–æ–≤ —É—á–µ—Ç–∞', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –ø–ª–æ–º–±–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–ª–æ–º–±–∏—Ä–æ–≤–∞–Ω–∏—è', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–ª–æ–º–±–∏—Ä–æ–≤–∞–Ω–∏—é –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ù–æ–º–µ—Ä–Ω—ã–µ –ø–ª–æ–º–±—ã
    '–Ω–æ–º–µ—Ä–Ω—ã–µ –ø–ª–æ–º–±—ã': [
        {'title': '–§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –∑–∞–∫–æ–Ω –æ –∑–∞—â–∏—Ç–µ –ø—Ä–∏–±–æ—Ä–æ–≤ —É—á–µ—Ç–∞', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–ª–æ–º–±', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –ù—É–º–µ—Ä–∞—Ü–∏—è –ø–ª–æ–º–±', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –Ω—É–º–µ—Ä–∞—Ü–∏–∏ –ø–ª–æ–º–±', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ë–µ–ª—ã–µ –∫—Ä–∞—Ñ—Ç –ø–∞–∫–µ—Ç—ã
    '–±–µ–ª—ã–µ –∫—Ä–∞—Ñ—Ç': [
        {'title': '–ì–û–°–¢ –† 53636-2009 - –£–ø–∞–∫–æ–≤–∫–∞ –∏–∑ –∫–∞—Ä—Ç–æ–Ω–∞', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–≠–∫–æ–ª–æ–≥–∏—á–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞ - —Ç—Ä–µ–Ω–¥—ã 2025', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –ö—Ä–∞—Ñ—Ç-–±—É–º–∞–≥–∞', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —É–ø–∞–∫–æ–≤–∫–∏', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–µ zip lock
    '–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ zip': [
        {'title': '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É–ø–∞–∫–æ–≤–∫–µ –ø–∏—â–µ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –ø–æ–ª–∏–º–µ—Ä–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–∏', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –ø–∏—â–µ–≤–æ–π —É–ø–∞–∫–æ–≤–∫–∏ - –†–æ—Å–ø–æ—Ç—Ä–µ–±–Ω–∞–¥–∑–æ—Ä', 'url': 'https://rospotrebnadzor.ru/'}
    ],
    
    # –ú–∞—Ç–æ–≤—ã–µ zip lock
    '–º–∞—Ç–æ–≤—ã–µ zip': [
        {'title': '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É–ø–∞–∫–æ–≤–∫–µ –ø–∏—â–µ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
        {'title': '–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –ø–æ–ª–∏–º–µ—Ä–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–∏', 'url': 'https://www.unipack.ru/'},
        {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –ú–∞—Ç–æ–≤–∞—è —É–ø–∞–∫–æ–≤–∫–∞', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
        {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –ø–∏—â–µ–≤–æ–π —É–ø–∞–∫–æ–≤–∫–∏ - –†–æ—Å–ø–æ—Ç—Ä–µ–±–Ω–∞–¥–∑–æ—Ä', 'url': 'https://rospotrebnadzor.ru/'}
    ]
}

class UniversalSourcesAdder:
    def __init__(self):
        self.auth = HTTPBasicAuth(WP_USERNAME, WP_APP_PASSWORD)
        self.headers = {'Content-Type': 'application/json'}
        self.results = []
        self.start_time = datetime.now()
    
    def check_url_status(self, url, timeout=15):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ URL"""
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',
            'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
            'Accept-Language': 'ru-RU,ru;q=0.9,en-US;q=0.8,en;q=0.7',
        }
        
        try:
            session = requests.Session()
            response = session.get(
                url, 
                headers=headers, 
                timeout=timeout, 
                allow_redirects=True,
                verify=True
            )
            
            return response.status_code == 200, response.status_code
                
        except Exception as e:
            return False, None
    
    def get_sources_for_theme(self, article_title):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–µ–º–∞—Ç–∏–∫–∏ —Å—Ç–∞—Ç—å–∏"""
        article_lower = article_title.lower()
        
        # –ò—â–µ–º –ø–æ–¥—Ö–æ–¥—è—â—É—é —Ç–µ–º–∞—Ç–∏–∫—É
        for theme, sources in SOURCES_BY_THEME.items():
            if theme in article_lower:
                return sources
        
        # –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—â–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
        return [
            {'title': '–§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –∑–∞–∫–æ–Ω –æ–± —É–ø–∞–∫–æ–≤–∫–µ –∏ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–µ —Ç–æ–≤–∞—Ä–æ–≤', 'url': 'https://www.consultant.ru/document/cons_doc_LAW_19109/'},
            {'title': '–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –ø–æ–ª–∏–º–µ—Ä–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–∏', 'url': 'https://www.unipack.ru/'},
            {'title': '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —É–ø–∞–∫–æ–≤–∫–∏ - –¢–∏–ø—ã —É–ø–∞–∫–æ–≤–æ—á–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤', 'url': 'https://ru.wikipedia.org/wiki/–ü–æ–ª–∏—ç—Ç–∏–ª–µ–Ω–æ–≤—ã–π_–ø–∞–∫–µ—Ç'},
            {'title': '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã —É–ø–∞–∫–æ–≤–æ—á–Ω–æ–π –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ - –†–æ—Å–ø–æ—Ç—Ä–µ–±–Ω–∞–¥–∑–æ—Ä', 'url': 'https://rospotrebnadzor.ru/'}
        ]
    
    def verify_sources(self, sources):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤"""
        verified_sources = []
        
        for source in sources:
            is_valid, status = self.check_url_status(source['url'])
            if is_valid:
                verified_sources.append(source)
            
            # –ü–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
            time.sleep(1)
        
        return verified_sources
    
    def get_post(self, post_id):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å—Ç–∞ —á–µ—Ä–µ–∑ API"""
        url = f"{WP_API_URL}/posts/{post_id}"
        try:
            response = requests.get(url, auth=self.auth, headers=self.headers)
            if response.status_code == 200:
                return response.json()
            else:
                print(f"‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å—Ç–∞ {post_id}: {response.status_code}")
                return None
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å—Ç–∞ {post_id}: {e}")
            return None
    
    def find_insertion_point(self, content):
        """–ü–æ–∏—Å–∫ –º–µ—Å—Ç–∞ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ —Ä–∞–∑–¥–µ–ª–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤"""
        # –ò—â–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ –±–ª–æ–∫–∏ –ø–µ—Ä–µ–¥ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏
        markers = [
            '–ú—ã –ø–æ–º–æ–∂–µ–º:',
            '–ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º:',
            '–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:',
            '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ'
        ]
        
        for marker in markers:
            pos = content.find(marker)
            if pos != -1:
                # –ò—â–µ–º –∫–æ–Ω–µ—Ü —ç—Ç–æ–≥–æ –±–ª–æ–∫–∞ - –∏—â–µ–º </p> –ø–æ—Å–ª–µ –≤—Å–µ—Ö –ø—É–Ω–∫—Ç–æ–≤
                after_marker = content[pos:]
                last_p_end = after_marker.rfind('</p>')
                if last_p_end != -1:
                    insertion_point = pos + last_p_end + 4  # +4 –¥–ª—è –¥–ª–∏–Ω—ã </p>
                    return insertion_point
        
        # –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –±–ª–æ–∫–∏, –∏—â–µ–º –∫–æ–Ω—Ç–∞–∫—Ç—ã
        contact_pos = content.find('–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ')
        if contact_pos != -1:
            return contact_pos
        
        return None
    
    def create_sources_section(self, sources):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤"""
        if not sources:
            return ""
        
        sources_html = """
<hr />

<h2>üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏</h2>

<p>–ü—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Å–ª–µ–¥—É—é—â–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:</p>

<ul>
"""
        
        for source in sources:
            sources_html += f'<li><a href="{source["url"]}" target="_blank" rel="noopener noreferrer nofollow">{source["title"]}</a></li>\n'
        
        sources_html += """</ul>

<p><em>–í—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ —Ä–µ—Å—É—Ä—Å—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.</em></p>

<hr />
"""
        
        return sources_html
    
    def update_post(self, post_id, content):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞ —á–µ—Ä–µ–∑ API"""
        url = f"{WP_API_URL}/posts/{post_id}"
        
        data = {
            'content': content
        }
        
        try:
            response = requests.post(url, auth=self.auth, headers=self.headers, json=data)
            if response.status_code == 200:
                return response.json()
            else:
                print(f"‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞ {post_id}: {response.status_code}")
                return None
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞ {post_id}: {e}")
            return None
    
    def add_sources_to_article(self, post_id, article_title):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –≤ —Å—Ç–∞—Ç—å—é"""
        print(f"\nüìù –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—å–∏ ID {post_id}: {article_title}")
        
        # –ü–æ–ª—É—á–∞–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–ª—è —Ç–µ–º–∞—Ç–∏–∫–∏
        potential_sources = self.get_sources_for_theme(article_title)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∏
        verified_sources = self.verify_sources(potential_sources)
        
        if not verified_sources:
            print(f"‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–ª—è —Å—Ç–∞—Ç—å–∏ {post_id}")
            self.results.append({
                'id': post_id,
                'title': article_title,
                'status': 'failed',
                'reason': '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤',
                'sources_count': 0
            })
            return False
        
        # –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å—Ç
        post = self.get_post(post_id)
        
        if not post:
            print(f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å—Ç {post_id}")
            self.results.append({
                'id': post_id,
                'title': article_title,
                'status': 'failed',
                'reason': '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å—Ç',
                'sources_count': 0
            })
            return False
        
        # –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç
        content = post['content']['rendered']
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
        if 'üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏' in content:
            print(f"‚ö†Ô∏è  –í —Å—Ç–∞—Ç—å–µ {post_id} —É–∂–µ –µ—Å—Ç—å —Ä–∞–∑–¥–µ–ª –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤")
            self.results.append({
                'id': post_id,
                'title': article_title,
                'status': 'skipped',
                'reason': '–ò—Å—Ç–æ—á–Ω–∏–∫–∏ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã',
                'sources_count': 0
            })
            return True
        
        # –ò—â–µ–º –º–µ—Å—Ç–æ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏
        insertion_point = self.find_insertion_point(content)
        
        if insertion_point is None:
            print(f"‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω–æ –º–µ—Å—Ç–æ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ —Å—Ç–∞—Ç—å–µ {post_id}")
            self.results.append({
                'id': post_id,
                'title': article_title,
                'status': 'failed',
                'reason': '–ù–µ –Ω–∞–π–¥–µ–Ω–æ –º–µ—Å—Ç–æ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏',
                'sources_count': 0
            })
            return False
        
        # –°–æ–∑–¥–∞–µ–º —Ä–∞–∑–¥–µ–ª –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
        sources_section = self.create_sources_section(verified_sources)
        
        if not sources_section:
            print(f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Ä–∞–∑–¥–µ–ª –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–ª—è —Å—Ç–∞—Ç—å–∏ {post_id}")
            self.results.append({
                'id': post_id,
                'title': article_title,
                'status': 'failed',
                'reason': '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Ä–∞–∑–¥–µ–ª –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤',
                'sources_count': 0
            })
            return False
        
        # –í—Å—Ç–∞–≤–ª—è–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç
        new_content = (
            content[:insertion_point] + 
            sources_section + 
            content[insertion_point:]
        )
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Å—Ç —á–µ—Ä–µ–∑ API
        updated_post = self.update_post(post_id, new_content)
        
        if updated_post:
            print(f"‚úÖ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Å—Ç–∞—Ç—å—é {post_id} ({len(verified_sources)} –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)")
            self.results.append({
                'id': post_id,
                'title': article_title,
                'status': 'success',
                'reason': '–ò—Å—Ç–æ—á–Ω–∏–∫–∏ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã',
                'sources_count': len(verified_sources),
                'sources': verified_sources
            })
            return True
        else:
            print(f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—å—é {post_id}")
            self.results.append({
                'id': post_id,
                'title': article_title,
                'status': 'failed',
                'reason': '–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ—Å—Ç',
                'sources_count': 0
            })
            return False
    
    def process_all_articles(self):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Å—Ç–∞—Ç–µ–π"""
        print("=" * 80)
        print("üìö –î–û–ë–ê–í–õ–ï–ù–ò–ï –ò–°–¢–û–ß–ù–ò–ö–û–í –í–û –í–°–ï –°–¢–ê–¢–¨–ò")
        print("=" * 80)
        
        # –°–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç–µ–π –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        articles = [
            (7907, "–∫—É—Ä—å–µ—Ä—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã"),
            (7908, "–ø–æ—á—Ç–æ–≤—ã–µ –∫–æ—Ä–æ–±–∫–∏"),
            (7909, "–ó–∏–ø –ø–∞–∫–µ—Ç—ã"),
            (7910, "Zip lock –ø–∞–∫–µ—Ç—ã —Å –±–µ–≥—É–Ω–∫–æ–º: —É–¥–æ–±–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤"),
            (7911, "–ö–æ–Ω–≤–µ—Ä—Ç—ã —Å –≤–æ–∑–¥—É—à–Ω–æ–π –ø–æ–¥—É—à–∫–æ–π –¥–ª—è —Ö—Ä—É–ø–∫–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤"),
            (7912, "–ö–æ–Ω–≤–µ—Ä—Ç—ã —Å –≤–æ–∑–¥—É—à–Ω–æ–π –ø—Ä–æ—Å–ª–æ–π–∫–æ–π –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤"),
            (7913, "–ö—Ä–∞—Ñ—Ç–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã —Å –≤–æ–∑–¥—É—à–Ω–æ–π –ø–æ–¥—É—à–∫–æ–π –¥–ª—è –±–∏–∑–Ω–µ—Å–∞: –∫–∞–∫ –≤—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª"),
            (7914, "–ö—É—Ä—å–µ—Ä—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ"),
            (7915, "–ö—É—Ä—å–µ—Ä—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã –Ω–æ–º–µ—Ä–Ω—ã–µ"),
            (7916, "–ö—É—Ä—å–µ—Ä—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã —á–µ—Ä–Ω–æ-–±–µ–ª—ã–µ"),
            (7917, "–ö—É—Ä—å–µ—Ä—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã —Å –∫–∞—Ä–º–∞–Ω–æ–º"),
            (7918, "Zip lock –ø–∞–∫–µ—Ç—ã –º–∞—Ç–æ–≤—ã–µ"),
            (7919, "Zip lock –ø–∞–∫–µ—Ç—ã –æ–ø—Ç–æ–º"),
            (7920, "–ö—Ä–∞—Ñ—Ç–æ–≤—ã–µ –∫–æ–Ω–≤–µ—Ä—Ç—ã"),
            (7921, "–ü—É–∑—ã—Ä—á–∞—Ç—ã–µ –ø–∞–∫–µ—Ç—ã –í–ü–ü"),
            (7922, "–ö–æ—Ä–æ–±–∫–∏ –¥–ª—è –ø–æ—á—Ç—ã"),
            (7923, "–ö–æ—Ä–æ–±–∫–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏"),
            (7924, "–°–∞–º–æ–∫–ª–µ—è—â–∏–µ—Å—è –∫–∞—Ä–º–∞–Ω—ã"),
            (7925, "–ê–Ω—Ç–∏–º–∞–≥–Ω–∏—Ç–Ω–∞—è –ø–ª–æ–º–±–∞"),
            (7926, "–ù–∞–∫–ª–µ–π–∫–∞ –ø–ª–æ–º–±–∞ –∞–Ω—Ç–∏–º–∞–≥–Ω–∏—Ç"),
            (7927, "–ü–ª–æ–º–±–∏—Ä–∞—Ç–æ—Ä –¥–ª—è –±–æ—á–µ–∫"),
            (7928, "–ù–æ–º–µ—Ä–Ω—ã–µ –ø–ª–æ–º–±—ã –Ω–∞–∫–ª–µ–π–∫–∏"),
            (7929, "Zip lock –ø–∞–∫–µ—Ç—ã —Å –±–µ–ª–æ–π –ø–æ–ª–æ—Å–æ–π"),
            (7930, "–ë–µ–ª—ã–µ –∫—Ä–∞—Ñ—Ç –ø–∞–∫–µ—Ç—ã —Å –ø—É–∑—ã—Ä—á–∞—Ç–æ–π –ø–ª—ë–Ω–∫–æ–π"),
            (7931, "–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–µ zip lock –ø–∞–∫–µ—Ç—ã"),
            (7932, "–ö—É–ø–∏—Ç—å –∫—É—Ä—å–µ—Ä—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã —Å –Ω–æ–º–µ—Ä–Ω—ã–º —à—Ç—Ä–∏—Ö-–∫–æ–¥–æ–º"),
            (7933, "–ó–∞–∫–∞–∑–∞—Ç—å –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –∫—É—Ä—å–µ—Ä—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã –æ–ø—Ç–æ–º"),
            (7934, "–ö—É—Ä—å–µ—Ä—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã —á–µ—Ä–Ω–æ-–±–µ–ª—ã–µ —Å –∫–∞—Ä–º–∞–Ω–æ–º —Ü–µ–Ω–∞"),
            (7935, "–ú–∞—Ç–æ–≤—ã–µ zip lock –ø–∞–∫–µ—Ç—ã —Å –±–µ–≥—É–Ω–∫–æ–º 10√ó15"),
            (7936, "–ö—É–ø–∏—Ç—å –æ–ø—Ç–æ–º zip lock –ø–∞–∫–µ—Ç—ã –º–∞—Ç–æ–≤—ã–µ 30 –º–∫–º"),
            (7937, "–ö—Ä–∞—Ñ—Ç –∫–æ–Ω–≤–µ—Ä—Ç—ã —Å –≤–æ–∑–¥—É—à–Ω–æ–π –ø–æ–¥—É—à–∫–æ–π F/3"),
            (7938, "–ü–æ—á—Ç–æ–≤—ã–µ –∫–æ—Ä–æ–±–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ S 260√ó170√ó80"),
            (7939, "–ü–æ—á—Ç–æ–≤—ã–µ –∫–æ—Ä–æ–±–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ XL 530√ó360√ó220"),
            (7940, "–ö—É–ø–∏—Ç—å —Å–∞–º–æ–∫–ª–µ—è—â–∏–µ—Å—è –∫–∞—Ä–º–∞–Ω—ã SD –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤"),
            (7941, "–ê–Ω—Ç–∏–º–∞–≥–Ω–∏—Ç–Ω—ã–µ –Ω–∞–∫–ª–µ–π–∫–∏ –¥–ª—è –≤–æ–¥—è–Ω—ã—Ö —Å—á—ë—Ç—á–∏–∫–æ–≤"),
            (7942, "–ê–Ω—Ç–∏–º–∞–≥–Ω–∏—Ç–Ω–∞—è –ø–ª–æ–º–±–∞ —Ü–µ–Ω–∞ –∑–∞ 100 —à—Ç—É–∫"),
            (7943, "–ü–ª–æ–º–±–∏—Ä–∞—Ç–æ—Ä –¥–ª—è –µ–≤—Ä–æ–±–æ—á–µ–∫ 2 –¥—é–π–º–∞"),
            (7944, "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ–ø–ª–æ–º–±–∏—Ä–æ–≤–∞–Ω–∏—è –±–æ—á–µ–∫ ¬æ –¥—é–π–º–∞"),
            (7945, "–ö—É—Ä—å–µ—Ä—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã —á–µ—Ä–Ω–æ-–±–µ–ª—ã–µ –±–µ–∑ –ª–æ–≥–æ—Ç–∏–ø–∞ –ê4"),
            (7946, "–ö—É—Ä—å–µ—Ä—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –¥–ª—è –æ–¥–µ–∂–¥—ã"),
            (7947, "–ö—É—Ä—å–µ—Ä—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã –¥–ª—è –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤ Ozon"),
            (7948, "–ü–æ—á—Ç–æ–≤—ã–µ –∫–æ—Ä–æ–±–∫–∏ —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º –Ω–∞ –∑–∞–∫–∞–∑"),
            (7949, "–ó–∏–ø –ø–∞–∫–µ—Ç—ã —Å –±–µ–≥—É–Ω–∫–æ–º –∫—É–ø–∏—Ç—å –ú–æ—Å–∫–≤–∞"),
            (7950, "–ú–∞—Ç–æ–≤—ã–µ zip lock –ø–∞–∫–µ—Ç—ã –¥–ª—è —á–∞—è"),
            (7951, "Zip lock –ø–∞–∫–µ—Ç—ã —Å –ø–æ–¥–≤–µ—Å–æ–º"),
            (7952, "–ë–µ–ª—ã–µ –∫—Ä–∞—Ñ—Ç-–ø–∞–∫–µ—Ç—ã —Å –ø—É–∑—ã—Ä—á–∞—Ç–æ–π –ø–ª—ë–Ω–∫–æ–π –æ–ø—Ç–æ–º"),
            (7953, "–ü–ª–æ—Å–∫–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç—ã —Å –≤–æ–∑–¥—É—à–Ω–æ–π –ø–æ–¥—É—à–∫–æ–π –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤"),
            (7954, "–ü–∞–∫–µ—Ç—ã –∏–∑ –≤–æ–∑–¥—É—à–Ω–æ-–ø—É–∑—ã—Ä—å–∫–æ–≤–æ–π –ø–ª—ë–Ω–∫–∏ –æ–ø—Ç–æ–º"),
            (7955, "–ê–Ω—Ç–∏–º–∞–≥–Ω–∏—Ç–Ω—ã–µ –ø–ª–æ–º–±—ã –¥–ª—è –≥–∞–∑–æ–≤—ã—Ö —Å—á—ë—Ç—á–∏–∫–æ–≤"),
            (7956, "–°–∞–º–æ–∫–ª–µ—è—â–∏–µ—Å—è –∫–∞—Ä–º–∞–Ω—ã –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö")
        ]
        
        success_count = 0
        failed_count = 0
        skipped_count = 0
        
        for i, (post_id, title) in enumerate(articles, 1):
            print(f"\n[{i}/50] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—å–∏ ID {post_id}")
            
            result = self.add_sources_to_article(post_id, title)
            
            if result:
                success_count += 1
            elif self.results[-1]['status'] == 'skipped':
                skipped_count += 1
            else:
                failed_count += 1
            
            # –ü–∞—É–∑–∞ –º–µ–∂–¥—É —Å—Ç–∞—Ç—å—è–º–∏
            time.sleep(2)
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç—á–µ—Ç
        self.generate_report(success_count, failed_count, skipped_count)
        
        return success_count, failed_count, skipped_count
    
    def generate_report(self, success_count, failed_count, skipped_count):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞"""
        end_time = datetime.now()
        duration = end_time - self.start_time
        
        print("\n" + "=" * 80)
        print("üìä –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢")
        print("=" * 80)
        print(f"‚è±Ô∏è  –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {duration}")
        print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {success_count}")
        print(f"‚ö†Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ (—É–∂–µ –µ—Å—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏): {skipped_count}")
        print(f"‚ùå –û—à–∏–±–æ–∫: {failed_count}")
        print(f"üìù –í—Å–µ–≥–æ —Å—Ç–∞—Ç–µ–π: {len(self.results)}")
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
        report_filename = f"sources_addition_report_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json"
        
        with open(report_filename, 'w', encoding='utf-8') as f:
            json.dump({
                'timestamp': datetime.now().isoformat(),
                'duration': str(duration),
                'summary': {
                    'total': len(self.results),
                    'success': success_count,
                    'skipped': skipped_count,
                    'failed': failed_count
                },
                'results': self.results
            }, f, ensure_ascii=False, indent=2)
        
        print(f"\nüìÑ –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω: {report_filename}")
        
        # –í—ã–≤–æ–¥–∏–º –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å—Ç–∞—Ç—å–∏
        if failed_count > 0:
            print("\n‚ùå –ü–†–û–ë–õ–ï–ú–ù–´–ï –°–¢–ê–¢–¨–ò:")
            for result in self.results:
                if result['status'] == 'failed':
                    print(f"   ID {result['id']}: {result['title']} - {result['reason']}")
        
        # –í—ã–≤–æ–¥–∏–º —É—Å–ø–µ—à–Ω—ã–µ —Å—Ç–∞—Ç—å–∏
        if success_count > 0:
            print(f"\n‚úÖ –£–°–ü–ï–®–ù–û –û–ë–†–ê–ë–û–¢–ê–ù–ù–´–ï –°–¢–ê–¢–¨–ò ({success_count}):")
            for result in self.results:
                if result['status'] == 'success':
                    print(f"   ID {result['id']}: {result['title']} ({result['sources_count']} –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)")

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    adder = UniversalSourcesAdder()
    success, failed, skipped = adder.process_all_articles()
    
    if success > 0:
        print(f"\nüéâ –ó–ê–î–ê–ß–ê –í–´–ü–û–õ–ù–ï–ù–ê! –î–æ–±–∞–≤–ª–µ–Ω—ã –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –≤ {success} —Å—Ç–∞—Ç–µ–π")
    else:
        print("\n‚ùå –ù–ï –£–î–ê–õ–û–°–¨ –î–û–ë–ê–í–ò–¢–¨ –ò–°–¢–û–ß–ù–ò–ö–ò –ù–ò –í –û–î–ù–£ –°–¢–ê–¢–¨–Æ")

if __name__ == "__main__":
    main()
