function createCookie(e,t,a){var o,a=a?((o=new Date).setTime(o.getTime()+24*a*60*60*1e3),"; expires="+o.toGMTString()):"";document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+a+"; path=/"}function readCookie(e){for(var t=encodeURIComponent(e)+"=",a=document.cookie.split(";"),o=0;o<a.length;o++){for(var r=a[o];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return decodeURIComponent(r.substring(t.length,r.length))}return null}function eraseCookie(e){createCookie(e,"",-1)}!function(o){"use strict";o(function(){var e,t="clearfy";function a(){var e=o(".js-redirect-manager-item").first().clone();e.find("input").val(""),o(".redirect-manager-list").append(e)}"function"==typeof o(".clearfy-color-input").wpColorPicker&&clearfy_settings.color_picker_enable&&o(".clearfy-color-input").wpColorPicker(),o(".js-clearfy-rest-api-list-button").on("click",function(){o(".js-clearfy-rest-api-list").slideToggle()}),o(".js-wpshop-news").length&&jQuery.get("https://wpshop.tech/api/clearfy.php",function(e){e&&e.html&&o(".js-wpshop-news").html(e.html)}),o(".js-clearfy-clear-log").on("click",function(){var e,t=o(this);confirm("Are you sure?")&&(t.attr("disabled",!0).text("process..."),e={action:"clearfy_clear_log",_wpnonce:t.data("nonce")},jQuery.post(ajaxurl,e,function(e){"ok"==e&&(t.attr("disabled",!1).text("OK"),o(".clearfy-table-404").remove())}))}),o(".js-clearfy-remove-lockout").on("click",function(){var t=o(this),e=(t.attr("disabled",!0),{action:"clearfy_remove_lockout",lockout_ip:t.data("ip"),_wpnonce:t.data("nonce")});jQuery.post(ajaxurl,e,function(e){"ok"==e&&(t.attr("disabled",!1),t.parents("tr").remove())})}),o(".js-clearfy-remove-license").on("click",function(){var e=o(this);confirm("Are you sure?")&&(e.attr("disabled",!0).text("process..."),e={action:"clearfy_remove_license",_wpnonce:e.data("nonce")},jQuery.post(ajaxurl,e,function(e){"ok"==e&&window.location.reload()}))}),o(".js-clearfy-transliterate-existing-slugs").on("click",function(){var t=o(this),e=(t.attr("disabled",!0),{action:"clearfy_transliterate_existing_slugs",_wpnonce:t.data("nonce")});jQuery.post(ajaxurl,e,function(e){"ok"==e&&(t.attr("disabled",!1),alert("Done!"))})}),o(".js-import-settings-clearfy").on("click",function(){var e=o(this);return confirm("Are you sure?")&&(e={action:"wpshop_plugin_import_settings",import_settings:o("textarea[name=import_settings]").val(),import_settings_name:o("input[name=import_settings_name]").val(),_wpnonce:e.data("nonce")},jQuery.post(ajaxurl,e,function(e){"ok"==e?(createCookie("plugin_import_settings_success","1"),window.location.reload()):alert(e)})),!1}),o(document).on("click",".js-redirect-manager-add",function(){a()}),o(document).on("click",".js-redirect-manager-delete",function(){1<o(".js-redirect-manager-item").length?o(this).parent().slideUp(100,function(){o(this).remove()}):o(this).parent().find("input").val("")}),o(document).bind("change",".js-redirect-manager-item:last input:first",function(){""!=o(".js-redirect-manager-item:last input:first").val()&&a(),o(".js-redirect-manager-item input").unbind()}),o(".pseudo-checkbox").on("click",function(){var e=o(this).next();("redirect_from_http_to_https"!=e.attr("id")||e.is(":checked")||confirm("Вы уверенны, что Ваш сайт поддерживает https?"))&&(o(this).toggleClass("checked"),e.is(":checked")?e.prop("checked",!1):e.prop("checked",!0))}),o(".pseudo-checkbox-hidden").on("change",function(){o(this).prev().toggleClass("checked")}),o(".pseudo-checkbox-hidden").on("focus",function(){o(this).prev().addClass("focused")}),o(".pseudo-checkbox-hidden").on("blur",function(){o(this).prev().removeClass("focused")}),o(".js-wpshop-instruction-expand").click(function(){o(".js-wpshop-instruction-body").slideToggle()}),null!=readCookie("tab-"+t)&&(e=readCookie("tab-"+t),o(".js-"+t+" #"+e).length&&(o(".js-wpshop-tab-wrapper a").removeClass("wpshop-tab-active"),o(".js-"+t+" #tab-"+e).addClass("wpshop-tab-active"),jQuery(".js-wpshop-tab-item").removeClass("active"),jQuery("#"+e).addClass("active"))),o(".js-"+t).on("click",".js-wpshop-tab-wrapper a",function(){return jQuery(".js-wpshop-tab-wrapper").find("a").removeClass("wpshop-tab-active"),jQuery(this).addClass("wpshop-tab-active"),createCookie("tab-"+t,jQuery(this).attr("id").replace("tab-","")),jQuery(".js-wpshop-tab-item").removeClass("active"),jQuery("#"+jQuery(this).attr("id").replace("tab-","")).addClass("active"),!1}),jQuery(".js-clearfy-recommend").click(function(){jQuery(".js-clearfy-form").find(":checkbox").prop("checked",!1),o(".pseudo-checkbox").removeClass("checked"),jQuery(".clearfy-recommend").parents(".option-field").find("input").prop("checked",!0),jQuery(".clearfy-recommend").parents(".option-field").find(".pseudo-checkbox").addClass("checked")}),jQuery(".js-clearfy-enable").click(function(){jQuery(".js-clearfy-form").find(":checkbox").prop("checked",!0),jQuery(".js-clearfy-form").find(".auto-enable-false").find(":checkbox").prop("checked",!1),o(".pseudo-checkbox").addClass("checked"),jQuery(".js-clearfy-form").find(".auto-enable-false").find(".pseudo-checkbox").prop("checked",!1),jQuery(".js-clearfy-form").find(".auto-enable-false").find(".pseudo-checkbox").removeClass("checked")}),jQuery(".js-clearfy-disable").click(function(){jQuery(".js-clearfy-form").find(":checkbox").prop("checked",!1),o(".pseudo-checkbox").removeClass("checked")})})}(jQuery),jQuery(function(t){"use strict";var a,e=clearfy_settings.i18n||{};t(".js-upload-avatar").on("click",function(){a||(a=wp.media.frames.file_frame=wp.media({title:e.choose_avatar,button:{text:e.choose_avatar},multiple:!1})).on("select",function(){var e=a.state().get("selection").first().toJSON();t("#disable_gravatar_avatar_url").val(e.url)}),a.open()})}),jQuery(document).ready(function(a){var o=clearfy_settings.i18n||{};let e=a("#clearfy-local-avatars-upload"),r,c=!1,n;function i(e,t){const a=t.get("control");var o=e.get("width"),e=e.get("height");let r=parseInt(a.params.width,10),c=parseInt(a.params.height,10);var n=r/c,t=(t.set("canSkipCrop",!a.mustBeCropped(!1,!1,r,c,o,e)),r),i=c,n=(n<o/e?(c=e,r=c*n):(r=o,c=r/n),(o-r)/2),s=(e-c)/2;return{handles:!0,keys:!0,instance:!0,persistent:!0,imageWidth:o,imageHeight:e,minWidth:t>r?r:t,minHeight:i>c?c:i,x1:n,y1:s,x2:r+n,y2:c+s,aspectRatio:r+":"+c}}function s(e){t(),jQuery.post(ajaxurl,{action:"clearfy_set_user_avatar",media_id:e,user_id:jQuery("#clearfy_local_avatars_user_id").val(),can_crop:n,nonce:jQuery("#_wpnonce_clearfy_local_avatars").val()}).done(function(e){""!==e&&(jQuery(".user-profile-picture img").replaceWith(e),jQuery(".js-clearfy-local-avatars-remove").show())}).always(function(){l()})}function t(){c=!0,e.addClass("disabled")}function l(){c=!1,e.removeClass("disabled")}e.on("click",function(e){if(!c){n=a(this).data("can-crop");const t={id:"control-id",params:{flex_width:!1,flex_height:!1,width:200,height:200},mustBeCropped:function(e,t,a,o,r,c){return 1===n&&(r!==a||c!==o)}};(r=wp.media({button:{text:o.select,close:!1},states:[new wp.media.controller.Library({title:o.choose_avatar,library:wp.media.query({type:"image"}),multiple:!1,date:!1,priority:20,suggestedWidth:200,suggestedHeight:200}),new wp.media.controller.CustomizeImageCropper({imgSelectOptions:i,control:t})]})).on("cropped",function(e){s(e.id)}),r.on("skippedcrop",function(e){s(e.id)}),r.on("select",function(){const e=r.state().get("selection").first().toJSON();n&&(t.params.width!==e.width||t.params.height!==e.height||t.params.flex_width||t.params.flex_height)?r.setState("cropper"):(e.dst_width=e.width,e.dst_height=e.height,s(e.id),r.close())}),r.open()}}),a(".js-clearfy-local-avatars-remove").on("click",function(e){c||(t(),jQuery.post(ajaxurl,{action:"clearfy_remove_user_avatar",user_id:jQuery("#clearfy_local_avatars_user_id").val(),nonce:jQuery("#_wpnonce_clearfy_local_avatars").val()}).done(function(e){""!==e&&(jQuery(".user-profile-picture img").replaceWith(e),jQuery(".js-clearfy-local-avatars-remove").hide())}).always(function(){l()}))})});