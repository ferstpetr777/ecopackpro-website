!function($,_undefined){"use strict";var _window=window,_document=document,_navigator=navigator,isPlainObject=$.isPlainObject;var max=Math.max,min=Math.min,pow=Math.pow;if(isPlainObject(_window.$ush)){return}
_window.$ush=_window.$ush||{};var ua=_navigator.userAgent.toLowerCase(),base64Chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',fromCharCode=String.fromCharCode;$ush.ua=ua;$ush.isMacOS=/(Mac|iPhone|iPod|iPad)/i.test(_navigator.platform);$ush.isFirefox=ua.indexOf('firefox')>-1;$ush.isSafari=/^((?!chrome|android).)*safari/i.test(ua);$ush.isTouchend=('ontouchend' in _document);$ush.safariVersion=function(){var self=this;if(self.isSafari){return self.parseInt((ua.match(/version\/([\d]+)/i)||[])[1])}
return 0}
$ush.fn=function(fn){if($.isFunction(fn)){fn()}};$ush.isUndefined=function(value){return ''+_undefined===''+value};$ush.isRtl=function(){return this.toString(_document.body.className).split(/\p{Zs}/u).indexOf('rtl')>-1};$ush.isNode=function(node){return!!node&&node.nodeType};$ush.uniqid=function(prefix){return(prefix||'')+Math.random().toString(36).substr(2,9)};$ush.utf8Decode=function(data){var tmp_arr=[],i=0,ac=0,c1=0,c2=0,c3=0;data+='';while(i<data.length){c1=data.charCodeAt(i);if(c1<128){tmp_arr[ac ++]=fromCharCode(c1);i ++}else if(c1>191&&c1<224){c2=data.charCodeAt(i+1);tmp_arr[ac ++]=fromCharCode(((c1&31)<<6)|(c2&63));i+=2}else{c2=data.charCodeAt(i+1);c3=data.charCodeAt(i+2);tmp_arr[ac ++]=fromCharCode(((c1&15)<<12)|((c2&63)<<6)|(c3&63));i+=3}}
return tmp_arr.join('')};$ush.utf8Encode=function(data){if(data===null||this.isUndefined(data)){return ''}
var string=(''+data),utftext='',start,end,stringl=0;start=end=0;stringl=string.length;for(var n=0;n<stringl;n ++){var c1=string.charCodeAt(n);var enc=null;if(c1<128){end ++}else if(c1>127&&c1<2048){enc=fromCharCode((c1>>6)|192)+fromCharCode((c1&63)|128)}else{enc=fromCharCode((c1>>12)|224)+fromCharCode(((c1>>6)&63)|128)+fromCharCode((c1&63)|128)}
if(enc!==null){if(end>start){utftext+=string.slice(start,end)}
utftext+=enc;start=end=n+1}}
if(end>start){utftext+=string.slice(start,stringl)}
return utftext};$ush.base64Decode=function(data){var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,dec='',tmp_arr=[],self=this;if(!data){return data}
data+='';do{h1=base64Chars.indexOf(data.charAt(i ++));h2=base64Chars.indexOf(data.charAt(i ++));h3=base64Chars.indexOf(data.charAt(i ++));h4=base64Chars.indexOf(data.charAt(i ++));bits=h1<<18|h2<<12|h3<<6|h4;o1=bits>>16&0xff;o2=bits>>8&0xff;o3=bits&0xff;if(h3==64){tmp_arr[ac ++]=fromCharCode(o1)}else if(h4==64){tmp_arr[ac ++]=fromCharCode(o1,o2)}else{tmp_arr[ac ++]=fromCharCode(o1,o2,o3)}}while(i<data.length);return self.utf8Decode(tmp_arr.join(''))};$ush.base64Encode=function(data){var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,enc='',tmp_arr=[],self=this;if(!data){return data}
data=self.utf8Encode(''+data);do{o1=data.charCodeAt(i ++);o2=data.charCodeAt(i ++);o3=data.charCodeAt(i ++);bits=o1<<16|o2<<8|o3;h1=bits>>18&0x3f;h2=bits>>12&0x3f;h3=bits>>6&0x3f;h4=bits&0x3f;tmp_arr[ac ++]=base64Chars.charAt(h1)+base64Chars.charAt(h2)+base64Chars.charAt(h3)+base64Chars.charAt(h4)}while(i<data.length);enc=tmp_arr.join('');var r=data.length%3;return(r?enc.slice(0,r-3):enc)+'==='.slice(r||3)};$ush.stripTags=function(input){return $ush.toString(input).replace(/(<([^>]+)>)/ig,'').replace('"','&quot;')};$ush.rawurldecode=function(str){return decodeURIComponent(''+str)};$ush.rawurlencode=function(str){return encodeURIComponent(''+str).replace(/!/g,'%21').replace(/'/g,'%27').replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/\*/g,'%2A')};$ush.timeout=function(fn,delay){var handle={},start=new Date().getTime(),requestAnimationFrame=_window.requestAnimationFrame;function loop(){var current=new Date().getTime(),delta=current-start;delta>=delay?fn.call():handle.value=requestAnimationFrame(loop)}
handle.value=requestAnimationFrame(loop);return handle};$ush.clearTimeout=function(handle){if(isPlainObject(handle)){handle=handle.value}
if($.isNumeric(handle)){_window.cancelAnimationFrame(handle)}};$ush.throttle=function(fn,wait,no_trailing,debounce_mode){var self=this;if(!$.isFunction(fn)){return $.noop}
if(!$.isNumeric(wait)){wait=0}
if(typeof no_trailing!=='boolean'){no_trailing=_undefined}
var last_exec=0,timeout,context,args;return function(){context=this;args=arguments;var elapsed=+new Date()-last_exec;function exec(){last_exec=+new Date();fn.apply(context,args)}
function clear(){timeout=_undefined}
if(debounce_mode&&!timeout){exec()}
timeout&&self.clearTimeout(timeout);if(self.isUndefined(debounce_mode)&&elapsed>wait){exec()}else if(no_trailing!==!0){timeout=self.timeout(debounce_mode?clear:exec,self.isUndefined(debounce_mode)?wait-elapsed:wait)}}};$ush.debounce=function(fn,wait,at_begin){var self=this;return self.isUndefined(at_begin)?self.throttle(fn,wait,_undefined,!1):self.throttle(fn,wait,at_begin!==!1)};$ush.debounce_fn_1ms=$ush.debounce($ush.fn,1);$ush.debounce_fn_10ms=$ush.debounce($ush.fn,10);$ush.parseInt=function(value){value=parseInt(value,10);return!isNaN(value)?value:0};$ush.parseFloat=function(value){value=parseFloat(value);return!isNaN(value)?value:0};$ush.limitValueByRange=function(value,minValue,maxValue){return $ush.parseFloat(min(maxValue,max(minValue,value)))};$ush.toArray=function(data){try{data=[].slice.call(data||[])}catch(err){console.error(err);data=[]}
return data};$ush.toString=function(value){var self=this;if(self.isUndefined(value)||value===null){return ''}
else if(isPlainObject(value)||$.isArray(value)){return self.rawurlencode(JSON.stringify(value))}
return ''+value};$ush.toPlainObject=function(value){var self=this;try{value=JSON.parse(self.rawurldecode(''+value)||'{}')}catch(err){}
if(!isPlainObject(value)){value={}}
return value};$ush.toLowerCase=function(value){return(''+value).toLowerCase()};$ush.clone=function(_object,_default){return $.extend(!0,{},_default||{},_object||{})};$ush.escapePcre=function(value){return this.toString(value).replace(/[.*+?^${}()|\:[\]\\]/g,'\\$&')};$ush.removeSpaces=function(text){return(''+text).replace(/\p{Zs}/gu,'')};$ush.$rect=function(node){return this.isNode(node)?node.getBoundingClientRect():{}};$ush.setCaretPosition=function(node,position){var self=this;if(!self.isNode(node)){return}
if(self.isUndefined(position)){position=node.value.length}
if(node.createTextRange){var range=node.createTextRange();range.move('character',position);range.select()}else{if(node.selectionStart){node.focus();node.setSelectionRange(position,position)}else{node.focus()}}};$ush.copyTextToClipboard=function(text){var self=this;try{var textarea=_document.createElement('textarea');textarea.value=self.toString(text);textarea.setAttribute('readonly','');textarea.setAttribute('css','position:absolute;top:-9999px;left:-9999px');_document.body.append(textarea);textarea.select();_document.execCommand('copy');if(_window.getSelection){_window.getSelection().removeAllRanges()}else if(_document.selection){_document.selection.empty()}
textarea.remove();return!0}catch(err){return!1}};$ush.storage=function(namespace){if(namespace=$ush.toString(namespace)){namespace+='_'}
var _localStorage=_window.localStorage;return{set:function(key,value){_localStorage.setItem(namespace+key,value)},get:function(key){return _localStorage.getItem(namespace+key)},remove:function(key){_localStorage.removeItem(namespace+key)}}};$ush.setCookie=function(name,value,expiry){var date=new Date()
date.setTime(date.getTime()+(expiry*86400000));_document.cookie=name+'='+value+';expires='+date.toUTCString()+';path=/'};$ush.getCookie=function(name){name+='='
var decodedCookie=decodeURIComponent(_document.cookie),cookies=decodedCookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=cookies[i];while(cookie.charAt(0)==' '){cookie=cookie.substring(1)}
if(cookie.indexOf(name)==0){return cookie.substring(name.length,cookie.length)}}
return null};$ush.removeCookie=function(name){var self=this;if(self.getCookie(name)!==null){self.setCookie(name,1,-1)}};$ush.mixinEvents={on:function(eventType,handler,one){var self=this;if(self.$$events===_undefined){self.$$events={}}
if(self.$$events[eventType]===_undefined){self.$$events[eventType]=[]}
self.$$events[eventType].push({handler:handler,one:!!one,});return self},one:function(eventType,handler){return this.on(eventType,handler,!0)},off:function(eventType,handler){var self=this;if(self.$$events===_undefined||self.$$events[eventType]===_undefined){return self}
if(handler!==_undefined){for(var handlerPos in self.$$events[eventType]){if(handler===self.$$events[eventType][handlerPos].handler){self.$$events[eventType].splice(handlerPos,1)}}}else{self.$$events[eventType]=[]}
return self},trigger:function(eventType,extraParams){var self=this;if(self.$$events===_undefined||self.$$events[eventType]===_undefined||self.$$events[eventType].length===0){return self}
var args=arguments,params=(args.length>2||!$.isArray(extraParams))?[].slice.call(args,1):extraParams;for(var i=0;i<self.$$events[eventType].length;i++){var event=self.$$events[eventType][i];event.handler.apply(event.handler,params);if(!!event.one){self.off(eventType,event.handler)}}
return self}}}(jQuery);var _window=window,_document=document,_undefined=undefined;var abs=Math.abs,max=Math.max;_window.$ush=_window.$ush||{};_window.$usof=_window.$usof||{};jQuery.fn.usMod=function(mod,value){if(this.length==0){return this}
if(value===!1){return this.each(function(){this.className=this.className.replace(new RegExp('(^| )'+mod+'\_[a-zA-Z0-9\_\-]+( |$)'),'$2')})}
var pcre=new RegExp('^.*?'+mod+'\_([a-zA-Z0-9\_\-]+).*?$'),arr;if($ush.isUndefined(value)){return(arr=pcre.exec(this.get(0).className))?arr[1]:!1}
else{var regexp=new RegExp('(^| )'+mod+'\_[a-zA-Z0-9\_\-]+( |$)');return this.each(function(){if(this.className.match(regexp)){this.className=this.className.replace(regexp,'$1'+mod+'_'+value+'$2')}else{this.className+=' '+mod+'_'+value}}).trigger('usof.'+mod,value)}};!function($){if($ush.isUndefined($usof.mixins)){$usof.mixins={}}
$usof.mixins.Events={on:function(eventType,handler){var self=this;if($ush.isUndefined(self.$$events)){self.$$events={}}(eventType+'').split(/\p{Zs}/u).map(function(_eventType){if($ush.isUndefined(self.$$events[_eventType])){self.$$events[_eventType]=[]}
if($.isFunction(handler)){self.$$events[_eventType].push(handler)}else{console.error('Invalid handler:',[_eventType,handler])}});return self},off:function(eventType,handler){var self=this;if($ush.isUndefined(self.$$events)||$ush.isUndefined(self.$$events[eventType])){return self}
if(!$ush.isUndefined(handler)){var handlerPos=$.inArray(handler,self.$$events[eventType]);if(handlerPos!=-1){self.$$events[eventType].splice(handlerPos,1)}}else{self.$$events[eventType]=[]}
return self},has:function(eventType){var self=this;return!$ush.isUndefined(self.$$events[eventType])&&self.$$events[eventType].length},trigger:function(eventType,extraParameters){var self=this;if($ush.isUndefined(self.$$events)||$ush.isUndefined(self.$$events[eventType])||self.$$events[eventType].length==0){return self}
var args=arguments,params=(args.length>2||!$.isArray(extraParameters))?Array.prototype.slice.call(args,1):extraParameters;params.unshift(self);for(var i=0;i<self.$$events[eventType].length;i ++){self.$$events[eventType][i].apply(self.$$events[eventType][i],params)}
return self}};if($ush.isUndefined($usof._$$data)){$usof._$$data={}}
$usof.getData=function(key){var self=this;if(typeof key!=='string'){return{}}
if(!$.isPlainObject(self._$$data[key])){try{self._$$data[key]=JSON.parse(self._$$data[key]||'{}')}catch(e){self._$$data[key]={}}}
return $ush.clone(self._$$data[key]||{})};$usof.field=function(row,options){var self=this;self.$document=$(_document);self.$row=$(row);self.$responsive=$('> .usof-form-row-responsive',self.$row);var data=self.$row.data()||{};self.type=self.$row.usMod('type');self.id=data.id;self.uniqid=$ush.uniqid();self.name=data.name;self.inited=!!data.inited;self.relatedOn=data.relatedOn;self.$input=$('[name="'+data.name+'"]:not(.js_hidden)',self.$row);if(self.inited){return}
self.$$events={beforeShow:[],afterShow:[],change:[],beforeHide:[],afterHide:[]};if(!$ush.isUndefined($usof.field[self.type])){for(var fn in $usof.field[self.type]){if(!$usof.field[self.type].hasOwnProperty(fn)||fn.substr(0,2)==='_$'){continue}
if(!$ush.isUndefined(self[fn])){var parentFn='parent'+fn.charAt(0).toUpperCase()+fn.slice(1);self[parentFn]=self[fn]}
self[fn]=$usof.field[self.type][fn]}}
self.$document.on('usb.syncResponsiveState',self._usbSyncResponsiveState.bind(self));self.$row.data('usofField',self);var initEvent=function(){self.init(options);self.inited=!0;self.$row.data('inited',self.inited);self.off('beforeShow',initEvent);self._std=data.hasOwnProperty('std')?data.std:self.getCurrentValue();self.initResponsive()};self.on('beforeShow',initEvent)};$.extend($usof.field.prototype,$usof.mixins.Events,{init:function(){var self=this;if($ush.isUndefined(self._events)){self._events={}}
self._events.change=function(){self.trigger('change',[self.getValue()])};self.$input.on('change',self._events.change);return self},isLiveBuilder:function(){return!!this.$row.closest('.usb-panel-fieldset, .usb-panel-body').length},initResponsive:function(){var self=this;if(!self.hasResponsive()){return}
self.$switchResponsive=$('.usof-switch-responsive:first',self.$row);self.$responsiveButtons=$('[data-responsive-state]',self.$responsive);self._currentState='default';self._states=['default'];if(self.$responsive.is('[onclick]')){self._states=self.$responsive[0].onclick()||self._states;self.$responsive.removeAttr('onclick')}
self.$switchResponsive.on('click',self._$switchResponsive.bind(self));self.$responsive.on('click','[data-responsive-state]',self._$selectResponsiveState.bind(self))},hasResponsive:function(){return!!this.$responsive.length},isResponsive:function(){var self=this;return self.hasResponsive()&&self.$row.hasClass('responsive')},isResponsiveValue:function(value){var self=this;if(value){if(self.isObjectValue(value)){value=$ush.toPlainObject(value)}
if($.isPlainObject(value)){for(var i in self._states){if(value.hasOwnProperty(self._states[i])){return!0}}}}
return!1},isObjectValue:function(value){return value&&(''+value).indexOf($ush.rawurlencode('{'))===0},isValidState:function(state){return state&&(this._states||[]).indexOf($ush.toString(state))!==-1},isVCParamValue:function(){return this.$input.hasClass('wpb_vc_param_value')},isDynamicVariable:function(value){return value&&/^{{([\dA-z\/\|\-_]+)}}$/.test($ush.toString(value).trim())},getParent:$.noop,getRelatedField:function(){var self=this,parent=self.getParent();if(!$ush.isUndefined(self.relatedOn)&&parent instanceof $usof.GroupParams){return(parent.fields||{})[$ush.toString(self.relatedOn)]}
return _undefined},getFieldByName:function(name){var self=this;if(name){return((self.getParent()||{})['fields']||{})[name]}
return},getCurrentState:function(){var self=this;if(!self.isValidState(self._currentState)){self._currentState='default'}
return self._currentState},getDefaultValue:function(){var self=this;return!$ush.isUndefined(self._std)?self._std:''},getValueByState:function(state,value){var self=this;if(self.isResponsiveValue(value)){if(!self.isValidState(state)){state='default'}
if(!$.isPlainObject(value)){value=$ush.toPlainObject(value)}
if(value.hasOwnProperty(state)){return value[state]}}
return self.getDefaultValue()},setValueByState:function(state,input,value){var self=this;if(!self.isValidState(state)){return ''}
if(self.isResponsiveValue(value)){value=$ush.toPlainObject(value)}else{value={}}
value[state]=input;return $ush.toString(value)},getCurrentValue:function(){var self=this,value=self.getValue();if(self.isResponsiveValue(value)){value=self.getValueByState(self._currentState,value)}
if(self.isObjectValue(value)){value=$ush.toPlainObject(value)}
return value},setCurrentValue:function(value,quiet){var self=this;if(self.isResponsive()){value=self.setValueByState(self._currentState,value,self.getValue())}
if($.isPlainObject(value)){value=$ush.toString(value)}
self.$input.val(value);if(!quiet){self.trigger('change',value)}
if(self.isVCParamValue()&&self.$input.is(':hidden')){self.$input.trigger('change')}},getValue:function(){return this.$input.val()},setValue:function(value,quiet){var self=this;if(!self.isResponsive()&&self.isResponsiveValue(value)){self.$row.addClass('responsive')}
self.$input.val(value);if(!quiet){self.trigger('change',[value])}
if(self.isVCParamValue()){self.$input.trigger('change')}},_usbSyncResponsiveState:function(_,state){var self=this,state=state||'default';if(!self.isResponsive()||!self.isValidState(state)){return}
self._$setResponsiveState(state)},_$setResponsiveState:function(state){var self=this;if(!self.hasResponsive()){return}
if(!self.isValidState(state)){state='default'}
self.$responsiveButtons.removeClass('active').filter('[data-responsive-state="'+state+'"]').addClass('active');self._currentState=state;self.trigger('setResponsiveState',state)},_$switchResponsive:function(){var self=this;if(!self.hasResponsive()){return}
var nextMode=!self.isResponsive();self.$row.toggleClass('responsive',nextMode);var value=self.getCurrentValue();if(nextMode){var responsiveValue={};self._states.map(function(state){responsiveValue[state]=value});value=$ush.toString(responsiveValue)}else{self._$setResponsiveState('default');if($.isPlainObject(value)){value=$ush.toString(value)}}
self.setValue(value)},_$selectResponsiveState:function(e){var self=this;if(!self.isResponsive()){return}
var state=$(e.target).data('responsive-state')||self._currentState;self._$setResponsiveState(state);self.trigger('syncResponsiveState',state);self.$document.trigger('field.syncResponsiveState',state)}});$.fn.usofField=function(options){return new $usof.field(this,options)};$usof.Group=function(row,options){this.init(row,options)};var _filtersHandler={sanitize_color_slug:function(value){if(value.charAt(0)!=='_'){value='_'+value}
return $ush.toLowerCase(value).replace(/[\p{Zs}|-]+/gu,'_').replace(/[^a-z\d\_]+/g,'').replace(/[\_]+/g,'_')},unique_value:function(value,reserved_values,usofField){var self=this,name=usofField.name;var values=$ush.toArray(reserved_values);self.groupParams.map(function(groupParams){if(groupParams.fields[name]===usofField){return}
var value=groupParams.fields[name].getCurrentValue();if(value){values.push(value)}});if(values.indexOf(value)>-1){value=(value.match(/(.*)([-_\p{Zs}]\d+)$/u)||[])[1]||value;var separator=($ush.toPlainObject(self._filters[name]).sanitize_color_slug?'_':' ');var i=1;while(i++<=1000){var newValue=value+separator+i;if(values.indexOf(newValue)<0){value=newValue;break}}}
return value},};$.extend($usof.Group.prototype,$usof.mixins.Events,{init:function(container,options){var self=this;self.$container=$(container);self.$btnAddGroup=$('.usof-form-group-add',container);self.$prototype=$('.usof-form-group-prototype',container);self.groupName=self.$container.data('name');self.groupParams=[];self._filters={};self.isBuilder=!!self.$container.parents('.us-bld-window').length;self.isLiveBuilder=!!self.$container.parents('.usb-panel-fieldset').length;self.isSortable=self.$container.hasClass('sortable');self.isAccordion=self.$container.hasClass('type_accordion');self.isForButtons=self.$container.hasClass('preview_button');self.isCustomColors=self.$container.hasClass('for_custom_colors');var $translations=$('.usof-form-group-translations',container);self.groupTranslations=($translations.length?($translations[0].onclick()||{}):{});if(self.$container.is('[data-filters]')){self._filters=$ush.toPlainObject(self.$container.data('filters'));self.$container.removeAttr('data-filters')}
self._events={changeGroupParam:self._changeGroupParam.bind(self),applyFiltersToParam:self._applyFiltersToParam.bind(self),};if(self.isBuilder){self.$parentElementForm=self.$container.closest('.usof-form');self.elementName=self.$parentElementForm.usMod('for');self.$builderWindow=self.$container.closest('.us-bld-window')}else{self.$parentSection=self.$container.closest('.usof-section');self._reInitGroupParams()}
self.hasStringValue=!!self.$container.closest('.usb-panel-fieldset').length;self._std=self.getValue();self.$btnAddGroup.off('click').on('click',self.addGroup.bind(self,_undefined));self.$container.on('change',function(){self.trigger('change',self)}).on('click','.ui-icon_duplicate',self.duplicateGroup.bind(self)).on('click','.usof-form-group-item-controls > .ui-icon_delete',function(e){e.stopPropagation();self.deleteGroup($(e.target).closest('.usof-form-group-item'))});if(self.isAccordion){self.$sections=$('.usof-form-group-item',container);self.$container.on('click','.usof-form-group-item-title',function(e){self.$sections=$('.usof-form-group-item',container);var $parentSection=$(e.target).closest('.usof-form-group-item');if($parentSection.hasClass('active')){$parentSection.removeClass('active').children('.usof-form-group-item-content').slideUp()}else{$parentSection.addClass('active').children('.usof-form-group-item-content').slideDown()}})}
if(self.isSortable){self.$body=$(_document.body);self.$window=$(_window);self.$dragshadow=$('<div class="us-bld-editor-dragshadow"></div>');$.extend(self._events,{maybeDragMove:self._maybeDragMove.bind(self),dragMove:self._dragMove.bind(self),dragEnd:self._dragEnd.bind(self)});self.$container.on('dragstart',function(e){e.preventDefault()}).on('mousedown','.ui-icon_move',self._dragStart.bind(self))}},_hasClass:function(node,className){return(' '+node.className+' ').indexOf(' '+className+' ')>-1},_isShadow:function(node){return this._hasClass(node,'usof-form-group-dragshadow')},_isSortable:function(node){return this._hasClass(node,'usof-form-group-item')},_changeGroupParam:function(usofField,value){var self=this;self.trigger('change',self)},_applyFiltersToParam:function(usofField){var self=this,name=usofField.name;if(!self._filters[name]){return}
var value=usofField.getValue(),newValue=$ush.toString(value),filters=$ush.toPlainObject(self._filters[name]);['sanitize_color_slug','unique_value',].map(function(handler){if(newValue&&filters[handler]&&$.isFunction(_filtersHandler[handler])){newValue=_filtersHandler[handler].call(self,newValue,filters[handler],usofField)}});if(newValue!==value){usofField.setValue(newValue)}},_reInitGroupParams:function(){var self=this;self.groupParams=[];$('.usof-form-group-item',self.$container).each(function(i,groupParams){var $groupParams=$(groupParams);if($groupParams.closest('.usof-form-group-prototype').length){return}
var groupParams=$groupParams.data('usofGroupParams');if($ush.isUndefined(groupParams)){groupParams=new $usof.GroupParams($groupParams)}
for(var k in groupParams.fields){var field=groupParams.fields[k];field.off('change',self._events.changeGroupParam).on('change',self._events.changeGroupParam);if(!$.isEmptyObject(self._filters[k])){field.off('blur',self._events.applyFiltersToParam).on('blur',self._events.applyFiltersToParam)}}
self.groupParams.push(groupParams)})},_reInitValuesChanged:function(){var self=this;if(!self.isBuilder){if($.isEmptyObject($usof.instance.valuesChanged)){clearTimeout($usof.instance.saveStateTimer);$usof.instance.$saveControl.usMod('status','notsaved')}
var value=self.getValue();$usof.instance.valuesChanged[self.groupName]=value;self.$container.trigger('change',value)}},getDefaultValue:function(){var self=this;return!$ush.isUndefined(self._std)?self._std:''},getCurrentValue:function(){var self=this,result=[];for(var i in self.groupParams){result.push(self.groupParams[i].getCurrentValues())}
if(self.hasStringValue){try{result=$ush.toString(result)}catch(err){console.error(result,err);result=''}}
return result},setValue:function(value){var self=this;if(typeof value==='string'&&self.hasStringValue){try{value=JSON.parse($ush.rawurldecode(value)||'[]')}catch(err){console.error(value,err);value=[]}}
self.groupParams=[];$('.usof-form-group-item',self.$container).each(function(i,groupParams){var $groupParams=$(groupParams);if(!$groupParams.parent().hasClass('usof-form-group-prototype')){$groupParams.remove()}});$.each(value,function(index,paramsValues){var _groupPrototype=self.$prototype.html();if(self.$btnAddGroup.length){self.$btnAddGroup.before(_groupPrototype)}else{self.$container.append(_groupPrototype)}
var $groupParams=$('.usof-form-group-item',self.$container).last();var groupParams=new $usof.GroupParams($groupParams);groupParams.setValues(paramsValues,1);for(var k in groupParams.fields){if(!groupParams.fields.hasOwnProperty(k)){continue}
groupParams.fields[k].trigger('change');break}});self._reInitGroupParams();self._reInitValuesChanged()},getValue:function(){var self=this,result=[];$.each(self.groupParams,function(i,groupParams){result.push(groupParams.getValues())});if(self.hasStringValue){if(result.length){try{result=$ush.toString(result)}catch(err){console.error(result,err);result=self.getDefaultValue()}}else{result=self.getDefaultValue()}}
return result},addGroup:function(index){var self=this;self.$btnAddGroup.addClass('adding');var $groupPrototype=$(self.$prototype.html());if(self.isForButtons&&!$ush.isUndefined(index)){self.$btnAddGroup.closest('.usof-form-group').find(' > .usof-form-group-item:eq('+parseInt(index)+')').after($groupPrototype)}else{self.$btnAddGroup.before($groupPrototype)}
var groupParams=new $usof.GroupParams($groupPrototype);for(var k in groupParams.fields){var field=groupParams.fields[k];field.on('change',self._events.changeGroupParam);if(!$.isEmptyObject(self._filters[k])){field.on('blur',self._events.applyFiltersToParam).trigger('blur')}}
if(self.isForButtons&&index!==_undefined){self.groupParams.splice(index+1,0,groupParams)}else{self.groupParams.push(groupParams)}
if(!self.isBuilder){if($.isEmptyObject($usof.instance.valuesChanged)){clearTimeout($usof.instance.saveStateTimer);$usof.instance.$saveControl.usMod('status','notsaved')}
var value=self.getValue();$usof.instance.valuesChanged[this.groupName]=value;self.$container.trigger('change',value)}
if(self.isForButtons){var newIndex=self.groupParams.length,newId=1,newIndexIsUnique;for(var i in self.groupParams){newId=max((parseInt(self.groupParams[i].fields.id.getValue())||0)+1,newId)}
do{newIndexIsUnique=!0;for(var i in self.groupParams){if(self.groupParams[i].fields.name.getValue()==self.groupTranslations.style+' '+newIndex){newIndex ++;newIndexIsUnique=!1;break}}}while(!newIndexIsUnique);groupParams.fields.name.setValue(self.groupTranslations.style+' '+newIndex);groupParams.fields.id.setValue(newId);$('.usof-btn-class-main',groupParams.$container).text('us-btn-style_'+newId)}
if(self.isLiveBuilder){groupParams._setTitleForAccordion()}
self.$btnAddGroup.removeClass('adding');return groupParams},duplicateGroup:function(e){var self=this,$target=$(e.currentTarget),$group=$target.closest('.usof-form-group-item'),index=$group.index()-1;if(self.groupParams.hasOwnProperty(index)){var $item=self.groupParams[index],values=$item.getValues(),number=0;values.name=$.trim(values.name.replace(/\s?\(.*\)$/,''));for(var i in self.groupParams){var name=self.groupParams[i].getValue('name')||'',copyPattern=new RegExp(values.name+'\\s?\\((\\d+)*','m');var numMatches=name.match(copyPattern);if(numMatches!==null){number=max(number,parseInt(numMatches[1]||1))}}
values.name+=' ('+(++ number)+')';var newGroup=self.addGroup(index);newGroup.setValues($.extend(values,{id:newGroup.getValue('id')}))}},deleteGroup:function($group){var self=this;$group.remove();self._reInitGroupParams();self._reInitValuesChanged()},_dragStart:function(e){e.stopPropagation();var self=this;self.$draggedElm=$(e.target).closest('.usof-form-group-item');self.detached=!1;self._updateBlindSpot(e);self.elmPointerOffset=[e.pageX,e.pageY].map($ush.parseInt);self.$body.on('mousemove',self._events.maybeDragMove);self.$window.on('mouseup',self._events.dragEnd)},_updateBlindSpot:function(e){this.blindSpot=[e.pageX,e.pageY].map($ush.parseInt)},_isInBlindSpot:function(e){var self=this;return(abs(e.pageX-self.blindSpot[0])<=20&&abs(e.pageY-self.blindSpot[1])<=20)},_maybeDragMove:function(e){e.stopPropagation();var self=this;if(self._isInBlindSpot(e)){return}
self.$body.off('mousemove',self._events.maybeDragMove);self._detach();self.$body.on('mousemove',self._events.dragMove)},_detach:function(e){var self=this,offset=self.$draggedElm.offset();self.elmPointerOffset[0]-=offset.left;self.elmPointerOffset[1]-=offset.top;$('.usof-form-group-item-title',self.$draggedElm).hide();if(!self.isAccordion||self.$draggedElm.hasClass('active')){$('.usof-form-group-item-content',self.$draggedElm).hide()}
self.$dragshadow.css({width:self.$draggedElm.outerWidth()}).insertBefore(self.$draggedElm);self.$draggedElm.addClass('dragged').css({position:'absolute','pointer-events':'none',zIndex:10000,width:self.$draggedElm.width(),height:self.$draggedElm.height()}).css(offset).appendTo(self.$body);if(self.isBuilder){self.$builderWindow.addClass('dragged')}
self.$container.addClass('dragging');self.detached=!0},_dragMove:function(e){e.stopPropagation();var self=this;self.$draggedElm.css({left:e.pageX-self.elmPointerOffset[0],top:e.pageY-self.elmPointerOffset[1]});if(self._isInBlindSpot(e)){return}
var elm=e.target;for(var level=0;level<=2;level ++,elm=elm.parentNode){if(self._isShadow(elm)){return}
if(self._isSortable(elm)){var nextElm=elm.previousSibling,shadowAtLeft=!1;while(nextElm){if(nextElm==this.$dragshadow[0]){shadowAtLeft=!0;break}
nextElm=nextElm.previousSibling}
self.$dragshadow[shadowAtLeft?'insertAfter':'insertBefore'](elm);self._dragDrop(e);break}}},_dragDrop:function(e){this._updateBlindSpot(e)},_dragEnd:function(e){var self=this;self.$body.off('mousemove',self._events.maybeDragMove).off('mousemove',self._events.dragMove);self.$window.off('mouseup',self._events.dragEnd);if(self.detached){self.$draggedElm.removeClass('dragged').removeAttr('style').insertBefore(self.$dragshadow);self.$dragshadow.detach();if(self.isBuilder){self.$builderWindow.removeClass('dragged')}
$('.usof-form-group-item-title',self.$draggedElm).show();if(!self.isAccordion||self.$draggedElm.hasClass('active')){$('.usof-form-group-item-content',self.$draggedElm).show()}
self._reInitGroupParams();self._reInitValuesChanged()}
self.$container.removeClass('dragging')}});$.fn.usofGroup=function(options){return new $usof.Group(this,options)}}(jQuery);(function($){$usof.dragDrop=function(container,options){this._defaults={itemSelector:'.usof-draggable-selector',css:{moving:'usof-dragdrop-moving',active:'usof-dragdrop-active',over:'usof-dragdrop-over'},};this._name='$usof.dragDrop';this.options=$.extend({},this._defaults,options||{});this.css=this.options.css;this.$container=$(container);this.init.call(this)};$.extend($usof.dragDrop.prototype,$usof.mixins.Events,{init:function(){var itemSelector=this.options.itemSelector;if(!itemSelector){return}
this.$container.data('usofDragDrop',this);this.trigger('init',this);this.$container.addClass('usof-dragdrop').on('mouseup',itemSelector,function(e){this.$container.removeClass(this.css.moving).find('> [draggable]').removeAttr('draggable');$('> .'+this.css.active,this.$container).removeClass(this.css.active);this.trigger('dragdrop',e,this);return!0}.bind(this)).on('dragenter',itemSelector,function(e){e.stopPropagation();e.preventDefault();this.trigger('dragdrop',e,this);return!0}.bind(this)).on('drop',itemSelector,function(e){var targetId=e.originalEvent.dataTransfer.getData('Text'),$el=$('> [usof-target-id="'+targetId+'"]',this.$container),$target=$(e.currentTarget);$el.removeAttr('usof-target-id');$target.before($el);$('> .'+this.css.active,this.$container).removeClass(this.css.active);$('> .'+this.css.over,this.$container).removeClass(this.css.over);e.stopPropagation();this.trigger('drop',e,this).trigger('dragdrop',e,this);return!1}.bind(this)).on('dragover',itemSelector,function(e){e.stopPropagation();e.preventDefault();$(e.currentTarget===e.target?e.target:e.currentTarget).addClass(this.css.over);this.trigger('over',e,this).trigger('dragdrop',e,this);return!0}.bind(this)).on('dragleave',itemSelector,function(e){e.stopPropagation();e.preventDefault();$(e.target).removeClass(this.css.over);this.trigger('leave',e,this).trigger('dragdrop',e,this);return!0}.bind(this)).on('mousedown',itemSelector,function(e){this.$container.addClass(this.css.moving);var $target=$(this._getTarget(e));$target.addClass(this.css.active);if(!$target.is('[draggable="false"]')&&!$target.is('input')){$target.attr('draggable',!0)}
this.trigger('dragdrop',e,this);return!0}.bind(this)).on('mouseup',itemSelector,function(e){$('> .'+this.css.active,this.$container).removeClass(this.css.active);this.trigger('dragdrop',e,this);return!0}.bind(this)).on('dragstart',itemSelector,function(e){e.stopPropagation();var $target=$(this._getTarget(e)),targetId=$ush.uniqid();$target.attr('usof-target-id',targetId);e.originalEvent.dataTransfer.effectAllowed='move';e.originalEvent.dataTransfer.setData('Text',targetId);e.originalEvent.dataTransfer.setDragImage($target.get(0),e.offsetX,e.offsetY);this.trigger('dragstart',e,this).trigger('dragdrop',e,this);return!0}.bind(this)).on('dragend',function(e){e.stopPropagation();this.$container.removeClass(this.css.moving).find('> [draggable]').removeAttr('draggable');this.trigger('dragend',e,this).trigger('dragdrop',e,this);return!0}.bind(this));return this},_getTarget:function(e){var $target=$(e.target),itemSelector=(this.options.itemSelector||'').replace('>','').trim();if(itemSelector&&!!$target.parent(itemSelector).length){$target=$target.parent(itemSelector)}
return $target.get(0)}});$.fn.usofDragDrop=function(options){return this.each(function(){if(!$.data(this,'usofDragDrop')){$.data(this,'usofDragDrop',new $usof.dragDrop(this,options))}})}})(jQuery);!function($){$usof.ajaxUrl=$('.usof-container').data('ajaxurl')||ajaxurl;if($ush.isUndefined($usof.mixins)){$usof.mixins={}}
$usof.mixins.Fieldset={initFields:function($container){var self=this;['$fields','fields','groups','showIf','showIfDeps'].map(function(prop){if(!$.isPlainObject(self[prop])){self[prop]={}}});var groupElms=[];$('.usof-form-row, .usof-form-wrapper, .usof-form-group',$container).each(function(_,node){var $field=$(node),name=$field.data('name'),isRow=$field.hasClass('usof-form-row'),isGroup=$field.hasClass('usof-form-group'),isInGroup=$field.parents('.usof-form-group').length,$showIf=$field.find((isRow||isGroup)?'> .usof-form-row-showif':'> .usof-form-wrapper-content > .usof-form-wrapper-showif');if($field.closest('.usof-form-group-prototype').length){return}
if(isRow&&$field.closest('.usof-design-options').length&&!$container.is('[data-responsive-state-content]')){return}
if(!$ush.isUndefined(self.$fields[name])){return}
self.$fields[name]=$field;if($showIf.length>0){self.showIf[name]=$showIf[0].onclick()||[];var showIfVars=self._getShowIfVariables(self.showIf[name]);for(var i=0;i<showIfVars.length;i ++){if($ush.isUndefined(self.showIfDeps[showIfVars[i]])){self.showIfDeps[showIfVars[i]]=[]}
self.showIfDeps[showIfVars[i]].push(name)}}
if(isRow&&(!isInGroup||self.isGroupParams)){self.fields[name]=$field.usofField();self.fields[name].getParent=function(){return self}}else if(isGroup){self.groups[name]=$field.usofGroup()}});for(var fieldName in self.showIfDeps){if(!self.showIfDeps.hasOwnProperty(fieldName)||$ush.isUndefined(self.fields[fieldName])){continue}
self.fields[fieldName].on('change',function(field){self.updateVisibility(field.name)});if(!!self.isGroupParams){self.updateVisibility(fieldName,!1,self.getCurrentShown(fieldName))}}
if($ush.isUndefined(self._defaultValues)){self._defaultValues=self.getValues()}},updateVisibility:function(fieldName,isAnimated,isCurrentShown){var self=this;if(!fieldName||!self.showIfDeps[fieldName])return;if($ush.isUndefined(isAnimated)){isAnimated=!0}
if($ush.isUndefined(isCurrentShown)){isCurrentShown=!0}
var isPrevShown=self.$fields[fieldName].data('isShown');self.showIfDeps[fieldName].map(function(depFieldName){var field=self.fields[depFieldName]||self.groups[depFieldName],$field=self.$fields[depFieldName],isShown=self.getCurrentShown(depFieldName),shouldBeShown=self.executeShowIf(self.showIf[depFieldName],self.getValue.bind(self));if((!shouldBeShown&&isShown)||!isCurrentShown){isShown=!1}else if(shouldBeShown&&!isShown){isShown=!0}
if(!$ush.isUndefined(isPrevShown)){isShown=isPrevShown&&isShown}
$field.stop(!0,!1).data('isShown',isShown);if(isShown){self.fireFieldEvent($field,'beforeShow');$field.show();self.fireFieldEvent($field,'afterShow');if(field instanceof $usof.field){field.trigger('change',[field.getValue()])}}else{self.fireFieldEvent($field,'beforeHide');$field.hide();self.fireFieldEvent($field,'afterHide');if(field instanceof $usof.Group){field.setValue(field.getDefaultValue())}}
if(!!self.showIfDeps[depFieldName]){self.updateVisibility(depFieldName,isAnimated,isShown)}})},getCurrentShown:function(fieldName){var self=this;if(!fieldName||!self.$fields[fieldName])return!0;var $field=self.$fields[fieldName],isShown=$field.data('isShow');if($ush.isUndefined(isShown)){isShown=$field.css('display')!=='none'}
return!!isShown},_getShowIfVariables:function(condition){var self=this;if(!$.isArray(condition)||condition.length<3){return[]}else if($.inArray(condition[1].toLowerCase(),['and','or'])!=-1){var vars=self._getShowIfVariables(condition[0]),index=2;while(!$ush.isUndefined(condition[index])){vars=vars.concat(self._getShowIfVariables(condition[index]));index=index+2}
return vars}else{return[condition[0]]}},executeShowIf:function(condition,getValue){var self=this,result=!0;if(!$.isArray(condition)||condition.length<3){return result}else if($.inArray(condition[1].toLowerCase(),['and','or'])!=-1){result=self.executeShowIf(condition[0],getValue);var index=2;while(!$ush.isUndefined(condition[index])){condition[index-1]=condition[index-1].toLowerCase();if(condition[index-1]=='and'){result=(result&&self.executeShowIf(condition[index],getValue))}else if(condition[index-1]=='or'){result=(result||self.executeShowIf(condition[index],getValue))}
index=index+2}}else{var value=getValue(condition[0]);if($ush.isUndefined(value)){return!0}
if(condition[1]=='='){if($.isArray(condition[2])){result=($.inArray(value,condition[2])!=-1)}else{result=(value==condition[2])}}else if(condition[1]=='!='){if($.isArray(condition[2])){result=($.inArray(value,condition[2])==-1)}else{result=(value!=condition[2])}}else if(condition[1]=='<='){result=(value<=condition[2])}else if(condition[1]=='<'){result=(value<condition[2])}else if(condition[1]=='>'){result=(value>condition[2])}else if(condition[1]=='>='){result=(value>=condition[2])}else if(condition[1]=='str_contains'){result=(''+value).indexOf(''+condition[2])>-1}else{result=!0}}
return result},fireFieldEvent:function($container,trigger){if(!$container.hasClass('usof-form-row')){$('.usof-form-row',$container).each(function(_,row){var $row=$(row),isShown=$row.data('isShown');if($ush.isUndefined(isShown)){isShown=$row.css('display')!='none'}
if(!isShown&&['beforeShow','afterShow','beforeHide','afterHide'].indexOf(trigger)!==-1){return}
if($ush.isUndefined($row.data('usofField'))){return}
$row.data('usofField').trigger(trigger)})}else if($container.data('usofField')instanceof $usof.field){$container.data('usofField').trigger(trigger)}},getValue:function(id){var self=this;if($ush.isUndefined(self.fields[id])){return _undefined}
return self.fields[id].getValue()},setValue:function(id,value,quiet){var self=this;if($ush.isUndefined(self.fields[id])){return}
var shouldFireShow=!self.fields[id].inited;if(shouldFireShow){self.fields[id].trigger('beforeShow');self.fields[id].trigger('afterShow')}
self.fields[id].setValue(value,quiet);if(shouldFireShow){self.fields[id].trigger('beforeHide');self.fields[id].trigger('afterHide')}},getValues:function(){var self=this,values={};for(var fieldId in self.fields){if(!self.fields.hasOwnProperty(fieldId)){continue}
values[fieldId]=self.getValue(fieldId)}
for(var groupId in self.groups){values[groupId]=self.groups[groupId].getValue()}
return values},setValues:function(values,quiet){var self=this;for(fieldId in self.fields){if(values.hasOwnProperty(fieldId)){var currentValue=values[fieldId];self.setValue(fieldId,currentValue,quiet);if(!quiet){self.fields[fieldId].trigger('change',[currentValue])}}else if(self._defaultValues.hasOwnProperty(fieldId)){var defaultValue=self._defaultValues[fieldId];self.setValue(fieldId,defaultValue,quiet)}}
for(var groupId in self.groups){self.groups[groupId].setValue(values[groupId])}
if(quiet){for(var fieldName in self.showIfDeps){if(!self.showIfDeps.hasOwnProperty(fieldName)||$ush.isUndefined(self.fields[fieldName])){continue}
self.updateVisibility(fieldName,!1);}}},getCurrentValues:function(){var self=this,result={};for(var name in self.fields){result[name]=self.fields[name].getCurrentValue()}
for(var name in self.groups){result[name]=self.groups[name].getCurrentValue()}
return result},prepareIconTag:function(iconValue){iconValue=iconValue.trim().split('|');if(iconValue.length!=2){return ''}
var iconTag='';iconValue[0]=iconValue[0].toLowerCase();if(iconValue[0]=='material'){iconTag='<i class="material-icons">'+iconValue[1]+'</i>'}else{if(iconValue[1].substr(0,3)=='fa-'){iconTag='<i class="'+iconValue[0]+' '+iconValue[1]+'"></i>'}else{iconTag='<i class="'+iconValue[0]+' fa-'+iconValue[1]+'"></i>'}}
return iconTag}};$usof.GroupParams=function(container){this.$container=$(container);this.$group=this.$container.closest('.usof-form-group');this.group=this.$group.data('name');this.isGroupParams=!0;this.isBuilder=!!this.$container.parents('.us-bld-window').length;this.isForButtons=this.$group.hasClass('preview_button');this.isForFormElms=this.$group.hasClass('preview_input_fields');this.initFields(this.$container);this.fireFieldEvent(this.$container,'beforeShow');this.fireFieldEvent(this.$container,'afterShow');this.accordionTitle=!$ush.isUndefined(this.$group.data('accordion-title'))?decodeURIComponent(this.$group.data('accordion-title')):'';if(!this._isEmptyAccordionTitle()){for(var fieldId in this.fields){if(!this.fields.hasOwnProperty(fieldId)){continue}
this.fields[fieldId].on('change',this._setTitleForAccordion.bind(this))}}
if(this.isForButtons){for(var fieldId in this.fields){if(fieldId!=='class'&&this.fields.hasOwnProperty(fieldId)){continue}
this.fields[fieldId].on('change',function(field,value){this.$extraClass=this.$container.find('.usof-btn-class-extra');this.$extraClass.text(value);}.bind(this))}}
if(!this.isBuilder){for(var fieldId in this.fields){if(!this.fields.hasOwnProperty(fieldId)){continue}
this.fields[fieldId].on('change',function(field,value){if($.isEmptyObject($usof.instance.valuesChanged)){clearTimeout($usof.instance.saveStateTimer);$usof.instance.$saveControl.usMod('status','notsaved');}
if(!$ush.isUndefined(this.group)&&$usof.instance.groups[this.group]instanceof $usof.Group){$usof.instance.valuesChanged[this.group]=$usof.instance.groups[this.group].getValue()}}.bind(this))}}
this.$container.data('usofGroupParams',this);if(this.isForButtons){this.$buttonPreview=$('.usof-form-group-item-title .usof-btn-preview',this.$container);new $usof.ButtonPreview(this.$buttonPreview)}else if(this.isForFormElms){new $usof.FormElmsPreview($('.usof-input-preview',this.$container))}};$.extend($usof.GroupParams.prototype,$usof.mixins.Fieldset,{_isEmptyAccordionTitle:function(){return $ush.isUndefined(this.accordionTitle)||this.accordionTitle===''},_setTitleForAccordion:function(){if(this._isEmptyAccordionTitle())return;this.$title=this.$container.find('.usof-form-group-item-title');if(this.isForButtons){this.$title=this.$title.find('.usof-btn-label')}
var title=this.accordionTitle;for(var fieldId in this.fields){if(!this.fields.hasOwnProperty(fieldId)||title.indexOf(fieldId)<0){continue}
var field=this.fields[fieldId],value=this.getValue(fieldId);if(field.hasOwnProperty('type')&&field.type==='select'){var $option=$('option[value="'+value+'"]',field.$container);if($option.length&&$option.html()!==''){value=$option.html()}}
title=title.replace(fieldId,value)}
this.$title.text(title)}});var USOF_Meta=function(container){this.$container=$(container);this.initFields(this.$container);this.fireFieldEvent(this.$container,'beforeShow');this.fireFieldEvent(this.$container,'afterShow');for(var fieldId in this.fields){if(!this.fields.hasOwnProperty(fieldId)){continue}
this.fields[fieldId].on('change',function(field,value){USMMSettings={};for(var savingFieldId in this.fields){USMMSettings[savingFieldId]=this.fields[savingFieldId].getValue()}
$(_document.body).trigger('usof_mm_save')}.bind(this));}};$.extend(USOF_Meta.prototype,$usof.mixins.Fieldset,{});var USOF=function(container){$usof.instance=this;this.$container=$(container);this.$title=this.$container.find('.usof-header-title h2');this.$container.addClass('inited');this.initFields(this.$container);this.active=null;this.$sections={};this.$sectionContents={};this.sectionFields={};$.each(this.$container.find('.usof-section'),function(index,section){var $section=$(section),sectionId=$section.data('id');this.$sections[sectionId]=$section;this.$sectionContents[sectionId]=$section.find('.usof-section-content');if($section.hasClass('current')){this.active=sectionId}
this.sectionFields[sectionId]=[];$.each($section.find('.usof-form-row'),function(index,row){var $row=$(row),fieldName=$row.data('name');if(fieldName){this.sectionFields[sectionId].push(fieldName)}}.bind(this))}.bind(this));this.sectionTitles={};$.each(this.$container.find('.usof-nav-item.level_1'),function(index,item){var $item=$(item),sectionId=$item.data('id');this.sectionTitles[sectionId]=$item.find('.usof-nav-title').html()}.bind(this));this.navItems=this.$container.find('.usof-nav-item.level_1, .usof-section-header');this.sectionHeaders=this.$container.find('.usof-section-header');this.sectionHeaders.each(function(index,item){var $item=$(item),sectionId=$item.data('id');$item.on('click',function(){this.openSection(sectionId)}.bind(this))}.bind(this));if(_document.location.hash&&_document.location.hash.indexOf('#!')==-1){this.openSection(_document.location.hash.substring(1))}
if(!$ush.isUndefined(this.$sections[this.active])){this.fireFieldEvent(this.$sections[this.active],'beforeShow');this.fireFieldEvent(this.$sections[this.active],'afterShow')}
this.$saveControl=this.$container.find('.usof-control.for_save');this.$saveBtn=this.$saveControl.find('.usof-button').on('click',this.save.bind(this));this.$saveMessage=this.$saveControl.find('.usof-control-message');this.valuesChanged={};this.saveStateTimer=null;for(var fieldId in this.fields){if(!this.fields.hasOwnProperty(fieldId)){continue}
this.fields[fieldId].on('change',function(field,value){if($.isEmptyObject(this.valuesChanged)){clearTimeout(this.saveStateTimer);this.$saveControl.usMod('status','notsaved');}
this.valuesChanged[field.name]=value}.bind(this))}
this.$window=$(_window);this.$header=this.$container.find('.usof-header');this.$schemeBtn=this.$container.find('.for_schemes');this.$schemeBtn.on('click',function(){$('.usof-form-row.type_style_scheme').show()}.bind(this));this._events={scroll:this.scroll.bind(this),resize:this.resize.bind(this)};this.resize();this.$window.on('resize load',this._events.resize);this.$window.on('scroll',this._events.scroll);this.$window.on('hashchange',function(){this.openSection(_document.location.hash.substring(1))}.bind(this));$(_window).bind('keydown',function(event){if(event.ctrlKey||event.metaKey){if(String.fromCharCode(event.which).toLowerCase()=='s'){event.preventDefault();$usof.instance.save()}}})};$.extend(USOF.prototype,$usof.mixins.Fieldset,{scroll:function(){this.$container.toggleClass('footer_fixed',this.$window.scrollTop()>this.headerAreaSize)},resize:function(){if(!this.$header.length){return}
this.headerAreaSize=this.$header.offset().top+this.$header.outerHeight();this.scroll()},openSection:function(sectionId){if(sectionId==this.active||$ush.isUndefined(this.$sections[sectionId])){return}
if(!$ush.isUndefined(this.$sections[this.active])){this.hideSection()}
this.showSection(sectionId);this.$schemeBtn=this.$container.find('.for_schemes');if(sectionId=='colors'){this.$schemeBtn.removeClass('hidden')}else{this.$schemeBtn.addClass('hidden')}},showSection:function(sectionId){var self=this,curItem=self.navItems.filter('[data-id="'+sectionId+'"]');curItem.addClass('current');self.fireFieldEvent(self.$sectionContents[sectionId],'beforeShow');self.$sectionContents[sectionId].stop(!0,!1).fadeIn();self.$title.html(self.sectionTitles[sectionId]);self.fireFieldEvent(self.$sectionContents[sectionId],'afterShow');var itemPopup=curItem.find('.usof-nav-popup');if(itemPopup.length>0){var matches=_document.cookie.match(/(?:^|; )usof_visited_new_sections=([^;]*)/),cookieValue=matches?decodeURIComponent(matches[1]):'',visitedNewSections=(cookieValue=='')?[]:cookieValue.split(',');if(visitedNewSections.indexOf(sectionId)==-1){visitedNewSections.push(sectionId);_document.cookie='usof_visited_new_sections='+visitedNewSections.join(',')}
itemPopup.remove()}
self.active=sectionId},hideSection:function(){this.navItems.filter('[data-id="'+this.active+'"]').removeClass('current');this.fireFieldEvent(this.$sectionContents[this.active],'beforeHide');this.$sectionContents[this.active].stop(!0,!1).hide();this.$title.html('');this.fireFieldEvent(this.$sectionContents[this.active],'afterHide');this.active=null},save:function(){if($.isEmptyObject(this.valuesChanged)){return}
clearTimeout(this.saveStateTimer);this.$saveMessage.html('');this.$saveControl.usMod('status','loading');$.ajax({type:'POST',url:$usof.ajaxUrl,dataType:'json',data:{action:'usof_save',usof_options:JSON.stringify(this.valuesChanged),_wpnonce:this.$container.find('[name="_wpnonce"]').val(),_wp_http_referer:this.$container.find('[name="_wp_http_referer"]').val()},success:function(result){if(result.success){this.valuesChanged={};this.$saveMessage.html(result.data.message);this.$saveControl.usMod('status','success');this.saveStateTimer=setTimeout(function(){this.$saveMessage.html('');this.$saveControl.usMod('status','clear')}.bind(this),4000)}else{this.$saveMessage.html(result.data.message);this.$saveControl.usMod('status','error');this.saveStateTimer=setTimeout(function(){this.$saveMessage.html('');this.$saveControl.usMod('status','notsaved')}.bind(this),4000)}}.bind(this)})}});$(function(){new USOF('.usof-container:not(.inited)');$.each($('.usof-container.for_meta'),function(_,node){new USOF_Meta(node)});$(_document.body).off('usof_mm_load').on('usof_mm_load',function(){$('.us-mm-settings').each(function(_,node){new USOF_Meta(node)})})})}(jQuery);var _document=document;(function($){$usof.popupInstances={};function USOF_Popup(id,options){var self=this;self.$document=$(_document);var $body=$(_document.body);if(self.inited){return}
self.inited=!0;if(!$.isPlainObject(options)){options={}}
self.$container=$('[data-popup-id="'+id+'"]:first');if(!self.$container.length){return}
options=$.extend({overlay:!0,closeOnEsc:!1,closeOnBgClick:!1,},options);self.options=options;if(options.overlay){self.$overlay=self.$container.next('.usof-popup-overlay:first');if(!self.$overlay.length){self.$overlay=$('<div class="usof-popup-overlay"></div>');self.$container.after(self.$overlay)}}
self._events={close:self._close.bind(self),hide:self._hide.bind(self),keydown:self._keydown.bind(self),show:self._show.bind(self),};if(options.overlay&&options.closeOnBgClick){self.$overlay.on('click',self._events.hide)}
self.$document.on('click','[data-popup-show="'+id+'"]',self._events.show).on('click','[data-popup-hide="'+id+'"]',self._events.hide).on('click','[data-popup-id="'+id+'"] .usof-popup-close',self._events.close).on('keyup',self._events.keydown);self.on('usof.hide',self._events.hide).on('closeOnEsc',self._events.hide);['beforeShow','afterShow','beforeHide','afterHide','closeOnBtn'].map(function(name){if($.isFunction(options[name])){self.on(name,options[name].bind(self))}});if($.isFunction(options.init)){options.init.call(self)}}
$.extend(USOF_Popup.prototype,$usof.mixins.Events,{hasPreloader:function(){return this.$container.hasClass('preloader')},showPreloader:function(){this.$container.addClass('preloader')},hidePreloader:function(){this.$container.removeClass('preloader')},isShow:function(){return this.$container.hasClass('show')},_show:function(){var self=this;self.trigger('beforeShow');self.$container.addClass('show');if(self.options.overlay){self.$overlay.addClass('show')}
self.trigger('afterShow');return!1},_hide:function(){var self=this;self.trigger('beforeHide');self.$container.removeClass('show');if(self.options.overlay){self.$overlay.removeClass('show')}
self.trigger('afterHide');return!1},_close:function(){var self=this;self._hide();self.trigger('closeOnBtn');return!1},_keydown:function(e){var self=this;if(self.options.closeOnEsc&&self.isShow()&&$ush.toLowerCase(e.key)==='escape'){self.trigger('closeOnEsc')}}});$usof.popup=function(id,options){if(!id||!$('[data-popup-id="'+id+'"]').length){return}
return $usof.popupInstances[id]=new USOF_Popup(id,options)};$usof.hidePopup=function(id){var popups=[];if(id===!0){popups=Object.keys($usof.popupInstances)}else if(!$ush.isUndefined($usof.popupInstances[id])){popups.push(id)}
if(popups.length){popups.map(function(id){$usof.popupInstances[id].trigger('usof.hide')});return!0}
return!1};$.fn.usPopup=function(){this.each(function(){this.data('USOF_Popup',new $usof.popup(this.data('popup-id')))})}})(jQuery);!function($,undefined){"use strict";var _document=document,_parseFloat=parseFloat,_parseInt=parseInt,_undefined=undefined,_window=window;function usofColorPicker(input,options){var self=this;self.$input=$(input);self.$window=$(_window);self.$document=$(_document);if(self.$input.hasClass('active')){return}
self.$input.addClass('active');self.value=input.value;var defaults={state:'solid',height:160,width:160,angle:220,inputHeight:self.$input.height(),initialSecondColor:{hex:'#000000',rgba:{r:0,g:0,b:0,a:1},hsba:{h:360,s:0,b:0,a:1,},},onChange:$.noop,color:{first:{},second:{},},initialColor:self.value,};self.sending=!1;self.colors=$.extend({},defaults,options||{});self.withGradient=self.$input.closest('.usof-color').hasClass('with_gradient');self.$colpickTemplate=$('.usof-colpick.usof-colpick-template:first');$('.usof-colpick:not(.usof-colpick-template)').remove();self.$colpick=self.$colpickTemplate.clone().removeClass('usof-colpick-template');self.$colpick.insertAfter(self.$input);self.$curentColorBox=$('.first .usof-colpick-color',self.$colpick);self.$gradientColorBox=$('.second .usof-colpick-color',self.$colpick);self.$hueArr=$('.first .usof-colpick-hue-selector',self.$colpick);self.$hueArr2=$('.second .usof-colpick-hue-selector',self.$colpick);self.$alphaArr=$('.first .usof-colpick-alpha-selector',self.$colpick);self.$gradientAlphaArr=$('.second .usof-colpick-alpha-selector',self.$colpick);self.$alphaContainer=$('.first .usof-colpick-alpha',self.$colpick);self.$gradientAlphaContainer=$('.second .usof-colpick-alpha',self.$colpick);self.$hueContainer=$('.first .usof-colpick-hue',self.$colpick);self.$gradientHueContainer=$('.second .usof-colpick-hue',self.$colpick);self.$angleContainer=$('.usof-colpick-angle',self.$colpick);self.$angle=$('.usof-colpick-angle-selector',self.$colpick);self.$selector=$('.first .usof-colpick-color-selector',self.$colpick);self.$gradientDot=$('.second .usof-colpick-color-selector',self.$colpick);self.$switchers=$('.usof-radio input[type="radio"]',self.$colpick);self.$switchersBox=$('.usof-radio',self.$colpick);if(!self.colorIsValid(self.value)){return}
if(!self.withGradient&&self.isGradient(self.value)){self.value=self.gradientParser(self.value).hex}
if(!self.withGradient){self.$switchersBox.remove();self.$angleContainer.remove();$('.second',self.$colpick).remove()}
self.setHuePosition();self.setCurrentColor();self.setDotPosition();self.setAlpha();self.$colpick.addClass('type_solid');self.$colpick.removeClass('type_gradient');if(self.isGradient(self.value)){self.setDotPosition(!0);self.setCurrentColor(!0);self.setHuePosition(!0);self.setAlpha(!0);self.setAngle();self.colors.state='gradient';self.$colpick.addClass('type_gradient');self.$colpick.removeClass('type_solid')}
self._events={hide:self.hide.bind(self),setPosition:self.setPosition.bind(self),stop:self._stop.bind(self),upAlpha:self.upAlpha.bind(self),upAngle:self.upAngle.bind(self),upHue:self.upHue.bind(self),upSelector:self.upSelector.bind(self),};self._specEvents={};self.$hueContainer.off('mousedown touchstart').on('mousedown touchstart',function(e){e.preventDefault();self.downHue(e)});self.$gradientHueContainer.off('mousedown touchstart').on('mousedown touchstart',function(e){e.preventDefault();self.downHue(e,!0)});self.$curentColorBox.off('mousedown touchstart').on('mousedown touchstart',function(e){e.preventDefault();self.downSelector(e)});self.$gradientColorBox.off('mousedown touchstart').on('mousedown touchstart',function(e){e.preventDefault();self.downSelector(e,!0)});self.$alphaContainer.off('mousedown touchstart').on('mousedown touchstart',function(e){e.preventDefault();self.downAlpha(e)});self.$gradientAlphaContainer.off('mousedown touchstart').on('mousedown touchstart',function(e){e.preventDefault();self.downAlpha(e,!0)});self.$angleContainer.off('mousedown touchstart').on('mousedown touchstart',function(e){e.preventDefault();self.downAngle(e)});self.$colpick.css('display','flex');self.setPosition();self.$document.on('scroll',self._events.setPosition);self.$window.on('resize',self._events.setPosition);self.$switchers.removeAttr('checked').filter('[value="'+self.colors.state+'"]').prop('checked','checked');self.$document.off('change','.usof-colpick input[name=usof-colpick-type]').on('change','.usof-colpick input[name=usof-colpick-type]',function(e){self._stop(e);var value=$(e.target).closest('input').val();self.toggleGradient(value,!0)});self.$input.off('blur').on('blur',self._events.hide);self.$switchersBox.off('mousedown').on('mousedown',self._events.stop);self._timeout=$ush.timeout(function(){self.$input.select()},5)}
var api_usofColorPicker=$.extend(usofColorPicker.prototype,{_stop:function(e){e.preventDefault();e.stopPropagation()},setPosition:function(){var self=this,coordinates=self.$input.offset(),bottomSpace=_document.body.clientHeight-(coordinates.top-_window.pageYOffset),calWrapH=self.$colpick.outerHeight(),top=self.colors.inputHeight,right='auto';if(bottomSpace<calWrapH){top=-calWrapH}
if(coordinates.left+self.colors.width*2>_document.body.clientWidth){right=0}
self.$colpick.css({'right':right,'top':top,})},downAngle:function(e){var self=this,$target=$(e.target),current,pageX,newVal;if($target.hasClass('usof-colpick-angle-selector')){$target=$target.parent()}
current={left:$target.offset().left,};self._specEvents.moveAngle=function(ev){self.moveAngle(ev,current)};self.$document.on('mouseup touchend',current,self._events.upAngle).on('mousemove touchmove',self._specEvents.moveAngle);pageX=(e.type=='touchstart')?e.originalEvent.changedTouches[0].pageX:e.pageX;newVal=_parseInt(360*(pageX-current.left)/self.colors.angle,10);self.colors.gradient.angle=newVal;self.change();return!1},upAngle:function(){var self=this;self.$document.off('mouseup touchend',self._events.upAngle).off('mousemove touchmove',self._specEvents.moveAngle||$.noop);return!1},moveAngle:function(e,current){var newVal,self=this,pageX=(e.type=='touchstart')?e.originalEvent.changedTouches[0].pageX:e.pageX;newVal=_parseInt(360*(pageX-current.left)/self.colors.angle,10);if(newVal<0){newVal=0}else if(newVal>360){newVal=360}
newVal=self.round2precision(newVal,5);self.colors.gradient.angle=newVal;self.change();return!1},downSelector:function(e,gradient){var self=this,pageX,pageY,current={pos:gradient?self.$gradientColorBox.offset():self.$curentColorBox.offset(),number:gradient?'second':'first',};self._specEvents.moveSelector=function(ev){self.moveSelector(ev,current,gradient)};self.$document.on('mouseup touchend',current,self._events.upSelector).on('mousemove touchmove',self._specEvents.moveSelector);if(e.type=='touchstart'){pageX=e.originalEvent.changedTouches[0].pageX;pageY=e.originalEvent.changedTouches[0].pageY}else{pageX=e.pageX;pageY=e.pageY}
self.colors.color[current.number].hsba.b=_parseInt(100*(self.colors.height-(pageY-current.pos.top))/self.colors.height,10);self.colors.color[current.number].hsba.s=_parseInt(100*(pageX-current.pos.left)/self.colors.height,10);self.change(gradient);return!1},upSelector:function(){var self=this;self.$document.off('mouseup touchend',self._events.upSelector).off('mousemove touchmove',self._specEvents.moveSelector||$.noop);return!1},moveSelector:function(e,current,gradient){var pageX,pageY,self=this,max=Math.max,min=Math.min;if(e.type=='touchmove'){pageX=e.originalEvent.changedTouches[0].pageX;pageY=e.originalEvent.changedTouches[0].pageY}else{pageX=e.pageX;pageY=e.pageY}
self.colors.color[current.number].hsba.b=_parseInt(100*(self.colors.height-max(0,min(self.colors.height,(pageY-current.pos.top))))/self.colors.height,10);self.colors.color[current.number].hsba.s=_parseInt(100*(max(0,min(self.colors.height,(pageX-current.pos.left))))/self.colors.height,10);self.change(gradient);return!1},downHue:function(e,gradient){var self=this,$target=$(e.target),current,pageY,newVal;if($target.hasClass('usof-colpick-hue-selector')){$target=$target.parent()}
current={top:$($target).offset().top,number:gradient?'second':'first'};self._specEvents.moveHue=function(ev){self.moveHue(ev,current,gradient)};self.$document.on('mouseup touchend',current,self._events.upHue).on('mousemove touchmove',self._specEvents.moveHue);pageY=(e.type=='touchstart')?e.originalEvent.changedTouches[0].pageY:e.pageY;newVal=_parseInt(360*(self.colors.height-(pageY-current.top))/self.colors.height,10);self.colors.color[current.number].hsba.h=newVal;self.change(gradient,!0);return!1},moveHue:function(e,data,gradient){var self=this,pageY=(e.type=='touchmove')?e.originalEvent.changedTouches[0].pageY:e.pageY,newVal=_parseInt(360*(self.colors.height-Math.max(0,Math.min(self.colors.height,(pageY-data.top))))/self.colors.height,10);self.colors.color[data.number].hsba.h=newVal;self.change(gradient,!0);return!1},upHue:function(){var self=this;self.$document.off('mouseup touchend',self._events.upHue).off('mousemove touchmove',self._specEvents.moveHue||$.noop);return!1},setAngle:function(){var self=this;if(self.isEmptyObject(self.colors.gradient)){self.colors.gradient={angle:90};return!1}
var angle=self.colors.gradient.angle?_parseInt(self.colors.gradient.angle,10):0;if(angle>=0&&angle<=360){angle=angle*self.colors.angle/360}else{return!1}
self.$angle.css('left',angle)},setCurrentColor:function(gradient){var self=this;if(gradient){self.$gradientColorBox.css('backgroundColor',self.hsbaToHex({h:self.colors.color.second.hsba.h,s:100,b:100}))}
self.$curentColorBox.css('backgroundColor',self.hsbaToHex({h:self.colors.color.first.hsba.h,s:100,b:100}))},setAlpha:function(gradient){var self=this,rgba=self.colors.color.first.rgba,hsba=self.colors.color.first.hsba,rgbaG,alphaStyle,alphaStyleG;if(hsba.a===_undefined){hsba.a=1.}
alphaStyle='background: linear-gradient(to bottom, rgb('+rgba.r+', '+rgba.g+', '+rgba.b+') 0%, ';alphaStyle+='rgba('+rgba.r+', '+rgba.g+', '+rgba.b+', 0) 100%)';self.$alphaContainer.attr('style',alphaStyle);if(gradient){rgbaG=self.colors.color.second.rgba;alphaStyleG='background: linear-gradient(to bottom, rgb('+rgbaG.r+', '+rgbaG.g+', '+rgbaG.b+') 0%, ';alphaStyleG+='rgba('+rgbaG.r+', '+rgbaG.g+', '+rgbaG.b+', 0) 100%)';self.$gradientAlphaContainer.attr('style',alphaStyleG);self.$gradientAlphaArr.css('top',_parseInt(self.colors.height*(1.-self.colors.color.second.hsba.a)))}
self.$alphaArr.css('top',_parseInt(self.colors.height*(1.-self.colors.color.first.hsba.a)))},downAlpha:function(e,gradient){var self=this,$target=$(e.target),current,pageY,alpha;if($target.hasClass('usof-colpick-alpha-selector')){$target=$target.parent()}
current={top:$target.offset().top,number:gradient?'second':'first',};self._specEvents.moveAlpha=function(ev){self.moveAlpha(ev,current,gradient)};self.$document.on('mouseup touchend',current,self._events.upAlpha).on('mousemove touchmove',self._specEvents.moveAlpha);pageY=(e.type=='touchstart')?e.originalEvent.changedTouches[0].pageY:e.pageY;alpha=(self.colors.height-(pageY-current.top))/self.colors.height;self.colors.color[current.number].rgba.a=alpha;self.colors.color[current.number].hsba.a=alpha;self.change(gradient);return!1},moveAlpha:function(e,current,gradient){var self=this,pageY=(e.type=='touchmove')?e.originalEvent.changedTouches[0].pageY:e.pageY,alpha=(self.colors.height-(pageY-current.top))/self.colors.height;if(alpha>1){alpha=1}else if(alpha<0){alpha=0}
alpha=self.round2precision(alpha,0.05);alpha=_parseFloat(alpha).toFixed(2);self.colors.color[current.number].rgba.a=alpha;self.colors.color[current.number].hsba.a=alpha;self.change(gradient);return!1},upAlpha:function(){var self=this;self.$document.off('mouseup touchend',self._events.upAlpha).off('mousemove touchmove',self._specEvents.moveAlpha||$.noop);return!1},change:function(gradient,setColor){var self=this;self.colors.color.first.rgba=self.hsbaToRgba(self.colors.color.first.hsba);self.colors.color.first.hex=self.hsbaToHex(self.colors.color.first.hsba);if(!self.isEmptyObject(self.colors.color.second)){self.colors.color.second.rgba=self.hsbaToRgba(self.colors.color.second.hsba);self.colors.color.second.hex=self.hsbaToHex(self.colors.color.second.hsba)}
self.setHuePosition(gradient);if(setColor){self.setCurrentColor(gradient)}
self.setAngle();self.setDotPosition(gradient);self.setAlpha(gradient);self.setColor();self.colors.onChange.apply(self.colors,[self.colors])},toggleGradient:function(state,setColor){var self=this,hasGradient=(state=='gradient'),gradient=hasGradient?!0:!1;if(state==='solid'){self.$colpick.removeClass('type_gradient').addClass('type_solid');self.colors.color.second={};self.colors.gradient={}}else if(hasGradient){self.$colpick.addClass('type_gradient').removeClass('type_solid');if(self.isEmptyObject(self.colors.color.second.hsba)||self.isEmptyObject(self.colors.color.second.rgba)){self.colors.color.second.hsba=self.colors.initialSecondColor.hsba;self.colors.color.second.rgba=self.colors.initialSecondColor.rgba}
if(self.isEmptyObject(self.colors.gradient)){self.colors.gradient={angle:90}}}
self.colors.state=state;self.$switchers.filter('[value="'+self.colors.state+'"]').prop('checked','checked');self.change(gradient,setColor)},hide:function(){var self=this;self.$colpick.css('display','none').removeClass('type_gradient');if(self._timeout){$ush.clearTimeout(self._timeout)}
var value=self.$input.val();if(self.colors.initialColor!=value){self.$input.trigger('change')}
self.$hueContainer.off('mousedown touchstart');self.$gradientHueContainer.off('mousedown touchstart');self.$curentColorBox.off('mousedown touchstart');self.$gradientColorBox.off('mousedown touchstart');self.$alphaContainer.off('mousedown touchstart');self.$gradientAlphaContainer.off('mousedown touchstart');self.$angleContainer.off('mousedown touchstart');self.$switchers.off('change');self.$input.off('blur').trigger('blur');self.$colpick.remove();self.$input[0].selectionStart=value.length;self.$input[0].blur();self.$input.removeClass('active')},colorIsValid:function(value){var gradient,valueG2,valueG1,self=this;if(typeof value=='string'){if(self.colorNameToHex(value)){value=self.hexToHsba(self.colorNameToHex(value))}else if(self.isGradient(value)){gradient=self.gradientParser(value);value=self.hexToHsba(gradient.hex);self.colors.gradient=gradient}else if(value=='transparent'){value={h:360,s:0,b:0,a:0,}}else{value=self.hexToHsba(self.normalizeHex(value))}}else if(value.r!=_undefined&&value.g!=_undefined&&value.b!=_undefined){value=self.rgbaToHsba(value)}else{return!1}
if(gradient){self.colors.state='gradient';valueG1=gradient.colors[0];valueG1=self.value2Hsba(valueG1);self.colors.color.first.hsba=valueG1;self.colors.color.first.hex=self.hsbaToHex(valueG1);self.colors.color.first.rgba=self.hsbaToRgba(valueG1);self.colors.color.first.dot={left:_parseInt(self.colors.height*valueG1.s/100,10),top:_parseInt(self.colors.height*(100-valueG1.b)/100,10),};valueG2=gradient.colors[1];valueG2=self.value2Hsba(valueG2);self.colors.color.second.hsba=valueG2;self.colors.color.second.hex=self.hsbaToHex(valueG2);self.colors.color.second.rgba=self.hsbaToRgba(valueG2);self.colors.color.second.dot={left:_parseInt(self.colors.height*valueG2.s/100,10),top:_parseInt(self.colors.height*(100-valueG2.b)/100,10),}}else{self.colors.state='solid';self.colors.color.first.hsba=value;self.colors.color.first.hex=self.hsbaToHex(value);self.colors.color.first.rgba=self.hsbaToRgba(value);self.colors.color.first.dot={left:_parseInt(self.colors.height*value.s/100,10),top:_parseInt(self.colors.height*(100-value.b)/100,10),}}
return!0},setHuePosition:function(gradient){var self=this;if(gradient){self.$hueArr2
.css('top',self.colors.height-self.colors.height*self.colors.color.second.hsba.h/360)}
self.$hueArr.css('top',self.colors.height-self.colors.height*self.colors.color.first.hsba.h/360)},setDotPosition:function(gradient){var self=this;if(gradient){self.$gradientDot.css({top:_parseInt(self.colors.height*(100-self.colors.color.second.hsba.b)/100,10),left:_parseInt(self.colors.height*self.colors.color.second.hsba.s/100,10),})}
self.$selector.css({top:_parseInt(self.colors.height*(100-self.colors.color.first.hsba.b)/100,10),left:_parseInt(self.colors.height*self.colors.color.first.hsba.s/100,10),})},value2Hsba:function(value){var self=this;if(typeof value=='string'){if(self.colorNameToHex(value)){value=self.hexToHsba(self.colorNameToHex(value))}else if(value.indexOf('rgb')>0){value=self.rgbaToHsba(value)}else{value=self.hexToHsba(value)}}else if(value.r!=_undefined&&value.g!=_undefined&&value.b!=_undefined){value=self.rgbaToHsba(value)}
return value},hexToHsba:function(hex){var self=this;return self.rgbaToHsba(self.hexToRgba(hex))},hexToRgba:function(hex){if(hex.substr(0,5)=='rgba('){var parts=hex.substring(5,hex.length-1).split(',').map(_parseFloat);if(parts.length==4){return{r:parts[0],g:parts[1],b:parts[2],a:parts[3]}}}
if(hex.length==3){hex=hex.charAt(0)+hex.charAt(0)+hex.charAt(1)+hex.charAt(0)+hex.charAt(2)+hex.charAt(2)}
hex=_parseInt(((hex.indexOf('#')>-1)?hex.substring(1):hex),16);return{r:hex>>16,g:(hex&0x00FF00)>>8,b:(hex&0x0000FF),a:1.}},rgbaToHsba:function(rgba){var hsba={h:0,s:0,b:0},min=Math.min(rgba.r,rgba.g,rgba.b),max=Math.max(rgba.r,rgba.g,rgba.b),delta=max-min;hsba.b=max;hsba.s=max!=0?255*delta/max:0;if(hsba.s!=0){if(rgba.r==max){hsba.h=(rgba.g-rgba.b)/delta}else if(rgba.g==max){hsba.h=2+(rgba.b-rgba.r)/delta}else{hsba.h=4+(rgba.r-rgba.g)/delta}}else{hsba.h=-1}
hsba.h*=60;if(hsba.h<0){hsba.h+=360}
hsba.s*=100/255;hsba.b*=100/255;hsba.a=rgba.a;return hsba},hsbaToHex:function(hsba){var self=this;return self.rgbaToHex(self.hsbaToRgba(hsba))},rgbaToHex:function(rgba){return '#'+Object.values($.isPlainObject(rgba)?rgba:{}).slice(0,3).map(function(value){return value<=255?('0'+parseInt(value,10).toString(16)).slice(-2):'ff'}).join('')},hsbaToRgba:function(hsba){var rgb={},round=Math.round,h=hsba.h,s=hsba.s*255/100,v=hsba.b*255/100;if(s===0){rgb.r=rgb.g=rgb.b=v}else{var t1=v,t2=(255-s)*v/255,t3=(t1-t2)*(h%60)/60;if(h===360){h=0}
if(h<60){rgb.r=t1;rgb.b=t2;rgb.g=t2+t3}else if(h<120){rgb.g=t1;rgb.b=t2;rgb.r=t1-t3}else if(h<180){rgb.g=t1;rgb.r=t2;rgb.b=t2+t3}else if(h<240){rgb.b=t1;rgb.r=t2;rgb.g=t1-t3}else if(h<300){rgb.b=t1;rgb.g=t2;rgb.r=t2+t3}else if(h<360){rgb.r=t1;rgb.g=t2;rgb.b=t1-t3}else{rgb.r=0;rgb.g=0;rgb.b=0}}
return{r:round(rgb.r),g:round(rgb.g),b:round(rgb.b),a:hsba.a}},gradientParser:function(color){var matches,self=this;if(matches=/^linear-gradient\(([\D\d]+)\);?$/.exec(color)){var gradient=matches[1].split(','),directions=['to','top','right','bottom','left','turn','deg'],index,colors={colors:[],gradient:color,};for(var d=0;d<directions.length;d ++){index=gradient[0].indexOf(directions[d]);if(index!==-1){colors.direction=gradient[0];if(directions[d]==='deg'){colors.angle=_parseInt(gradient[0],10)}}}
for(var i=0;i<gradient.length;i ++){if(gradient[i].indexOf('%')!==-1){gradient[i]=gradient[i].replace(/^(.+)(\s[0-9]+%)/,'$1')}
gradient[i]=gradient[i].trim().toLowerCase();var hex=gradient[i].indexOf('#'),rgb=gradient[i].indexOf('rgb('),rgba=gradient[i].indexOf('rgba(');if(hex!==-1){var normalizedHex=self.normalizeHex(gradient[i].replace('#',''));colors.colors.push(normalizedHex)}else if(rgb!==-1){var rgbColor={};rgbColor.r=_parseInt(gradient[i].replace('rgb(','').trim());rgbColor.g=_parseInt(gradient[i+1].trim());rgbColor.b=_parseInt(gradient[i+2].replace(')','').trim());colors.colors.push(rgbColor);i+=2}else if(rgba!==-1){var rgbaColor={};rgbaColor.r=_parseInt(gradient[i].replace('rgba(','').trim());rgbaColor.g=_parseInt(gradient[i+1].trim());rgbaColor.b=_parseInt(gradient[i+2].trim());rgbaColor.a=_parseFloat(gradient[i+3].trim().replace(')','').trim());colors.colors.push(rgbaColor);i+=3}else if(matches=/^[a-z0-9]*$/.exec(gradient[i])){if(gradient[i]!==colors.direction){colors.colors.push(gradient[i])}}}
if(typeof colors.colors[0]=='string'){if(colors.colors[0].indexOf('#')!==-1){colors.hex=self.normalizeHex(colors.colors[0].replace('#',''))}else if(self.colorNameToHex(colors.colors[0])){colors.hex=self.colorNameToHex(colors.colors[0])}else{colors.hex='#ffffff'}}else{colors.hex=self.rgbaToHex(colors.colors[0])}
return colors}
return!1},isGradient:function(value){return value&&/^linear-gradient\(.+\)$/.test(value)},colorNameToHex:function(colorName){if(!colorName){return!1}
var colorNames={'aliceblue':'#f0f8ff','antiquewhite':'#faebd7','aqua':'#00ffff','aquamarine':'#7fffd4','azure':'#f0ffff','beige':'#f5f5dc','bisque':'#ffe4c4','black':'#000000','blanchedalmond':'#ffebcd','blue':'#0000ff','blueviolet':'#8a2be2','brown':'#a52a2a','burlywood':'#deb887','cadetblue':'#5f9ea0','chartreuse':'#7fff00','chocolate':'#d2691e','coral':'#ff7f50','cornflowerblue':'#6495ed','cornsilk':'#fff8dc','crimson':'#dc143c','cyan':'#00ffff','darkblue':'#00008b','darkcyan':'#008b8b','darkgoldenrod':'#b8860b','darkgray':'#a9a9a9','darkgreen':'#006400','darkkhaki':'#bdb76b','darkmagenta':'#8b008b','darkolivegreen':'#556b2f','darkorange':'#ff8c00','darkorchid':'#9932cc','darkred':'#8b0000','darksalmon':'#e9967a','darkseagreen':'#8fbc8f','darkslateblue':'#483d8b','darkslategray':'#2f4f4f','darkturquoise':'#00ced1','darkviolet':'#9400d3','deeppink':'#ff1493','deepskyblue':'#00bfff','dimgray':'#696969','dodgerblue':'#1e90ff','firebrick':'#b22222','floralwhite':'#fffaf0','forestgreen':'#228b22','fuchsia':'#ff00ff','gainsboro':'#dcdcdc','ghostwhite':'#f8f8ff','gold':'#ffd700','goldenrod':'#daa520','gray':'#808080','green':'#008000','greenyellow':'#adff2f','honeydew':'#f0fff0','hotpink':'#ff69b4','indianred':'#cd5c5c','indigo':'#4b0082','ivory':'#fffff0','khaki':'#f0e68c','lavender':'#e6e6fa','lavenderblush':'#fff0f5','lawngreen':'#7cfc00','lemonchiffon':'#fffacd','lightblue':'#add8e6','lightcoral':'#f08080','lightcyan':'#e0ffff','lightgoldenrodyellow':'#fafad2','lightgrey':'#d3d3d3','lightgreen':'#90ee90','lightpink':'#ffb6c1','lightsalmon':'#ffa07a','lightseagreen':'#20b2aa','lightskyblue':'#87cefa','lightslategray':'#778899','lightsteelblue':'#b0c4de','lightyellow':'#ffffe0','lime':'#00ff00','limegreen':'#32cd32','linen':'#faf0e6','magenta':'#ff00ff','maroon':'#800000','mediumaquamarine':'#66cdaa','mediumblue':'#0000cd','mediumorchid':'#ba55d3','mediumpurple':'#9370d8','mediumseagreen':'#3cb371','mediumslateblue':'#7b68ee','mediumspringgreen':'#00fa9a','mediumturquoise':'#48d1cc','mediumvioletred':'#c71585','midnightblue':'#191970','mintcream':'#f5fffa','mistyrose':'#ffe4e1','moccasin':'#ffe4b5','navajowhite':'#ffdead','navy':'#000080','oldlace':'#fdf5e6','olive':'#808000','olivedrab':'#6b8e23','orange':'#ffa500','orangered':'#ff4500','orchid':'#da70d6','palegoldenrod':'#eee8aa','palegreen':'#98fb98','paleturquoise':'#afeeee','palevioletred':'#d87093','papayawhip':'#ffefd5','peachpuff':'#ffdab9','peru':'#cd853f','pink':'#ffc0cb','plum':'#dda0dd','powderblue':'#b0e0e6','purple':'#800080','rebeccapurple':'#663399','red':'#ff0000','rosybrown':'#bc8f8f','royalblue':'#4169e1','saddlebrown':'#8b4513','salmon':'#fa8072','sandybrown':'#f4a460','seagreen':'#2e8b57','seashell':'#fff5ee','sienna':'#a0522d','silver':'#c0c0c0','skyblue':'#87ceeb','slateblue':'#6a5acd','slategray':'#708090','snow':'#fffafa','springgreen':'#00ff7f','steelblue':'#4682b4','tan':'#d2b48c','teal':'#008080','thistle':'#d8bfd8','tomato':'#ff6347','turquoise':'#40e0d0','violet':'#ee82ee','wheat':'#f5deb3','white':'#ffffff','whitesmoke':'#f5f5f5','yellow':'#ffff00','yellowgreen':'#9acd32'};return colorNames[colorName.toLowerCase()]||!1},normalizeHex:function(hex){hex=hex.replace('#','');var hashString;if(hex.length===3){hex='#'+hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]}else if(hex.length<=6){hashString=hex.split('');while(hashString.length<6){hashString.unshift('0')}
hex='#'+hashString.join('')}
return hex},round2precision:function(x,precision){var y=+x+(precision===_undefined?0.5:precision/2);return y-(y%(precision===_undefined?1:+precision))},isEmptyObject:function(obj){for(var key in obj){if(obj.hasOwnProperty(key)){return!1}}
return!0},setColor:function(){var color,firstColor,secondColor,rgbaS,rgbaF,self=this;if(!self.isEmptyObject(self.colors.color.second)){if(self.colors.color.second.hsba.a<1){rgbaS=self.hsbaToRgba(self.colors.color.second.hsba);secondColor='rgba('+rgbaS.r+','+rgbaS.g+','+rgbaS.b+','+rgbaS.a+')'}else{secondColor=self.hsbaToHex(self.colors.color.second.hsba)}
if(self.colors.color.first.hsba.a<1){rgbaF=self.hsbaToRgba(self.colors.color.first.hsba);firstColor='rgba('+rgbaF.r+','+rgbaF.g+','+rgbaF.b+','+rgbaF.a+')'}else{firstColor=self.hsbaToHex(self.colors.color.first.hsba)}
color='linear-gradient('+self.colors.gradient.angle+'deg,'+firstColor+','+secondColor+')'}else{if(self.colors.color.first.hsba.a<1){rgbaF=self.hsbaToRgba(self.colors.color.first.hsba);color='rgba('+rgbaF.r+','+rgbaF.g+','+rgbaF.b+','+rgbaF.a+')'}else{color=self.hsbaToHex(self.colors.color.first.hsba)}}
if(self.colors.initialColor!=='color'){self.$input.val(color).trigger('change')}},});$.fn.usofColorPicker=function(options){return this.each(function(){if($ush.toLowerCase(this.tagName)==='input'){$(this).data('usofColorPicker',new usofColorPicker(this,options))}})};_window.usofColorPicker={colorNameToHex:api_usofColorPicker.colorNameToHex,gradientParser:api_usofColorPicker.gradientParser,hexToRgba:api_usofColorPicker.hexToRgba,hide:api_usofColorPicker.hide,isGradient:api_usofColorPicker.isGradient,colorIsValid:api_usofColorPicker.colorIsValid,normalizeHex:api_usofColorPicker.normalizeHex,rgbaToHex:api_usofColorPicker.rgbaToHex,}}(jQuery);!function($,undefined){var _window=window,_document=document;if(_window.$usof===undefined){return}
$usof.field.backup={init:function(){this.$backupStatus=this.$row.find('.usof-backup-status');this.$btnBackup=this.$row.find('.usof-button.type_backup').on('click',this.backup.bind(this));this.$btnRestore=this.$row.find('.usof-button.type_restore').on('click',this.restore.bind(this));var $i18n=this.$row.find('.usof-backup-i18n');this.i18n={};if($i18n.length>0){this.i18n=$i18n[0].onclick()||{}}},backup:function(){this.$btnBackup.addClass('loading');$.ajax({type:'POST',url:$usof.ajaxUrl,dataType:'json',data:{action:'usof_backup',_wpnonce:this.$row.closest('.usof-form').find('[name="_wpnonce"]').val(),_wp_http_referer:this.$row.closest('.usof-form').find('[name="_wp_http_referer"]').val()},success:function(result){this.$backupStatus.html(result.data.status);this.$btnBackup.removeClass('loading');this.$btnRestore.show()}.bind(this)})},restore:function(){if(!confirm(this.i18n.restore_confirm)){return}
this.$btnRestore.addClass('loading');$.ajax({type:'POST',url:$usof.ajaxUrl,dataType:'json',data:{action:'usof_restore_backup',_wpnonce:this.$row.closest('.usof-form').find('[name="_wpnonce"]').val(),_wp_http_referer:this.$row.closest('.usof-form').find('[name="_wp_http_referer"]').val()},success:function(result){this.$btnRestore.removeClass('loading');alert(result.data.message);location.reload()}.bind(this)})}}}(jQuery);!function($,undefined){var _window=window,_document=document,_undefined=undefined;if(_window.$usof===_undefined){return}
$usof.field.checkboxes={init:function(){var self=this;self._separator=self.$input.data('separator')||',';self._isMetabox=self.$input.data('metabox')||!1;self.$checkboxes=$('input[type=checkbox]',self.$row);self._events={changeValue:self._changeValue.bind(self)};self.$row.on('click','input[type=checkbox]',self._events.changeValue);var value=self.$input.val();if(value){self.setValue(value)}},_changeValue:function(){var self=this,values=[],checkboxes=self.$checkboxes.toArray();for(var i in checkboxes){if(!!checkboxes[i].checked&&!!checkboxes[i].value){values.push(checkboxes[i].value)}}
var value=values.join(self._separator);self.$input.val(value);self.trigger('change',[value])},getValue:function(){return this.$input.val()},setValue:function(value){var self=this,values=$.isArray(value)?value:(''+value).split(self._separator);self.$checkboxes.each(function(){$(this).removeAttr('checked').prop('checked',$.inArray(this.value,values)>-1)});self.$input.val($.isArray(value)?value.join(self._separator):value)}};$usof.field.check_table={getValue:function(){var self=this,value={};$.each(self.$input,function(){value[this.value]=(this.checked)?1:0});return value},setValue:function(value,quiet){var self=this;$.each(self.$input,function(){$(this).attr('checked',(value[this.value]===_undefined||value[this.value]==1)?'checked':!1)})}}}(jQuery);!function($,undefined){"use strict";var _window=window,_document=document;if($ush.isUndefined(_window.$usof)){return}
const _REGEXP_HEX_VALUE_=/^\s?\#([\dA-f]{3,6})\s?$/;const _REGEXP_RGB_VALUE_=/^([^\d]{1,3})*(\d{1,3})[^,]*,([^\d]{1,3})*(\d{1,3})[^,]*,([^\d]{1,3})*(\d{1,3})[\s\S]*$/;const _REGEXP_RGBA_VALUE_=/^([^\d]{1,3})*(\d{1,3})[^,]*,([^\d]{1,3})*(\d{1,3})[^,]*,([^\d]{1,3})*(\d{1,3})[^,]*,[^.]*.([^\d]{1,2})*(\d{1,2})[\s\S]*$/;$usof.field.color={init:function(options){var self=this;self._events={changeValue:self._changeValue.bind(self),clearValue:self._clearValue.bind(self),hideList:self._hideList.bind(self),inputValue:self._inputValue.bind(self),selectedVariableInList:self._selectedVariableInList.bind(self),toggleList:self._toggleList.bind(self),};self.$container=$('.usof-color',self.$row);self.$list=$('.usof-color-list',self.$container);self.$preview=$('.usof-color-preview',self.$container);self.isInitVariablesList;self.withGradient=self.$container.hasClass('with_gradient');self.withColorList=self.$container.hasClass('with_color_list');var colorValue=self.getColorValue();self.$preview.css('background',colorValue);self.$input.toggleClass('white',self.isWhiteTextColor(colorValue));self.$container.on('click','.usof-color-clear',self._events.clearValue);self.$input.on('input',self._events.inputValue).on('change',self._events.changeValue).off('click').on('click',function(){self.$input.usofColorPicker()});if(self.withColorList){self.$container.on('click','.usof-color-arrow',self._events.toggleList).on('click','.usof-color-list-item',self._events.selectedVariableInList)}
$(_document).mouseup(self._events.hideList)},isCssVariable:function(value){var self=this;if(self.withColorList){return/^_([\dA-z\-_]+)$/.test(value)}
return!1},isDynamicVariable:function(value){var self=this;if(self.withColorList){return/^{{([\dA-z\/\|\-_]+)}}$/.test(value)}
return!1},valueIsValid:function(value){var self=this;return(value===''||value==='inherit'||value==='transparent'||self.isCssVariable(value)||self.isDynamicVariable(value)||usofColorPicker.isGradient(value)||usofColorPicker.colorNameToHex(value)||_REGEXP_RGB_VALUE_.test(value)||_REGEXP_RGBA_VALUE_.test(value)||_REGEXP_HEX_VALUE_.test(value))},isWhiteTextColor:function(backgroundColor){var self=this,backgroundColor=$ush.toString(backgroundColor),whiteHex=usofColorPicker.colorNameToHex('white');if(!backgroundColor||backgroundColor==='inherit'||backgroundColor==='transparent'){return!1}
if(self.isCssVariable(backgroundColor)||self.isDynamicVariable(backgroundColor)){backgroundColor=self.getColorValue();if(self.isDynamicVariable(backgroundColor)){backgroundColor=whiteHex}}
if(backgroundColor.slice(0,1)=='#'&&backgroundColor.length===4){backgroundColor=backgroundColor.replace(/^#([\dA-f])([\dA-f])([\dA-f])$/,"#$1$1$2$2$3$3")}
else if(backgroundColor.indexOf('linear-gradient')>-1){backgroundColor=(usofColorPicker.gradientParser(backgroundColor)||{}).hex||backgroundColor}
if(/^([A-z\-]+)$/.test(backgroundColor)){backgroundColor=usofColorPicker.colorNameToHex(backgroundColor)||whiteHex}
var rgba=$.extend({r:0,g:0,b:0,a:1,},usofColorPicker.hexToRgba(backgroundColor));var light=rgba.r*0.213+rgba.g*0.715+rgba.b*0.072;if(rgba.a<1){light=light+(1-rgba.a)*(1-light/255)*235}
return light<178},_toggleList:function(e){var self=this;if(!self.$container.hasClass('show')){self.initVariablesList()}
self.$container.toggleClass('show')},_hideList:function(e){var self=this;if(!self.$container.hasClass('show')){return}
if(!self.$container.is(e.target)&&!self.$container.has(e.target).length){self.$container.removeClass('show')}},_selectedVariableInList:function(e){this.setSelectedVariable(e.currentTarget.dataset.name)},_inputValue:function(){var self=this,value=self.getValue(),isDynamicVariable=self.isDynamicVariable(value);if(self.isCssVariable(value)||isDynamicVariable){self.initVariablesList()}
if(isDynamicVariable){self.$preview.css('background','white')}},_changeValue:function(){var self=this,value=self.getValue();self.setValue(value);self.trigger('change',value)},_clearValue:function(){var self=this;if(self.$container.hasClass('show')){self.$container.removeClass('show')}
$('.selected',self.$list).removeClass('selected');self.setValue('')},setSelectedVariable:function(name,quiet){var self=this,name=$ush.toString(name),$target=$('[data-name="'+name+'"]:first',self.$list),colorValue=$ush.toString($target.data('value'));if(self.isDynamicVariable(name)){colorValue='white'}
$('[data-name].selected',self.$list).removeClass('selected');if($target.length){$target.addClass('selected');self.$input.val($ush.toString($target.data('name')))}else{self.$input.val(name)}
if(!quiet){self.trigger('change',self.$input.val())}
self.$container.removeClass('show');self.$preview.css('background',colorValue);self.$input.toggleClass('white',self.isWhiteTextColor(colorValue))},initVariablesList:function(){var self=this;if(self.isInitVariablesList){return}
var _insert=function($parent,item){if(self.name===item.name){return}
var $item=$('<div></div>'),$preview='';if(!$ush.isUndefined(item.value)){$preview=$(`
						<div class="usof-color-list-item-value">
							<span style="background:`+item.value+`" title="`+item.value+'  '+item.title+`"></span>
						</div>
					`)}
$item.addClass('usof-color-list-item').toggleClass('selected',item.name==self.getValue()).attr('data-name',item.name).data('value',item.value);$parent.addClass(item.type);if(item.type=='cf_colors'){$item.append('<span class="usof-color-list-item-title">'+item.title+'</span>')}else{$item.append($preview.toggleClass('white',self.isWhiteTextColor(item.value)))}
$parent.append($item)};$.each($usof.getData('colorList')||{},function(groupKey,items){if($.isArray(items)&&items.length){var $group=$('> [data-group="'+groupKey+'"]:first',self.$list);if(!$group.length){$group=$('<div class="usof-color-list-group" data-group="'+groupKey+'"></div>');self.$list.append($group)}
$.each(items,function(_,item){_insert($group,item)})}else{_insert(self.$list,items)}});self.isInitVariablesList=!0},getColorValue:function(){var self=this,value=self.getValue();if(self.isCssVariable(value)){value=$ush.toString($usof.getData('colorVars')[value])||self.$container.data('value')||value}
return $ush.toString(value).trim()},setValue:function(value,quiet){var self=this;value=$ush.toString(value).trim();if(self.withColorList){$('[data-name].selected',self.$list).removeClass('selected')}
if(self.isCssVariable(value)||self.isDynamicVariable(value)){self.initVariablesList();self.setSelectedVariable(value,quiet);return}
if(!self.valueIsValid(value)){if(_REGEXP_HEX_VALUE_.test('#'+value)){value=usofColorPicker.normalizeHex(value)}else{value=''}}
var m,hex;if(usofColorPicker.isGradient(value)){var gradient=usofColorPicker.gradientParser(value);if(gradient){value=gradient[self.withGradient?'gradient':'hex']}}else if(m=_REGEXP_RGBA_VALUE_.exec(value)){var r=m[2]<=255?m[2]:255,g=m[4]<=255?m[4]:255,b=m[6]<=255?m[6]:255,a=m[8];value='rgba('+r+','+g+','+b+',0.'+a+')'}else if(m=_REGEXP_RGB_VALUE_.exec(value)){value=usofColorPicker.rgbaToHex({r:m[2],g:m[4],b:m[6],})}else if(hex=usofColorPicker.colorNameToHex(value)){value=hex}
self.$preview.css('background',value);self.$input.toggleClass('white',self.isWhiteTextColor(value));self.parentSetValue(value,quiet)},getValue:function(){return $ush.toString(this.$input.val()).trim()}}}(jQuery);!function($,undefined){var _window=window;_window.$ush=_window.$ush||{};if($ush.isUndefined(_window.$usof)){return}
$usof.field.css=$usof.field.html={init:function(){var self=this;self._params={};self.editor=null;self.editorDoc=null;self._events={editorChange:self._editorChange.bind(self),editorFocused:self._editorFocused.bind(self),};if(wp.hasOwnProperty('codeEditor')){var $params=$('.usof-form-row-control-params',self.$row);if($params.is('[onclick]')){self._params=$params[0].onclick()||{};$params.removeAttr('onclick')}
if(self._params.editor!==!1){self._params.editor.codemirror.lint=!1;self.editor=wp.codeEditor.initialize(self.$input[0],self._params.editor||{});self.editorDoc=self.editor.codemirror.getDoc();self.setValue(self.$input.val());self.editor.codemirror.on('focus',self._events.editorFocused);self.editor.codemirror.on('blur',self._events.editorFocused)}}else{self.$input.on('keyup',function(){self.parentSetValue(self.getValue());self.setValue(self.$input.val())})}},_editorChange:function(){this.parentSetValue(this.getValue())},_editorFocused:function(_,e){this.$row.toggleClass('focused',(e instanceof FocusEvent))},isContentEncoded:function(){return(this._params||{}).encoded},setValue:function(value,quiet){var self=this;if(self.isContentEncoded()){value=$ush.rawurldecode($ush.base64Decode(value))}
if(!$ush.isUndefined(self.editor)&&wp.hasOwnProperty('codeEditor')){self.editorDoc.off('change',self._events.editorChange);self.editorDoc.setValue(value);self.editorDoc.on('change',self._events.editorChange);$ush.timeout(function(){self.editorDoc.cm.refresh()},50)}},getValue:function(){var self=this,value=(!$ush.isUndefined(self.editor)&&wp.hasOwnProperty('codeEditor'))?self.editorDoc.getValue():self.$input.val();return(self.isContentEncoded()?$ush.base64Encode($ush.rawurlencode(value)):value)}}}(jQuery);!function($,undefined){var _window=window;if(_window.$usof===undefined){return}
$usof.field.custom_dropdown={init:function(){this.$container=$('.usof-custom-dropdown',this.$row);this.$options=$('.usof-custom-dropdown-item',this.$container);this.$list=$('.usof-custom-dropdown-list',this.$container);this._events={hideList:this._hideList.bind(this),selectItem:this._selectItem.bind(this),toggleList:this._toggleList.bind(this),};this.$options.on('click',this._events.selectItem);this.$list.on('click',this._events.toggleList).on('mouseleave',this._events.hideList)},_toggleList:function(){this.$list.toggleClass('show',!this.$list.hasClass('show'))},_hideList:function(){this.$list.removeClass('show')},_selectItem:function(e){this.setValue($(e.currentTarget).data('value')||null,!0)},setValue:function(value){this.$options.removeClass('current').filter('[data-value="'+value+'"]').addClass('current',!0);this.$input.val(value);this.trigger('change',value)},getValue:function(){return this.$input.val()||''}}}(jQuery);!function($,undefined){var _window=window,_document=document;var isPlainObject=$.isPlainObject;if(_window.$usof===undefined){return}
$usof.field.select={init:function(options){var self=this;self.hintsData={};self._events={changeSelect:self._changeSelect.bind(self),syncResponsiveValue:self._syncResponsiveValue.bind(self),};self.$select=$('select:first',self.$row);self.$container=$('.usof-select',self.$row);self.$hint=$('.usof-form-row-hint',self.$row);if(self.$hint.is('[onclick]')){var hintsData=self.$hint[0].onclick();if(!isPlainObject(hintsData)){hintsData={}}
self.hintsData=hintsData;self.$hint.removeAttr('onclick')}
self.$row.on('change','select',self._events.changeSelect);if(self.hasResponsive()){self.on('setResponsiveState',self._events.syncResponsiveValue)}
self._syncSelected()},_changeSelect:function(){var self=this,value=self.$select.val();self.setCurrentValue(value);self._syncSelected(value);self._showGridLayoutDesc()},_syncResponsiveValue:function(){this._syncSelected()},_syncSelected:function(value){var self=this;if($ush.isUndefined(value)){value=self.getCurrentValue()}
self.$select.val(value);self._setEditLink(value);self.$container.attr('selected-value',value);self._showGridLayoutDesc()},_setEditLink:function(value){var self=this,defaultLayout=$('option:selected',self.$select).data('default-layout');if(!isPlainObject(defaultLayout)){defaultLayout={}}
if($ush.parseInt(defaultLayout.id)){value=$ush.toString(defaultLayout.id)}
if(!self.hintsData.no_posts){if(value&&$ush.parseInt(value)){var hint='';if(self.hintsData.hasOwnProperty('edit_url')){var regex=/(<a [^{]+)({{post_id}})([^{]+)({{hint}})([^>]+>)/,title=(defaultLayout.title?self.hintsData.edit_specific+' '+defaultLayout.title:self.hintsData.edit);hint=self.hintsData.edit_url.replace(regex,'$1'+value+'$3'+title+'$5')}
self.$hint.html(hint)}else{self.$hint.html('')}}},_showGridLayoutDesc:function(){var self=this;if(!self.$row.hasClass('for_grid_layouts')){return}
var value=self.getCurrentValue(),isVC=self.isVCParamValue(),isNumericValue=$.isNumeric(value),$addDesc=$('.us-grid-layout-desc-add',isVC?self.$row.parent():self.$row),$editLink=$('.us-grid-layout-desc-edit',isVC?self.$row.parent():self.$row);if(isNumericValue){$('.edit-link',$editLink).attr('href',(self.$container.data('edit_link')||'').replace('%d',value))}
$addDesc[isNumericValue?'addClass':'removeClass']('hidden');$editLink[isNumericValue?'removeClass':'addClass']('hidden')},setValue:function(value,quiet){var self=this;self.parentSetValue(''+value);self._syncSelected();if(!quiet){self.$input.trigger('change')}}}}(jQuery);!function($,undefined){var _window=window,_document=document,isUndefined=$ush.isUndefined;if(isUndefined(_window.$usof)){return}
$usof.field.font={init:function(options){var self=this;self.parentInit(options);self.$preview=$('.usof-text-preview',self.$row);self.$weightsContainer=$('.usof-checkbox-list',self.$row);self.$weightCheckboxes=$('.usof-checkbox',self.$weightsContainer);self.$weights=$('input',self.$weightsContainer);self.fieldFontFamily={};self.fontFamily='none';function _updateValue(){self.setValue(self.getFontValue())}
var $fieldFontFamily=$('.type_autocomplete',self.$row);if($fieldFontFamily.length){var fieldFontFamily=new $usof.field($fieldFontFamily);fieldFontFamily.trigger('beforeShow');self.fontFamily=fieldFontFamily.getValue();fieldFontFamily.setValue(self.fontFamily);fieldFontFamily.on('change',_updateValue);self.fieldFontFamily=fieldFontFamily}
self.updatePreview();self.$weights.on('change',_updateValue);_updateValue()},loadGoogleFont:function(){var self=this,fontFamily=self.fontFamily;if(['get_h1','none'].indexOf(fontFamily)>-1){return}
fontFamily=fontFamily.replace(/\s+/g,'+');var $head=$('head');if(!$('link[data-family="'+fontFamily+'"]',$head).length){$head.append('<link href="//fonts.googleapis.com/css?family='+fontFamily+'" rel="stylesheet" data-family="'+fontFamily+'" />')}},updatePreview:function(){var self=this;self.loadGoogleFont();var fontFamily=$ush.toString(self.fontFamily);if(fontFamily=='none'){fontFamily=''}
if(fontFamily.indexOf(' ')>-1){fontFamily="'"+fontFamily+"'"}
var fallback=($usof.googleFonts[self.fontFamily]!==undefined)?$usof.googleFonts[self.fontFamily].fallback||'sans-serif':'sans-serif';self.$preview.css('font-family',fontFamily+', '+fallback)},getFontValue:function(){var self=this,fontFamily=$ush.toString(self.fieldFontFamily.getValue()),fontWeights=[];self.$weights.filter(':checked').each(function(_,node){var value=$ush.toString(node.value);var variants=($usof.googleFonts[self.fontFamily]!==undefined)?$usof.googleFonts[fontFamily].variants||[]:[];if(variants.indexOf(value)>-1){fontWeights.push(value)}});return fontFamily+'|'+fontWeights.join(',')},setValue:function(value,quiet){var self=this,fontValues=$ush.toString(value).split('|'),fontFamily=$ush.toString(fontValues[0]||'none'),fontWeights=$ush.toString(fontValues[1]||'400,700').split(',');self.parentSetValue(value,quiet);self.fieldFontFamily.setValue(fontFamily,!0);if(fontFamily!==self.fontFamily){self.$weightCheckboxes.each(function(_,node){var $node=$(node),checkboxValue=$ush.toString(node.dataset.value),variants=($usof.googleFonts[self.fontFamily]!==undefined)?$usof.googleFonts[fontFamily].variants||[]:[],hasVariant=variants.indexOf(checkboxValue)<0;$node.toggleClass('hidden',hasVariant).find('input').prop(':checked',fontWeights.indexOf(checkboxValue)>-1)})}
self.fontFamily=fontFamily;self.updatePreview();if(!quiet){self.trigger('change',[value])}}}}(jQuery);!function($,undefined){$usof.field.typography_options={init:function(options){var self=this;self._events={changePropField:$ush.debounce(self._changePropField.bind(self),1),switchSection:self._switchSection.bind(self),};self.fields={};self._$fontWeights=[];self._usbParams=self.$row.data('usb-params')||{};self._notExistsText='';var $notExistsText=$('.us-font-weight-not-exists-text:first',self.$row);if($notExistsText.length){self._notExistsText=$notExistsText.text();$notExistsText.remove()}
self.$head=$('head');self.$title=$('> .usof-form-row-title',self.$row);self.$typographyVars=$('#us-typography-vars');$('.usof-form-row-control:first [data-name]',self.$row).each(function(_,node){var $node=$(node),usofField=$node.data('usofField');if($ush.isUndefined(usofField)){usofField=$node.usofField()}
if(usofField instanceof $usof.field){var name=$node.data('name');usofField.on('change',self._events.changePropField).on('syncResponsiveState',function(field,screenName){if(self.isLiveBuilder()&&$usb.find('preview')){$usb.preview.fieldSetResponsiveScreen(screenName)}
if(!self.isLiveBuilder()){$ush.debounce_fn_1ms(self._renderFontPreview.bind(self));$.each(self.fields,function(name,_field){if(field.name!==name){_field._usbSyncResponsiveState(_field,screenName)}})}});self.fields[name]=usofField;if(usofField.type==='select'&&['font-weight','bold-font-weight'].indexOf(name)>-1){$('option',usofField.$row).each(function(_,node){if($ush.toString(node.value).indexOf('var(')===0){return}
$node=$(node);$node.data('text',$node.text());self._$fontWeights.push($node)})}}});self.$row.on('click','> .usof-form-row-title',self._events.switchSection);if(!self.isLiveBuilder()){self.on('afterShow',function(){self._setFontProperties(self.getValue())})}},_switchSection:function(e){var self=this;self.$row.toggleClass('expand',!self.$row.hasClass('expand')).siblings().removeClass('expand')},_syncAvailableWeights:function(fontFamily){var self=this;for(var i in self._$fontWeights){var $node=self._$fontWeights[i];if($node.hasClass('not-exists')){$node.text($node.data('text')).removeClass('not-exists')}}
var googleFonts=$usof.getData('googleFonts');if(!$.isPlainObject(googleFonts)){googleFonts={}}
if(!fontFamily||!googleFonts[fontFamily]){return}
var googleFontWeights=(''+googleFonts[fontFamily]).split(',').map(function(value){return $ush.parseInt(value)});for(var i in self._$fontWeights){var $node=self._$fontWeights[i],isNotExists=$.inArray($ush.parseInt($node.attr('value')),googleFontWeights)===-1;if(isNotExists){var text=$node.data('text');if(self._notExistsText){text+=' '+self._notExistsText}
$node.text(text);$node.addClass('not-exists')}}},_setFontProperties:function(values,quiet){var self=this;if(self.isObjectValue(values)){values=$ush.toPlainObject(values)}
if(!$.isPlainObject(values)){values={}}
for(var name in self.fields){var usofField=self.fields[name];if(usofField instanceof $usof.field){var value=$ush.isUndefined(values[name])?usofField.getDefaultValue():values[name];usofField.off('change');usofField.setValue(value,quiet);usofField.on('change',self._events.changePropField)}}
self._syncAvailableWeights(values['font-family'])},_changePropField:function(usofField,value){var self=this;var props={};for(var name in self.fields){props[name]=self.fields[name].getValue()}
var $usbField=usofField[usofField instanceof $usof.field?'$row':'$field'];self.$row.data('usbParams',$usbField.data('usb-params')||self._usbParams);self.setCurrentValue(!$.isEmptyObject(props)?props:'');self._syncAvailableWeights(props['font-family']);if(!self.isLiveBuilder()){$ush.debounce_fn_1ms(self._renderFontPreview.bind(self))}},getCurrentValue:function(){var self=this,result={};for(var name in self.fields){result[name]=self.fields[name].getCurrentValue()}
return result},setValue:function(value,quiet){var self=this;if($.isPlainObject(value)){value=$ush.toString(value)}
self._setFontProperties(value);self.parentSetValue(value);if(quiet){self.trigger('change',[value])}},_renderFontPreview:function(){var self=this;if(!self.fields['font-family']){return}
var props={};for(var name in self.fields){props[name]=self.fields[name].getCurrentValue()}
function _getFontFamily(value){if(value==='none'||value==='inherit'){return ''}
if(value.indexOf(',')===-1&&value.indexOf(' ')>-1){return '"'+value+'"'}
return value}
var origFontFamily=props['font-family'];props['font-family']=_getFontFamily(origFontFamily);var cssProp=$ush.clone(props),$textPreview=$('.usof-text-preview',self.fields['font-family'].$row);$('strong',$textPreview).css('font-weight',props['bold-font-weight']);if(!$ush.isUndefined(cssProp['bold-font-weight'])){delete cssProp['bold-font-weight']}
if(['none','inherit'].indexOf(origFontFamily)>-1){cssProp['font-family']=''}
$textPreview.css(cssProp);if(['body','h1'].indexOf(self.name)>-1){var parent=self.getParent();if(!$ush.isUndefined(parent)){var parentValues=parent.getCurrentValues(),cssVars=[];if((parentValues.body||{})['font-family']){cssVars.push('--body-font-family:'+_getFontFamily(parentValues.body['font-family']))}
if($.isPlainObject(parentValues.h1)){['font-family','font-weight','bold-font-weight'].map(function(name){if(!$ush.isUndefined(parentValues.h1[name])){var value=parentValues.h1[name];if(name==='font-family'){value=_getFontFamily(value)}
if(value){cssVars.push('--h1-'+name+':'+value)}}})}
self.$typographyVars.text(':root{'+cssVars.join(';')+'}')}}
if(origFontFamily.indexOf(',')===-1&&origFontFamily.indexOf('var(--')===-1){var googleFonts=$usof.getData('googleFonts')||{};if(googleFonts[origFontFamily]&&$usof.googlefontEndpoint){var $linkToResource=$('link[data-font-for="'+self.name+'"]',self.$head);if(!$linkToResource.length){$linkToResource=$('<link>',{rel:'stylesheet','data-font-for':self.name,'href':''});self.$head.append($linkToResource)}
var urlManager=new URL($usof.googlefontEndpoint);urlManager.searchParams.set('family',origFontFamily+':'+googleFonts[origFontFamily]);if($linkToResource.attr('href')!==urlManager.toString()){$linkToResource.attr('href',urlManager.toString())}}}}}}(jQuery);!function($,undefined){var _window=window,_undefined=undefined;if($ush.isUndefined(_window.$usof)){return}
const _KEYCODES_={ENTER:13,ESCAPE:27};var _$temp={endOfListReached:!1,typingTimer:!1,xhr:_undefined,};$usof.field.autocomplete={init:function(){var self=this;self.disableScrollLoad=!1;self.relatedField;self.options={ajax_data:{},multiple:!1,sortable:!1,value_separator:',',no_results_found:'No results found.',text_in_placeholder:'...',};self._events={keyup:self._keyup.bind(self),showList:self._showList.bind(self),hideList:self._hideList.bind(self),toggleList:self._toggleList.bind(self),scrollList:self._scrollList.bind(self),searchRequest:self._searchRequest.bind(self),searchItems:self._searchItems.bind(self),selectedValue:self._selectedValue.bind(self),removeSelectedValue:self._removeSelectedValue.bind(self),changeRelatedField:$ush.debounce(self._changeRelatedField.bind(self),1),};self.$container=$('.usof-autocomplete',self.$row);self.$options=$('.usof-autocomplete-options',self.$container);self.$search=$('input[type="text"]',self.$container);self.$toggle=$('.usof-autocomplete-toggle',self.$container);self.$list=$('.usof-autocomplete-list',self.$container);self.$value=$('> .usof-autocomplete-value',self.$container);self.$message=$('.usof-autocomplete-message',self.$container);if(self.$container.is('[onclick]')){$.extend(self.options,self.$container[0].onclick()||{})}
self.hasAjaxHandler=!$ush.isUndefined($ush.toPlainObject(self.options.ajax_data).action);self.$container.on('click','.usof-autocomplete-list [data-value]',self._events.selectedValue);if(self.isMultiple()){self.$container.on('click','.usof-autocomplete-selected button',self._events.removeSelectedValue)}else{if($('.usof-autocomplete-selected',self.$options).length){self.$container.on('click','.usof-autocomplete-selected:first',self._events.showList)}else{self.$options.on('click',self._events.showList)}}
self.$search.on('keyup',self._events.keyup).on('keyup',self._events[self.hasAjaxHandler?'searchRequest':'searchItems']).on('focus',self._events.toggleList);if(self.isMultiple()){self.$toggle.on('mouseleave',self._events.hideList)}else{self.$search.on('blur',self._events.toggleList)}
if(self.hasAjaxHandler){self.$list.on('scroll',self._events.scrollList);self.relatedField=self.getRelatedField();if(self.relatedField instanceof $usof.field){self.relatedField.on('change',self._events.changeRelatedField)}
if(self.$list.is(':empty')){$ush.timeout(self.getItems.bind(self),15)}}
if(self.isMultiple()&&self.options.sortable){var dragdrop=new $usof.dragDrop(self.$options,{itemSelector:'> .usof-autocomplete-selected'})
dragdrop.on('dragend',self._saveValue.bind(self))}},isMultiple:function(){return!!this.options.multiple},getItems:function(callback,itemIds){var self=this;if(!$ush.isUndefined(_$temp.xhr)&&!_$temp.xhr._skipAbort){_$temp.xhr.abort()}
var queryArgs=self.options.ajax_data;if(!$.isPlainObject(queryArgs)){queryArgs={}}
var data=$ush.clone(queryArgs);var search=$.trim(self.$search.val());if(search){data.search=search}
var valueSeparator=self.options.value_separator;if(!$.isArray(itemIds)){itemIds=$ush.toString(itemIds);itemIds=itemIds?itemIds.split(valueSeparator):[]}
if(itemIds.length){data.itemIds=itemIds.join(valueSeparator)}else{data.offset=$('[data-value]',self.$list).length}
if(self.relatedField instanceof $usof.field){data[self.relatedField.name]=self.relatedField.getCurrentValue()}
self.clearMessage();self.$container.addClass('loading');var valueList=$ush.toString(self.getValue()).split(valueSeparator);_$temp.xhr=$.ajax({data:data,dataType:'json',url:$usof.ajaxUrl,cache:!1,success:function(res){if(!res.success){self._showMessage.call(self,res.data.message);return}
var items=res.data.items;if(!$.isArray(items)){items=[]}
if(!itemIds.length){items.map(function(item){var itemValue=$ush.toString(item.value);var $item=$('<div>',{'data-value':$ush.stripTags(itemValue),'data-text':$ush.stripTags(item.name),'tabindex':3});if(valueList.indexOf(itemValue)>-1){$item.addClass('selected')}
self.$list.append($item.html(item.name))})}
if($.isFunction(callback)){callback.call(self,items)}
self.trigger('data.loaded',res.data.items)},complete:function(_,textStatus){if(textStatus!=='abort'){_$temp.xhr=_undefined;self.$container.removeClass('loading')}}});_$temp.xhr._skipAbort=itemIds.length},_searchRequest:function(e){var self=this;if(_$temp.typingTimer){$ush.clearTimeout(_$temp.typingTimer)}
_$temp.typingTimer=$ush.timeout(function(){self._clearList();self.getItems(function(items){if($.isEmptyObject(items)){self.showMessage(self.options.no_results_found)}});$ush.clearTimeout(_$temp.typingTimer)},500)},_searchItems:function(e){var self=this,value=$ush.toLowerCase(e.currentTarget.value);self.clearMessage();if(!value){$('.hidden',self.$list).removeClass('hidden');return}
var $items=$('[data-value]',self.$list);$items.addClass('hidden').filter('[data-text^="'+value+'"], [data-text*="'+value+'"]').removeClass('hidden');$('[data-group]',self.$list).each(function(){var $group=$(this);$group.toggleClass('hidden',!$('[data-value]:not(.hidden)',$group).length)});if(!$items.is(':visible')){self.showMessage(self.options.no_results_found)}},_keyup:function(e){var self=this;if(e.keyCode===_KEYCODES_.ENTER){$('[data-value]:not(.selected):visible:first',self.$list).trigger('click')}
if([_KEYCODES_.ENTER,_KEYCODES_.ESCAPE].indexOf(e.keyCode)>-1){self.$toggle.removeClass('show');self.$search.trigger('blur')}},_showList:function(e){var self=this;self.$toggle.addClass('show');self.$search.focus()},_toggleList:function(e){var self=this,isFocus=(e.type==='focus'),handle=$ush.timeout(function(){self.$toggle.toggleClass('show',isFocus);$ush.clearTimeout(handle)},(isFocus?0:150))},_hideList:function(e){var self=this;if(self.isMultiple()&&self.$toggle.hasClass('show')){self.$toggle.removeClass('show');self.$search.blur()}},_scrollList:function(e){var self=this,target=e.currentTarget,$target=$(target);if(!_$temp.endOfListReached&&$ush.isUndefined(_$temp.xhr)&&($target.scrollTop()+$target.height())>=(target.scrollHeight-1)){self.getItems(function(items){if($.isEmptyObject(items)){_$temp.endOfListReached=!0}})}},_clearList:function(){_$temp.endOfListReached=!1;$('[data-value]',this.$list).remove()},_loadSelectedValues:function(value){var self=this,$selected=$('.usof-autocomplete-selected',self.$options),textInPlaceholder=self.options.text_in_placeholder;if(!self.hasAjaxHandler||$selected.length){return}
$('.selected',self.$list).removeClass('selected');$selected.remove();if(value){var itemIds=value.split(self.options.value_separator).map($.trim);self.$options.addClass('show_placeholders');itemIds.map(function(id){self._showSelectedValue(id,textInPlaceholder)});self.getItems(function(items){$('.usof-autocomplete-selected',self.$options).remove();self.$options.removeClass('show_placeholders');var itemLabels={};items.map(function(item){itemLabels[item.value]=item.name});itemIds.map(function(id){self._showSelectedValue(id,itemLabels[id]||id)})},itemIds)}},_showSelectedValues:function(value){var self=this,$selected=$('.usof-autocomplete-selected',self.$options);if($selected.length){return}
$('.selected',self.$list).removeClass('selected');$selected.remove();if(value){var itemIds=value.split(self.options.value_separator);itemIds.map(function(itemId){var label=$('[data-value="'+itemId+'"]',self.$list).first().text();self._showSelectedValue(itemId,label)})}},_showSelectedValue:function(value,label){var self=this;if(!value){return}
if(!self.isMultiple()){$('.usof-autocomplete-selected',self.$options).remove();$('.selected',self.$list).removeClass('selected')}
self.$options.append(`<div class="usof-autocomplete-selected">
					`+label+` <button type="button" class="fas fa-times" data-value="`+value+`"></button>
				</div>`);$('[data-value="'+value+'"]:not(.selected)',self.$list).addClass('selected')},_selectedValue:function(e){var self=this,$target=$(e.currentTarget);if($target.hasClass('selected')&&self.isMultiple()){self._removeSelectedValue(e);return}
if(!self.isMultiple()){$('[data-value]',self.$list).removeClass('selected');$('.usof-autocomplete-selected',self.$options).remove()}
var value=$target.data('value');self._showSelectedValue(value,$target.html());self._saveValue()},_removeSelectedValue:function(e){var self=this,value=$(e.currentTarget).data('value');$('[data-value="'+value+'"]',self.$list).removeClass('selected');$('[data-value="'+value+'"]',self.$options).parent().remove();self._saveValue()},_saveValue:function(){var self=this,value=[];$('[data-value]',self.$options).each(function(_,node){value.push($(node).data('value'))});self.setValue(value.join(self.options.value_separator))},_changeRelatedField:$ush.debounce(function(){var self=this;if($ush.isUndefined(_$temp.xhr)){$('.usof-autocomplete-selected',self.$options).remove();$('.selected',self.$list).removeClass('selected');self.$value.val('');self.trigger('change')}
self._clearList();self.getItems(function(items){if($.isEmptyObject(items)){self.showMessage(self.options.no_results_found)}})},1),showMessage:function(text){var self=this;self.$list.addClass('hidden');self.$message.text(text).removeClass('hidden')},clearMessage:function(){var self=this;self.$list.removeClass('hidden');self.$message.addClass('hidden').text('')},getValue:function(){var self=this;if(self.$value instanceof $){return self.$value.val()}else{var $value=$('.usof-autocomplete-value',self.$row)
return($value.length)?$value.val():''}},setValue:function(value,quiet){var self=this;self.$value.val(value);if(self.hasAjaxHandler){if(value){self._loadSelectedValues(value)}}else{self._showSelectedValues(value)}
if(!quiet){self.trigger('change',[value])}}}}(jQuery);!function($,undefined){"use strict";if($ush.isUndefined(window.$usof)){return}
$usof.field.radio=$usof.field.imgradio={init:function(){var self=this;self.$radio=$('input[type=radio]',self.$row);self._events={changeCurrentValue:self._changeCurrentValue.bind(self),syncRadioButtons:self._syncRadioButtons.bind(self)};self.$row.on('click','input[type=radio]',self._events.changeCurrentValue);if(self.hasResponsive()){self.on('setResponsiveState',self._events.syncRadioButtons)}},_changeCurrentValue:function(e){var self=this,value=(e.target||{}).value;if($ush.isUndefined(value)){value=self.getDefaultValue()}
self.setCurrentValue(value);self._syncRadioButtons()},_syncRadioButtons:function(){var self=this;self.$radio.removeAttr('checked').filter('[value="'+self.getCurrentValue()+'"]').prop('checked',!0)},setValue:function(value,quiet){var self=this;self.parentSetValue(''+value);self._syncRadioButtons()}}}(jQuery);!function($,undefined){var _window=window,_document=document;var isUndefined=$ush.isUndefined;_window.$ush=_window.$ush||{};if(isUndefined(_window.$usof)){return}
const _REGEXP_RELATED_FIELD_NAME_=/^([A-z\d_\-]+)_value$/;var _typingTimer=0;$usof.field.link={init:function(){var self=this;self.$container=$('.usof-link',self.$row);self.$linkAtts=$('.usof-link-attributes',self.$row);self.$valueSelected=$('.usof-form-input-dynamic-value',self.$row);self.$inputUrl=$('.usof-link-input-url',self.$row);self.$urlSearchResults=$('.usof-link-search-results',self.$row);self.$urlSearchNotice=$('.usof-link-search-message',self.$urlSearchResults);self.$checkboxes=$('input[type="checkbox"]',self.$linkAtts);self.popup={};self.relatedFields={};self._dynamicLabels={};self.hasDynamicValues=$('.usof-popup',self.$row).length;self._typingDelay=0.5;self.urlSearchDoingAjax=!1;self.urlSearchAjaxQueriesNumber=0;self.urlSearcAjaxQueryArgs={action:'usof_search_items_for_link',_nonce:self.$inputUrl.data('nonce')};self.$checkboxes.each(function(_,checkbox){var name=checkbox.name,$input=$('input[name="'+name+'_value"]',self.$linkAtts);if($input.length){self.relatedFields[name]=$input}});self._events={changeCheckbox:self._changeCheckbox.bind(self),removeDynamicValue:self._removeDynamicValue.bind(self),selectDynamicValue:self._selectDynamicValue.bind(self),toggleMenu:self._toggleMenu.bind(self),inputUrlKeyUpDown:self._inputUrlKeyUpDown.bind(self),toggleUrlSearchResults:self._toggleUrlSearchResults.bind(self),urlSearchResultsSelect:self._urlSearchResultsSelect.bind(self),urlSearchResultsScroll:self._urlSearchResultsScroll.bind(self),};if(self.hasDynamicValues){self.popupId=$ush.uniqid();$('[data-popup-id]',self.$row).attr('data-popup-id',self.popupId);$('[data-popup-show]',self.$row).attr('data-popup-show',self.popupId);self.popup=new $usof.popup(self.popupId,{closeOnEsc:!0,closeOnBgClick:!0,init:function(){this.$container.off('click').on('click','[data-dynamic-value]',self._events.selectDynamicValue).find('[data-dynamic-value]').each(function(_,node){var $node=$(node);if($node.data('dynamic-label')){self._dynamicLabels[$node.data('dynamic-value')]=$node.data('dynamic-label');$node.removeAttr('data-dynamic-label')}})},beforeShow:function(){var dynamicValue=self.$valueSelected.data('value');self._resetPopupButtons();if(!isUndefined(dynamicValue)){$('[data-dynamic-value="'+dynamicValue+'"]',this.$container).addClass('active')}}});if($.isEmptyObject(self.popup)){console.error('Failed to initialize popup')}}
self.$container.on('click','.action_toggle_menu',self._events.toggleMenu).on('input change','input[type="text"]',$ush.debounce(self.updateValue.bind(self),1));self.$inputUrl.off().on('keydown keyup',self._events.inputUrlKeyUpDown).on('focus blur',self._events.toggleUrlSearchResults);self.$urlSearchResults.off().on('mousedown','.usof-link-search-results-item',self._events.urlSearchResultsSelect).on('scroll',self._events.urlSearchResultsScroll);if(self.hasDynamicValues){self.$container.on('click','.action_remove_dynamic_value',self._events.removeDynamicValue)}
self.$linkAtts.on('change','.usof-checkbox',self._events.changeCheckbox);var value=self.getValue();if(value){self.setValue(value)}},hideMenu:function(){this.$container.removeClass('show_atts_settings')},_toggleMenu:function(e){e.preventDefault();this.$container.toggleClass('show_atts_settings')},_resetPopupButtons:function(skipDynamicValue){var self=this;if(self.popup.$container instanceof $){$('[data-dynamic-value!="'+skipDynamicValue+'"].active',self.popup.$container).removeClass('active')}},_changeCheckbox:function(e){var self=this,name=e.target.name;if(!e.target.checked&&self.relatedFields[name]){self.relatedFields[name].val('')}
$('.action_toggle_menu',self.$row).toggleClass('has_values',self.$checkboxes.is(':checked'));self.updateValue()},_selectDynamicValue:function(e){e.preventDefault();var self=this,$target=$(e.target),value=$target.data('dynamic-value');self._resetPopupButtons(value);$target.toggleClass('active');if($target.hasClass('active')){self.setDynamicValue(value);$usof.hidePopup($ush.toString(self.popupId))}else{self.removeDynamicValue()}
self.updateValue()},_removeDynamicValue:function(e){e.preventDefault();e.stopPropagation();var self=this;self.removeDynamicValue();self.updateValue()},setDynamicValue:function(value){if(!value){return}
var self=this,title=self._dynamicLabels[value]||value;self.$inputUrl.addClass('hidden').val('').trigger('change');self.$valueSelected.data('value',value).removeClass('hidden').find('.usof-form-input-dynamic-value-title').attr('title',title).text(title)},removeDynamicValue:function(){var self=this;self.$valueSelected.data('value',null).addClass('hidden');self.$inputUrl.removeClass('hidden')},_toggleUrlSearchResults:function(e){var self=this,isFocus=(e.type==='focus'),pid=$ush.timeout(function(){self.$urlSearchResults.toggleClass('hidden',!isFocus);$ush.clearTimeout(pid)},(isFocus?0:200))},_urlSearchResultsSelect:function(e){var self=this,$target=$(e.currentTarget),selectedUrl=$target.data('url')||'';if(selectedUrl){self.$inputUrl.val(selectedUrl).trigger('change');self._urlSearchResultsClear()}},_urlSearchResultsClear:function(){var self=this;$ush.timeout(function(){self.urlSearchAjaxQueriesNumber=0;self.$urlSearchResults.removeClass('loading').addClass('hidden');$('.usof-link-search-results-item',self.$urlSearchResults).remove()},200)},_inputUrlKeyUpDown:function(e){if(!e.currentTarget.value){return}
var self=this;if(_typingTimer){$ush.clearTimeout(_typingTimer)}
_typingTimer=$ush.timeout(function(){self._urlSearchInit.call(self,e);$ush.clearTimeout(_typingTimer)},1000).value;if($ush.toLowerCase(e.key)==='enter'){e.preventDefault();var $firstSearchResult=$('.usof-link-search-results-item:first',self.$urlSearchResults);if($firstSearchResult.length){$firstSearchResult.trigger('mousedown')}else{self.$inputUrl.val('').trigger('change')}
self.$urlSearchResults.addClass('hidden')}},_urlSearchInit:function(e){var self=this,$input=$(e.currentTarget),value=$.trim($input.val()).toLowerCase(),isUrl=!0;$('.usof-link-search-results-item',self.$urlSearchResults).remove();self.$urlSearchNotice.addClass('hidden');if(value===''||$.inArray(value.substring(0,1),['#','/','.'])!==-1){self._urlSearchResultsClear();return}
try{var _urlObj;_urlObj=new URL(value)}catch(_){isUrl=!1}
if(isUrl){self._urlSearchResultsClear();return}
self.urlSearchParams={search:value,posts_offset:0,posts_search_completed:0,terms_offset:0,terms_search_completed:0}
self.$urlSearchResults.show();$('.usof-link-search-results-item',self.$urlSearchResults).remove();self._urlSearchAjaxCall()},_urlSearchResultsScroll:function(e){var self=this,$target=$(e.currentTarget);if(!self.urlSearchParams.terms_search_completed&&!self.urlSearchDoingAjax&&($target.scrollTop()+$target.height())>=(e.currentTarget.scrollHeight-1)){self._urlSearchAjaxCall()}},_urlSearchAjaxCall:function(){var self=this,data=$.extend({},self.urlSearcAjaxQueryArgs||{},self.urlSearchParams);self.$urlSearchResults.addClass('loading');self.urlSearchDoingAjax=!0;self.urlSearchAjaxQueriesNumber++;var currentAjaxQueryNumber=self.urlSearchAjaxQueriesNumber;$.post(ajaxurl,data,function(res){if(self.urlSearchAjaxQueriesNumber==currentAjaxQueryNumber){if(!res.success){self.$urlSearchResults.find('.usof-link-search-results-item').remove();self.$urlSearchNotice.html(res.data.message).removeClass('hidden')}else if(res.data.items&&res.data.items.length>0){$.each(res.data.items,function(index,item){if($.isPlainObject(item)){var $item=$('<div class="usof-link-search-results-item" data-url="'+item.permalink+'">'+item.title+' <i>'+item.type+'</i></div>');self.$urlSearchResults.append($item)}})}else if(res.data.posts_offset==0&&res.data.terms_offset==0&&res.data.notice){$('.usof-link-search-results-item',self.$urlSearchResults).remove();self.$urlSearchNotice.html(res.data.notice).removeClass('hidden')}
self.urlSearchParams.posts_offset=res.data.posts_offset;self.urlSearchParams.posts_search_completed=res.data.posts_search_completed;self.urlSearchParams.terms_offset=res.data.terms_offset;self.urlSearchParams.terms_search_completed=res.data.terms_search_completed;self.$urlSearchResults.removeClass('loading');self.urlSearchDoingAjax=!1;self.urlSearchAjaxQueriesNumber=0}},'json')},updateValue:function(){var self=this,result={};var dynamicValue=self.$valueSelected.data('value');if(dynamicValue){dynamicValue=(''+dynamicValue).split('|');result.type=$ush.toString(dynamicValue[0]);if(dynamicValue.length==2){result[result.type]=$ush.toString(dynamicValue[1])}}
$('input[type!=hidden]',self.$container).each(function(_,input){var name=input.name,value=input.value;if(!name||_REGEXP_RELATED_FIELD_NAME_.test(name)){return}
if(name=='url'&&!dynamicValue){result[name]=value}
else if(input.type=='checkbox'){if(!input.checked){return}
if(self.relatedFields[name]){value=$ush.toString(''+self.relatedFields[name].val()).trim()}
result[name]=value}});result=$ush.toString(result);self.$input.val(result).trigger('change');self.trigger('change',[result])},getDefaultValue:function(){var self=this;if($ush.isUndefined(self._std)){return ''}
if(self.isLiveBuilder()){return $ush.toString(self._std)}
return self._std},getValue:function(){return this.$input.val()||''},setValue:function(value,quiet){var self=this,data=$ush.toPlainObject(value);self.$input.val(''+value);this.hideMenu();if(!$.isEmptyObject(data)){if(self.hasDynamicValues){self.removeDynamicValue()}
if(!isUndefined(data.url)){self.$inputUrl.val(data.url).trigger('change')}
else if(data.type){if(!isUndefined(data[data.type])){data.type+='|'+data[data.type]}
self.setDynamicValue(data.type)}
var setCheckboxes=!1;$.each(self.$checkboxes,function(_,checkbox){var name=checkbox.name,isChecked=!!data[name];$(checkbox).prop('checked',isChecked);setCheckboxes=setCheckboxes||isChecked});$('.action_toggle_menu',self.$row).toggleClass('has_values',setCheckboxes);$.each(self.relatedFields,function(name,$value){if(!isUndefined(data[name])){$value.val(data[name])}});self.updateValue()}
if(!quiet){self.trigger('change',[value])}},}}(jQuery);!function($,undefined){var _window=window,_document=document;if(_window.$usof===undefined){return}
$usof.field.reset={init:function(){this.$btnReset=this.$row.find('.usof-button.type_reset').on('click',this.reset.bind(this));this.resetStateTimer=null;this.i18n=(this.$row.find('.usof-form-row-control-i18n')[0].onclick()||{})},reset:function(){if(!confirm(this.i18n.reset_confirm)){return}
clearTimeout(this.resetStateTimer);this.$btnReset.addClass('loading');$.ajax({type:'POST',url:$usof.ajaxUrl,dataType:'json',data:{action:'usof_reset',_wpnonce:$usof.instance.$container.find('[name="_wpnonce"]').val(),_wp_http_referer:$usof.instance.$container.find('[name="_wp_http_referer"]').val()},success:function(result){this.$btnReset.removeClass('loading');alert(this.i18n.reset_complete);location.reload()}.bind(this)})}}}(jQuery);!function($,undefined){var _window=window,_document=document;if(_window.$usof===undefined){return}
$usof.field.icon={init:function(options){this.$value=this.$row.find('.us-icon-value');this.$select=this.$row.find('.us-icon-select');this.$text=this.$row.find('.us-icon-text');this.$preview=this.$row.find('.us-icon-preview > i');this.$setLink=this.$row.find('.us-icon-set-link');this.$select.on('change',function(){var $selectedOption=this.$select.find(":selected");if($selectedOption.length){this.$setLink.attr('href',$selectedOption.data('info-url'))}
this.setIconValue()}.bind(this));this.$text.on('change keyup',function(e){var val=this.$text.val();if(val.toLowerCase().replace(/^\s+/g,'')!==val){this.$text.val($.trim(val.toLowerCase()))}
this.setIconValue(e.type==='keyup')}.bind(this));this.$row.on('click','.usof-example',this.exampleClick.bind(this));this.$value.on('change',function(){this.trigger('change',this.getValue())}.bind(this))},exampleClick:function(e){var $target=$(e.target).closest('.usof-example'),example=$target.html();this.$text.val(example);this.setIconValue()},setIconValue:function(quiet){var icon_set=this.$select.val(),icon_name=$.trim(this.$text.val()),icon_val='';if(icon_name!=''){if(icon_set=='material'){icon_name=icon_name.replace(/ +/g,'_')}
icon_val=icon_set+'|'+icon_name}
this.renderPreview(icon_set,icon_name);this.$value.val(icon_val);if(!quiet){this.$value.trigger('change')}},renderValue:function(value){var $selectedOption;value=value.trim().split('|');if(value.length!=2){$selectedOption=this.$select.find('option:first');this.$text.val('')}else{value[0]=value[0].toLowerCase();$selectedOption=this.$select.find('option[value="'+value[0]+'"]');this.$text.val(value[1])}
if($selectedOption.length){this.$select.find('option').prop('selected',!1);$selectedOption.prop('selected','selected')}
this.renderPreview(value[0],value[1])},renderPreview:function(icon_set,icon_name){if(icon_name!=''){if(icon_set=='material'){this.$preview.attr('class','material-icons').html(icon_name)}else{if(icon_name!=undefined){icon_name=icon_name.replace(/fa-\dx/gi,' ')}
this.$preview.attr('class',icon_set+' fa-'+icon_name).html('')}}else{this.$preview.attr('class','material-icons').html('')}},setValue:function(value,quiet){this.renderValue(value);this.parentSetValue(value,quiet)}}}(jQuery);!function($,undefined){var _document=document,_window=window;var abs=Math.abs,max=Math.max,min=Math.min,round=Math.round;var isEmptyObject=$.isEmptyObject,isPlainObject=$.isPlainObject,isUndefined=$ush.isUndefined;if(isUndefined(_window.$usof)){return}
var oldCurrentValue;var _mouseEvents=['wheel','mousewheel','DOMMouseScroll'];var _dragData={};$usof.field.slider={init:function(options){var self=this;var _defaultRangeSettings={min:0,max:60,step:1};self._unitsSettings={};self.isFocused=!1;self.$window=$(_window);self.$body=$(_document.body);self.$usofContainer=$('.usof-container');self.$slider=$('.usof-slider',self.$row);self.$box=$('.usof-slider-box',self.$slider);self.$range=$('.usof-slider-range',self.$slider);self.$units=$('.usof-slider-selector-unit',self.$slider);self.$unitSelector=$('.usof-slider-selector input',self.$slider);if(self.$slider.is('[onclick]')){$.each(self.$slider[0].onclick()||{},function(unit,options){options=$.extend({},_defaultRangeSettings,options);self._unitsSettings[unit]=options});self.$slider.removeAttr('onclick')}
if(isEmptyObject(self._unitsSettings)){self._unitsSettings.px=$ush.clone(_defaultRangeSettings)}
self._events={setResponsiveScreen:$ush.debounce(self._setResponsiveScreen.bind(self),1),selectedUnit:self._selectedUnit.bind(self),blur:self._blur.bind(self),focus:self._focus.bind(self),keyup:self._keyup.bind(self),mouseenter:self._mouseenter.bind(self),mouseleave:self._mouseleave.bind(self),mousewheel:self._mousewheel.bind(self),dragmove:self._dragmove.bind(self),dragstart:self._dragstart.bind(self),dragstop:self._dragstop.bind(self),};self.$slider.on('mousedown','.usof-slider-box',self._events.dragstart).on('mousedown','.usof-slider-selector-unit',self._events.selectedUnit);self.$unitSelector.on('mouseenter',self._events.mouseenter).on('mouseleave',self._events.mouseleave).on('keyup',self._events.keyup).on('focus',self._events.focus).on('blur',self._events.blur);if(self.hasResponsive()){self.on('setResponsiveState',self._events.setResponsiveScreen)}},getUnitData:function(value){var self=this,unitsSettings=self._unitsSettings;value+='';var unit=(value.match(/^((-?\d+)(\.)?(\d+)?)([a-z\%]+)?$/)||[])[5]||'';if(isUndefined(unitsSettings[unit])){unit=$ush.toString(Object.keys(unitsSettings)[0])}
return{value:value.replace(/[^-?\d.]+/,'')||0,unit:unit}},roundValue:function(value){var decimalValue=parseFloat(value),decimalPart=$ush.toString((abs(value)%1).toFixed(3));if(decimalPart.charAt(3)!==''&&decimalPart.charAt(3)!=='0'){return decimalValue.toFixed(2)}
else if(decimalPart.charAt(2)!==''&&decimalPart.charAt(2)!=='0'){return decimalValue.toFixed(1)}
return decimalValue.toFixed(0)},renderValue:function(value){var self=this,unitData=self.getUnitData(value),unit=unitData.unit,value=unitData.value;self.$unitSelector.val(value+unit);self.$units.removeClass('active').filter('[data-unit="'+unit+'"]').addClass('active');var unitSettings=self._unitsSettings[unit],offset=max(0,min(1,(value-unitSettings.min)/(unitSettings.max-unitSettings.min)));self.$range.css(($ush.isRtl()?'right':'left'),offset*100+'%')},_setResponsiveScreen:function(e){var self=this;self.renderValue(self.getCurrentValue())},_dragstart:function(e){e.stopPropagation();var self=this,boxWidth=self.$box.width(),currentValue=self.getCurrentValue(),unit=self.getUnitData(currentValue).unit,boxOffsetLeft=self.$box.offset().left;if(self.$usofContainer.length==0){self.$usofContainer=$('.usof-container')}
self.$usofContainer.addClass('dragged');self.$box.addClass('dragged');_dragData={currentValue:currentValue,left:boxOffsetLeft,right:boxOffsetLeft+boxWidth,unit:unit,unitSettings:self._unitsSettings[unit]||{},width:boxWidth,};self.$body.on('mousemove',self._events.dragmove);self.$window.on('mouseup',self._events.dragstop);self._events.dragmove(e)},_dragmove:function(e){e.stopPropagation();var self=this,isEmptyDragData=isEmptyObject(_dragData),unitSettings=_dragData.unitSettings;var x,offset,value;if($ush.isRtl()){offset=isEmptyDragData?0:(_dragData.right-e.pageX)/_dragData.width}else{offset=isEmptyDragData?0:(e.pageX-_dragData.left)/_dragData.width}
x=max(0,min(1,offset));value=$ush.parseFloat(unitSettings.min+x*(unitSettings.max-unitSettings.min));value=round(value/unitSettings.step)*unitSettings.step;value=self.roundValue(value)+_dragData.unit;self.renderValue(value);self.setCurrentValue(value)},_dragstop:function(e){e.preventDefault();e.stopPropagation();var self=this;if(!self.$usofContainer.hasClass('dragged')){return}
self.$usofContainer.removeClass('dragged');self.$box.removeClass('dragged');self.$body.off('mousemove',self._events.dragmove);self.$window.off('mouseup',self._events.dragstop)},_mouseenter:function(e){var self=this;_mouseEvents.map(function(eventType){_window.addEventListener(eventType,self._events.mousewheel,{passive:!1})})},_mouseleave:function(e){var self=this;_mouseEvents.map(function(eventType){_window.removeEventListener(eventType,self._events.mousewheel)})},_mousewheel:function(e){var self=this;e.preventDefault?e.preventDefault():(e.returnValue=!1);e.stopPropagation();if(!self.isFocused){return!1}
var value=self.getCurrentValue(),floatValue=$ush.parseFloat(value),unit=self.getUnitData(value).unit,unitSettings=self._unitsSettings[unit];if((e.deltaY||e.detail||e.wheelDelta)<0){value=min(unitSettings.max,floatValue+unitSettings.step)}else{value=max(unitSettings.min,floatValue-unitSettings.step)}
value=round(value/unitSettings.step)*unitSettings.step;value=self.roundValue(value)+unit;self.renderValue(value);self.setCurrentValue(value)},_keyup:function(e){if($ush.toLowerCase(e.key)==='enter'){this.$unitSelector.trigger('blur')}},_focus:function(e){self=this;self.isFocused=!0;oldCurrentValue=self.getCurrentValue()},_blur:function(e){var self=this,value=$ush.toString(self.$unitSelector.val()),unitData=self.getUnitData(value),unitSettings=self._unitsSettings[unitData.unit];self.isFocused=!1;value=unitData.value;if(value===0){value=oldCurrentValue}
value+=''+unitData.unit;self.renderValue(value);self.setCurrentValue(value)},_selectedUnit:function(e){var self=this,$target=$(e.target),value=self.getUnitData(self.getCurrentValue()).value;value+=$ush.toString($target.data('unit'));self.$units.removeClass('active');$target.addClass('active');self.renderValue(value);self.setCurrentValue(value)},setValue:function(value,quiet){var self=this;if(!self.isResponsiveValue(value)){self.renderValue(value)}else{self.renderValue(self.getCurrentValue())}
self.parentSetValue(''+value)}}}(jQuery);!function($,undefined){var _window=window,_undefined=undefined;if(_window.$usof===_undefined){return}
$usof.field['switch']={init:function(){var self=this;self.$hidden=$('input.wpb_vc_param_value',self.$row);self.$input.on('change',function(e){var value=self.getValue();e.target.value=value;if(self.isVCParamValue()){self.$hidden.val(value).trigger('change')}
self.trigger('change',[value])})},isVCParamValue:function(){return!!this.$hidden.length},_toNumber:function(value){if($.isNumeric(value)){value=parseInt(value)}
return value?1:0},getValue:function(){var self=this;return self._toNumber(self.$input.is(':checked'))},setValue:function(value,quiet){var self=this;value=self._toNumber(value);self.$input.val(value).prop('checked',value);if(!quiet){self.trigger('change',[value])}}}}(jQuery);!function($,undefined){if($ush.isUndefined(window.$usof)){return}
$usof.field.text={init:function(){var self=this;self._dynamicLabels={};self.$text=$('input[type=text]',self.$row);self._events={blurField:self._blurField.bind(self),changeField:$ush.debounce(self._changeField.bind(self)),setExampleValue:self._setExampleValue.bind(self),syncCurrentValue:self._syncCurrentValue.bind(self),};self.initDynamicValue();self.$row.on('click','.usof-example',self._events.setExampleValue).on('change paste keyup','input[type=text]',self._events.changeField).on('blur','input[type=text]',self._events.blurField);if(self.hasResponsive()){self.on('setResponsiveState',self._events.syncCurrentValue)}},_setExampleValue:function(e){var self=this,exampleValue=($(e.target).closest('.usof-example').html()||'');self.$text.val(exampleValue);self.setCurrentValue(exampleValue)},_changeField:function(e){this.setCurrentValue(e.currentTarget.value)},_blurField:function(e){this.trigger('blur',this.getCurrentValue())},_syncCurrentValue:function(){var self=this;self.$text.val(self.getCurrentValue())},setValue:function(value,quiet){var self=this;self.parentSetValue(''+value);self._syncCurrentValue();if(self.popupId){self.setDynamicValue(value)}}};$.extend($usof.field.text,{initDynamicValue:function(){var self=this;$.extend(self._events,{selectDynamicVariable:self._selectDynamicValue.bind(self),removeDynamicValue:self._removeDynamicValue.bind(self),})
self.$valueSelected=$('.usof-form-input-dynamic-value',self.$row);self.popupId=$('[data-popup-show]:first',self.$row).data('popup-show');if(self.popupId){self.popup=new $usof.popup(self.popupId,{closeOnEsc:!0,closeOnBgClick:!0,init:function(){var $popupContainer=this.$container
this.$container.off('click').on('click','[data-dynamic-value]',self._events.selectDynamicVariable).find('[data-dynamic-value]').each(function(_,node){var $node=$(node);if($node.data('dynamic-label')){self._dynamicLabels[$node.data('dynamic-value')]=$node.data('dynamic-label');$node.removeAttr('data-dynamic-label')}})},beforeShow:function(){$('[data-dynamic-value]',this.$container).removeClass('active');var value=$ush.toString(self.$text.val());if(self.isDynamicVariable(value)){$('[data-dynamic-value="'+value+'"]',this.$container).addClass('active')}}});if($.isEmptyObject(self.popup)){console.error('Failed to initialize popup')}}
self.$row.on('click','.action_remove_dynamic_value',self._events.removeDynamicValue);if(self.isVCParamValue()){self.setValue(self.$input.val())}},_selectDynamicValue:function(e){e.preventDefault();var self=this;self.setDynamicValue($(e.target).data('dynamic-value'));if(self.popupId){$usof.hidePopup($ush.toString(self.popupId))}},setDynamicValue:function(value){var self=this;value=$ush.toString(value);if(!self.isDynamicVariable(value)||!self._dynamicLabels[value]){self.$valueSelected.addClass('hidden');self.$text.removeClass('hidden').focus()}else{var title=self._dynamicLabels[value]||value;self.$valueSelected.removeClass('hidden').find('.usof-form-input-dynamic-value-title').attr('title',title).text(title);self.$text.addClass('hidden')}
self.$text.val(value).trigger('change')},_removeDynamicValue:function(e){e.preventDefault();e.stopPropagation();this.setDynamicValue('')}});$usof.field.textarea={init:function(){var self=this;self.$row.on('click','.usof-example',self._setExampleValue.bind(self));self.$input.on('change paste keyup',$ush.debounce(function(){self.trigger('change',[self.getValue()])}))},_setExampleValue:function(e){this.setValue($(e.target).closest('.usof-example').html()||'')}}}(jQuery);!function($,undefined){var _window=window;if($ush.isUndefined(_window.$usof)){return}
$usof.field.hidden={init:function(){var self=this;self._events={setUniqueValue:self._setUniqueValue.bind(self),};var autoGenerateValueBySwitchOn=$ush.toString(self.$row.data('auto_generate_value_by_switch_on'));if(autoGenerateValueBySwitchOn){var usofField=self.getFieldByName(autoGenerateValueBySwitchOn);if(usofField instanceof $usof.field){usofField.on('change',self._events.setUniqueValue)}}},_setUniqueValue:function(_,switchValue){this.setCurrentValue(switchValue?$ush.uniqid():'')}}}(jQuery);!function($,undefined){var _window=window,_undefined=undefined;if(_window.$usof===_undefined){return}
$usof.field.editor={init:function(){var self=this;self.$container=$('.usof-editor',self.$row);$('script.usof-editor-template',self.$container).remove();self.hasUndoRedo=!1;self.originalEditorId=self.$input.data('editor-id')||'usof_editor';self.originalEditorSettings=_window.tinyMCEPreInit.mceInit[self.originalEditorId]||{};var $editorSettings=$('.usof-editor-settings',self.$row);self.editorSettings=$editorSettings.is('[onclick]')?$editorSettings[0].onclick()||{}:{};self.editorId=self.originalEditorId+$ush.uniqid();self.$input.attr('id',self.editorId);self._events={changeField:self._changeField.bind(self),changeTinymceContent:self._changeTinymceContent.bind(self)};self.$container.on((self.isLiveBuilder()?'input':'change'),'textarea',self._events.changeField);self.initEditor()},initEditor:function(){if(!_window.wp||!_window.wp.editor){return}
var self=this;_window.tinymce.on('AddEditor',function(e){var _editor=e.editor;if(_editor.id!==self.editorId){return}
var eventType='NodeChange '+(self.isLiveBuilder()?'input':'change');_editor.off(eventType).on(eventType,self._events.changeTinymceContent);if(self.isLiveBuilder()){_editor.on('keydown',self.trigger.bind(self,'tinyMCE.Keydown')).on('BeforeAddUndo',function(e){return!$ush.isUndefined(e.originalEvent)})}},!0);$ush.timeout(function(){var editorSettings={quicktags:!0,tinymce:self.editorSettings.tinymce||{},mediaButtons:(self.editorSettings.media_buttons!==_undefined)?self.editorSettings.media_buttons:!0},qtSettings={id:self.editorId,buttons:"strong,em,link,block,del,ins,img,ul,ol,li,code,more,close"},settingsFields=['content_css','toolbar1','toolbar2','toolbar3','toolbar4','theme','skin','language','formats','relative_urls','remove_script_host','convert_urls','browser_spellcheck','fix_list_elements','entities','entity_encoding','keep_styles','resize','menubar','branding','preview_styles','end_container_on_empty_block','wpeditimage_html5_captions','wp_lang_attr','wp_keep_scroll_position','wp_shortcut_labels','plugins','wpautop','indent','tabfocus_elements','textcolor_map','textcolor_rows',];settingsFields.forEach(function(setting,index){if(self.originalEditorSettings[setting]!==_undefined){editorSettings.tinymce[setting]=self.originalEditorSettings[setting]}});editorSettings.tinymce.setup=$.noop;_window.wp.editor.initialize(self.editorId,editorSettings);_window.quicktags(qtSettings);self.switchEditors('tinymce')},1)},switchEditors:function(mode){var self=this;mode=(''+mode).toLowerCase();$('#'+self.editorId+'-'+(mode==='tinymce'?'tmce':'html'),self.$container).trigger('click')},_changeField:function(e){this.trigger('change',e.currentTarget.value)},_changeTinymceContent:function(e){var self=this,mceValue=''+_window.tinymce.get(self.editorId).getContent(),currentValue=''+self.getValue();if(currentValue===mceValue){return}
self.$input.val(mceValue);self.trigger('change',mceValue)},setValue:function(value,quiet){var self=this;if(!!_window.tinyMCE&&!!_window.tinyMCE.get(self.editorId)){_window.tinyMCE.get(self.editorId).setContent(value)}else{self.$input.val(value)}
if(quiet){self.trigger('change',value)}},getValue:function(){return this.$input.val()||''}}}(jQuery);!function($,undefined){var _window=window,_document=document;if(_window.$usof===undefined){return}
$usof.field.transfer={init:function(){if($usof.instance.$sections.headerbuilder!==undefined){$usof.instance.fireFieldEvent($usof.instance.$sections.headerbuilder,'beforeShow');$usof.instance.fireFieldEvent($usof.instance.$sections.headerbuilder,'beforeHide')}
this.$textarea=this.$row.find('textarea');this.translations=(this.$row.find('.usof-transfer-translations')[0].onclick()||{});this.$btnImport=this.$row.find('.usof-button.type_import').on('click',this.importValues.bind(this));$extraOptions=$('.usof-transfer-extra-options',this.$row);if($extraOptions.is('[onclick]')){this.extraOptions=$extraOptions[0].onclick()||{};$extraOptions.remove()}else{this.extraOptions={}}
this.hiddenFieldsValues=$('.usof-hidden-fields')[0].onclick()||{};if(this.hiddenFieldsValues.length==0){this.hiddenFieldsValues={}}
this.exportValues();this.on('beforeShow',this.exportValues.bind(this))},exportValues:function(){var values=$.extend(this.hiddenFieldsValues,$usof.instance.getValues(),this.extraOptions);this.$textarea.val(JSON.stringify(values))},importValues:function(){var encoded=this.$textarea.val(),values;if(encoded.charAt(0)=='{'){this.$btnImport.addClass('loading');$.ajax({type:'POST',url:$usof.ajaxUrl,dataType:'json',data:{action:'usof_save',usof_options:encoded,_wpnonce:$usof.instance.$container.find('[name="_wpnonce"]').val(),_wp_http_referer:$usof.instance.$container.find('[name="_wp_http_referer"]').val()},success:function(result){this.$btnImport.removeClass('loading');if(result.success){alert(this.translations.importSuccess);location.reload()}else{alert(result.data.message)}}.bind(this)})}else{try{var serialized=_window.atob(encoded),matches=serialized.match(/(s\:[0-9]+\:\"(.*?)\"\;)|(i\:[0-9]+\;)/g),_key=null,_value;values={};for(var i=0;i<matches.length;i ++){_value=matches[i].replace((matches[i].charAt(0)=='s')?/^s\:[0-9]+\:\"(.*?)\"\;$/ : /^i\:([0-9]+)\;$/,'$1');if(_key===null){_key=_value}else{values[_key]=_value;_key=null}}
$usof.instance.setValues(values);this.valuesChanged=values;$usof.instance.save()}
catch(error){return alert(this.translations.importError)}}}}}(jQuery);!function($,undefined){var _window=window,_document=document;if(_window.$usof===undefined){return}
$usof.field.style_scheme={init:function(options){this.$input=this.$row.find('input[name="'+this.name+'"]');this.$schemesContainer=this.$row.find('.usof-schemes-list');this.$schemeItems=this.$row.find('.usof-schemes-list > li');this.$nameInput=this.$row.find('#scheme_name');this.$closeBtn=this.$row.find('.us-bld-window-closer');this.$saveNewBtn=this.$row.find('#save_new_scheme').on('click',this.saveScheme.bind(this));this.colors=(this.$row.find('.usof-form-row-control-colors-json')[0].onclick()||{});this.i18n=(this.$row.find('.usof-form-row-control-i18n')[0].onclick()||{});this.$nameInput.on('keyup',this.setSchemeButtonStates.bind(this));this.initSchemes(!0)},setSchemeButtonStates:function(action){if(!this.$schemesContainer){return}
if(this.$nameInput.val().length){this.$saveNewBtn.removeAttr('disabled');if(action.key=='Enter'){this.$saveNewBtn.click()}}else{this.$saveNewBtn.attr('disabled','')}},initSchemes:function(initialize,id){if(initialize){this.$row.hide();this.$closeBtn.on('click',function(){this.$row.hide()}.bind(this));$.ajax({type:'POST',url:$usof.ajaxUrl,dataType:'json',data:{action:'usof_get_style_schemes',_wpnonce:this.$row.closest('.usof-form').find('[name="_wpnonce"]').val(),_wp_http_referer:this.$row.closest('.usof-form').find('[name="_wp_http_referer"]').val()},success:function(result){this.schemes=result.data.schemes;this.customSchemes=result.data.custom_schemes}.bind(this),error:function(){this.schemes={};this.customSchemes={}}.bind(this),})}
if(id){var $savedScheme=this.$schemeItems.filter('.type_custom[data-id="'+id+'"]');$savedScheme.addClass('saved');setTimeout(function(){$savedScheme.removeClass('saved')},900)}
this.$schemeItems.each(function(index,item){var $item=$(item),$deleteBtn=$item.find('.usof-schemes-item-delete'),schemeId=$item.data('id'),isCustom=$item.hasClass('type_custom'),colors;$item.find('.usof-schemes-item-save').on('click',this.saveScheme.bind(this));$deleteBtn.on('click',function(event){event.preventDefault();event.stopPropagation();var $target=$(event.target),$deletingScheme=$target.closest('.usof-schemes-item'),schemeId=$deletingScheme.data('id');this.deleteScheme(schemeId,event)}.bind(this));$item.on('click',function(){if(_window.$usof!==undefined&&$usof.instance!==undefined){if((!isCustom&&this.schemes[schemeId]===undefined)||(isCustom&&this.customSchemes[schemeId]===undefined)||(!isCustom&&this.schemes[schemeId].values===undefined)||(isCustom&&this.customSchemes[schemeId].values===undefined)){return}
this.setSchemeButtonStates();if(isCustom){colors=this.customSchemes[schemeId].values;this.$input.val('custom-'+schemeId);this.trigger('change','custom-'+schemeId)}else{colors=this.schemes[schemeId].values;this.$input.val(schemeId);this.trigger('change',schemeId)}
$.each(colors,function(id,value){$usof.instance.setValue(id,value)})}
this.$row.hide()}.bind(this))}.bind(this))},getColorValues:function(){var colors={};if(_window.$usof===undefined||$usof.instance==undefined){return undefined}
if(this.colors==undefined){return undefined}
$.each(this.colors,function(id,color){colors[color]=$usof.instance.getValue(color)});return colors},saveScheme:function(event){var colors=this.getColorValues(),name=this.$nameInput.val(),scheme={name:name,colors:colors},$target=$(event.target),$savingScheme=$target.closest('.usof-schemes-item'),$button=$(event.target.closest('button'));if(!$button.length){if($savingScheme.hasClass('type_custom')){scheme.name=$savingScheme.find('.preview_heading').html();scheme.id=$savingScheme.data('id');$savingScheme.addClass('saving')}else{return!1}}else{this.$saveNewBtn.addClass('loading')}
$.ajax({type:'POST',url:$usof.ajaxUrl,dataType:'json',data:{action:'usof_save_style_scheme',scheme:JSON.stringify(scheme),_wpnonce:this.$row.closest('.usof-form').find('[name="_wpnonce"]').val(),_wp_http_referer:this.$row.closest('.usof-form').find('[name="_wp_http_referer"]').val()},success:function(result){this.setSchemes(result.data.schemes,result.data.customSchemes,result.data.schemesHtml,scheme.id);this.$nameInput.val('');this.$saveNewBtn.removeClass('loading').attr('disabled','')}.bind(this)});return!1},deleteScheme:function(schemeId,event){event.stopPropagation();if(!confirm(this.i18n.delete_confirm)){return!1}
var $target=$(event.target);$target.closest('.usof-schemes-item').addClass('deleting');$.ajax({type:'POST',url:$usof.ajaxUrl,dataType:'json',data:{action:'usof_delete_style_scheme',scheme:schemeId,_wpnonce:this.$row.closest('.usof-form').find('[name="_wpnonce"]').val(),_wp_http_referer:this.$row.closest('.usof-form').find('[name="_wp_http_referer"]').val()},success:function(result){this.setSchemes(result.data.schemes,result.data.customSchemes,result.data.schemesHtml)}.bind(this)});return!1},setSchemes:function(schemes,customSchemes,schemesHtml,id){this.schemes=schemes;this.customSchemes=customSchemes;this.$schemesContainer.html(schemesHtml);this.$schemeItems=this.$row.find('.usof-schemes-list > li');this.initSchemes(!1,id)}}}(jQuery);!function($,undefined){var _window=window,_document=document;var abs=Math.abs;if($ush.isUndefined(_window.$usof)){return}
const _PREVIEW_TYPE_={DYNAMIC_VALUE:'dynamic_value',IMAGE:'image',TEXT:'text',};$usof.field.upload={init:function(options){var self=this;self.parentInit(options);self.$container=$('.usof-upload',self.$row);self.$preview=$('.usof-upload-preview',self.$row);self._dynamicLabels={};self.hasDynamicValues=$('.usof-popup',self.$row).length;self.i18n={};self.isMultiple=self.$container.hasClass('is_multiple');self.placeholder=$('input[name="placeholder"]',self.$row).val();self.popup={};self._previewType=self.$container.data('preview-type');self.$container.removeAttr('data-preview-type');var $i18n=$('.usof-upload-i18n',self.$row);if($i18n.length){self.i18n=$i18n[0].onclick()||{};$i18n.remove()}
self._events={removeItem:self._removeItem.bind(self),selectedInMediaLibrary:self._selectedInMediaLibrary.bind(self),showMediaLibrary:self._showMediaLibrary.bind(self),showSelectedInMediaLibrary:self._showSelectedInMediaLibrary.bind(self),showSelectionWindow:self._showSelectionWindow.bind(self),};self.$row.on('click','.ui-icon_close',self._events.removeItem).on('click','.ui-icon_add',self._events.showMediaLibrary);if(!self.isMultiple){self.$row.on('click','.usof-upload-preview-file',self._events.showSelectionWindow)}
if(self.isMultiple&&self.getPreviewType()===_PREVIEW_TYPE_.IMAGE){self.$body=$(_document.body);self.$window=$(_window);self.$dragShadow=$('<div class="usof-dragshadow"></div>');$.extend(self._events,{dragEnd:self._dragEnd.bind(self),dragMove:self._dragMove.bind(self),dragStart:self._dragStart.bind(self),maybeDragMove:self._maybeDragMove.bind(self),});self.$row.on('mousedown','.usof-upload-preview-file',self._events.dragStart).on('dragstart',function(e){e.preventDefault()})}
if(self.hasDynamicValues){self.$variables=$('.usof-upload-variables',self.$row);self.$dynamicValue=$('.usof-upload-dynamic-value',self.$row);self._events.selectDynamicValue=self._selectDynamicValue.bind(self);self.$preview.on('click','.usof-upload-preview-file',function(e){if(self.getPreviewType()===_PREVIEW_TYPE_.DYNAMIC_VALUE){self._showSelectionWindow(e)}});self.popupId=$ush.uniqid();$('[data-popup-id]',self.$row).attr('data-popup-id',self.popupId);$('[data-popup-show]',self.$row).attr('data-popup-show',self.popupId);self.popup=new $usof.popup(self.popupId,{closeOnEsc:!0,closeOnBgClick:!0,init:function(){this.$container.off('click').on('click','[data-dynamic-value]',self._events.selectDynamicValue).find('[data-dynamic-value]').each(function(_,node){var $node=$(node);if($node.data('dynamic-label')){self._dynamicLabels[$node.data('dynamic-value')]=$node.data('dynamic-label');$node.removeAttr('data-dynamic-label')}})},beforeShow:function(){var that=this;$('[data-dynamic-value]',that.$container).removeClass('active');$ush.toString(self.getValue()).split(',').map(function(value){$('[data-dynamic-value="'+value+'"]',that.$container).addClass('active')})}});if($.isEmptyObject(self.popup)){console.error('Failed to initialize popup')}}},_hasClass:function(node,className){return $ush.isNode(node)&&(' '+node.className+' ').indexOf(' '+className+' ')>-1},getPreviewType:function(){return this.$container.usMod('preview')},setPreviewType:function(type){this.$container.usMod('preview',$ush.toString(type))},_showSelectionWindow:function(e){var self=this;if(self._hasClass(e.target,'ui-icon_close')){return}
if(self.getPreviewType()===_PREVIEW_TYPE_.DYNAMIC_VALUE){$('button.for_select_dynamic_value',self.$row).trigger('click')}else{self._showMediaLibrary(e)}},_showMediaLibrary:function(e){var self=this,mediaInstance=self.mediaInstance;if(self._hasClass(e.target,'ui-icon_close')){return}
if($ush.isUndefined(mediaInstance)){var mediaSettings={multiple:self.isMultiple?'add':!1,};if(self.getPreviewType()===_PREVIEW_TYPE_.IMAGE){mediaSettings.library={type:'image'}}
mediaInstance=wp.media(mediaSettings);mediaInstance.on('open',self._events.showSelectedInMediaLibrary);mediaInstance.on('select',self._events.selectedInMediaLibrary);self.mediaInstance=mediaInstance}
mediaInstance.open()},_showSelectedInMediaLibrary:function(){var self=this,mediaInstance=self.mediaInstance;mediaInstance.state().get('selection').reset();$ush.toString(self.getValue()).split(',').map(function(attachmentId,i){if(!self.isMultiple&&i>0){return}
mediaInstance.state().get('selection').add(wp.media.attachment($ush.parseInt(attachmentId)))})},_selectedInMediaLibrary:function(){var self=this,mediaInstance=self.mediaInstance,value=[];if(self.isMultiple){mediaInstance.state().get('selection').each(function(attachment){if(attachment.attributes.url){value.push(attachment.id)}})}else{var attachment=mediaInstance.state().get('selection').first();if(attachment.attributes.url){value=[attachment.id]}}
self.setValue(value.toString())},_removeItem:function(e){var self=this;$previewFile=$(e.target).closest('.usof-upload-preview-file'),removeValue=$ush.toString($previewFile.data('value'));if(removeValue){var value=$ush.parseInt(removeValue)!==-1?$ush.toString(self.getValue()):'';if(value){value=value.split(',').filter(function(value){return value!==removeValue}).toString()}
if(value){self.parentSetValue(value)}else{self.setValue('')}
$previewFile.remove()}},_selectDynamicValue:function(e){e.preventDefault();var self=this;self.setPreviewType(_PREVIEW_TYPE_.DYNAMIC_VALUE);self.setValue($ush.toString(e.target.dataset.dynamicValue));if(self.popupId){$usof.hidePopup($ush.toString(self.popupId))}},renderPreview:function(text,value,removeButton,index){var self=this,previewType=self.getPreviewType(),newPreview='';text=$ush.toString(text);if(!text){return}
if(previewType===_PREVIEW_TYPE_.DYNAMIC_VALUE){newPreview='<span>'+$ush.toString(self._dynamicLabels[value])+'</span>'}else if(previewType===_PREVIEW_TYPE_.IMAGE){if(text!==':placeholder'){newPreview='<img src="'+text+'" alt="">'}}else{if(text===':placeholder'){text='...'}
newPreview='<span>'+text.substring(text.lastIndexOf('/')+1)+'</span>'}
if(removeButton){newPreview+='<div class="ui-icon_close" title="'+self.i18n.delete+'">'}
newPreview='<div class="usof-upload-preview-file" data-value="'+$ush.toString(value)+'">'+newPreview+'</div>';$('[data-value="'+value+'"]',self.$preview).remove();var previews=$('> *',self.$preview).toArray();previews.splice($ush.parseInt(index),0,newPreview);self.$preview.append(previews);self.$preview.toggleClass('hidden',!previews.length)},setValue:function(value,quiet){var self=this;value=$ush.toString(value);self.parentSetValue(value,quiet);if(!quiet){self.trigger('change',[value])}
self.$preview.addClass('hidden').html('');if(value===''){self.setPreviewType(self._previewType);if(self.placeholder){self.renderPreview(self.placeholder)}
return}
if(value.indexOf('{{')>-1){self.setPreviewType(_PREVIEW_TYPE_.DYNAMIC_VALUE)}
function addAttachment(attachment,index){var url=attachment.attributes.url;if(!$ush.isUndefined(attachment.attributes.sizes)){var size=self.isMultiple?'thumbnail':'medium';if($ush.isUndefined(attachment.attributes.sizes[size])){size='full'}
url=attachment.attributes.sizes[size].url}
self.renderPreview(url,attachment.id,!0,index)}
if(self.isDynamicVariable(value)){self.renderPreview(value,value,!0)}else if(/\.(gif|jpe?g|tiff?|png|webp|bmp)$/i.test(value)){self.renderPreview(value,-1,!0)}else{var queryArgs={include:value.split(',').map($ush.parseInt).filter($ush.parseInt),posts_per_page:-1,};queryArgs.include.map(function(attachmentId,index){self.renderPreview(':placeholder',attachmentId,!1,index)});wp.media.query(queryArgs).more().then(function(){queryArgs.include.map(function(value,index){var attachment=wp.media.attachment($ush.parseInt(value));if(!$ush.isUndefined(attachment.attributes.url)){addAttachment(attachment,index)}else{attachment.fetch({success:addAttachment.bind(null,attachment,index)})}})})}}};$.extend($usof.field.upload,{_isInBlindSpot:function(e){return(abs(e.pageX-this.blindSpot[0])<=20&&abs(e.pageY-this.blindSpot[1])<=20)},_dragStart:function(e){var self=this;if(self._hasClass(e.target,'ui-icon_close')){return}
e.stopPropagation();self.$draggedElm=$(e.target).closest('.usof-upload-preview-file');self.detached=!1;self.blindSpot=[e.pageX,e.pageY].map($ush.parseInt);self.elmPointerOffset=[e.pageX,e.pageY].map($ush.parseInt);self.$body.on('mousemove',self._events.maybeDragMove);self.$window.on('mouseup',self._events.dragEnd)},_maybeDragMove:function(e){var self=this;e.stopPropagation();if(self._isInBlindSpot(e)){return}
self.$body.off('mousemove',self._events.maybeDragMove);self._detach();self.$body.on('mousemove',self._events.dragMove)},_detach:function(e){var self=this,$draggedElm=self.$draggedElm,offset=$draggedElm.offset();self.elmPointerOffset[0]-=offset.left;self.elmPointerOffset[1]-=offset.top;self.$dragShadow.css({width:$draggedElm.outerWidth(),height:$draggedElm.outerHeight()}).insertBefore($draggedElm);$draggedElm.css({position:'absolute','pointer-events':'none',zIndex:10000,width:$draggedElm.width(),height:$draggedElm.height()}).css(offset).appendTo(self.$body);self.detached=!0},_dragMove:function(e){var self=this;e.stopPropagation();self.$draggedElm.css({left:e.pageX-self.elmPointerOffset[0],top:e.pageY-self.elmPointerOffset[1]});if(self._isInBlindSpot(e)){return}
var node=e.target;for(var level=0;level<=2;level ++,node=node.parentNode){if(self._hasClass(node,'usof-dragshadow')){return}
if(self._hasClass(node,'usof-upload-preview-file')){var nextNode=node.previousSibling,shadowAtLeft=!1;while(nextNode){if(nextNode==this.$dragShadow[0]){shadowAtLeft=!0;break}
nextNode=nextNode.previousSibling}
self.$dragShadow[shadowAtLeft?'insertAfter':'insertBefore'](node);self.blindSpot=[e.pageX,e.pageY].map($ush.parseInt);break}}},_dragEnd:function(e){var self=this;self.$window.off('mouseup',self._events.dragEnd);self.$body.off('mousemove',self._events.maybeDragMove).off('mousemove',self._events.dragMove);if(!self.detached){return}
self.$draggedElm.removeAttr('style').insertBefore(self.$dragShadow);self.$dragShadow.detach();var values=[];$('.usof-upload-preview-file',self.$preview).each(function(_,node){var value=$ush.toString(node.dataset.value);if(value){values.push(value)}});if(values.length){self.parentSetValue(values.toString())}else{self.setValue('')}}})}(jQuery);!function($,undefined){var _window=window,_document=document,_undefined=undefined;_window.$ush=_window.$ush||{};if($ush.isUndefined(_window.$usof)){return}
$usof.field.design_options={init:function(){var self=this;self._lastSelectedScreen='default';self.defaultGroupValues={};self.defaultValues={};self.groupParams={};self.$container=$('.usof-design-options',self.$row);self.$input=$('textarea.usof_design_value',self.$container);self.$import=$('.usof-design-options-import',self.$container);self.$btnCopyToClipboard=$('button.copy_to_clipboard',self.$import);self.$errorMessage=$('.usof-design-options-import-novalid',self.$import);self.states=$ush.toArray(self.$container[0].onclick()||['default']);self.screensList=self.states.slice(1);self.$container.removeAttr('onclick');self.hasStringValue=(self.isLiveBuilder()||self.isVCParamValue());if(self.isVCParamValue()){self.$container.closest('.edit_form_line').addClass('usof-not-live')}
self._events={changeValue:$ush.debounce(self._changeValue.bind(self),1),copyValueToClipboard:self._copyValueToClipboard.bind(self),pasteValueFromClipboard:self._pasteValueFromClipboard.bind(self),resetValues:self._resetValues.bind(self),selectResponsiveState:self._selectResponsiveState.bind(self),toggleAccordion:self._toggleAccordion.bind(self),toggleResponsive:self._toggleResponsive.bind(self),};self.__checkChangeValues=$ush.debounce(self.checkChangeValues.bind(self),1);if(self.screensList.length){$('[data-responsive-state-content="default"]',self.$container).each(function(_,content){var $content=$(content);self.screensList.map(function(screen){var $cloneContent=$content.clone().attr('data-responsive-state-content',screen).addClass('hidden');$content.after($cloneContent)})})}
self.states.map(function(screen){self.groupParams[screen]=new $usof.GroupParams($('[data-responsive-state-content="'+screen+'"]',self.$container))});$.each(self.groupParams,function(screen,groupParams){$.each(groupParams.fields,function(fieldName,field){var $group=field.$row.closest('[data-accordion-content]'),value=field.getValue();if($group.length){var groupKey=$group.data('accordion-content');if(!self.defaultGroupValues.hasOwnProperty(groupKey)){self.defaultGroupValues[groupKey]={}}
if(!self.defaultGroupValues[groupKey].hasOwnProperty(screen)){self.defaultGroupValues[groupKey][screen]={}}
self.defaultGroupValues[groupKey][screen][fieldName]=value;if(!self.defaultValues.hasOwnProperty(screen)){self.defaultValues[screen]={}}
self.defaultValues[screen][fieldName]=value;$group.data('responsive-state',screen)
field.screen=screen}});$.each(groupParams.fields,function(_,field){var $row=field.$row;if($row.attr('onclick')){field._data=$row[0].onclick()||'';$row.removeAttr('onclick');if(field._data.hasOwnProperty('relations')){$row.append('<i class="fas fa-unlink"></i>').on('click','i.fas',self._switchDuplicateValue.bind(self,field))}}
field.trigger('beforeShow').on('change',self._events.changeValue)})});var pid=$ush.timeout(function(){if(!self.inited){self.setValue(self.$input.val());self.checkChangeValues()}
self.$btnCopyToClipboard.prop('disabled',!self.getValue());$ush.clearTimeout(pid)},1);$('.usof-responsive-buttons',self.$container).toggleClass('hidden',!self.screensList.length);self.$container.on('click','[data-accordion-id]',self._events.toggleAccordion).on('click','.usof-design-options-reset',self._events.resetValues).on('click','.usof-design-options-responsive',self._events.toggleResponsive).on('click','[data-responsive-state]',self._events.selectResponsiveState).on('click','button.copy_to_clipboard',self._events.copyValueToClipboard).on('click','button.paste_from_clipboard',self._events.pasteValueFromClipboard)},_copyValueToClipboard:function(){var self=this,value=self.$input.val();if(value){$ush.copyTextToClipboard(value);$ush.storage('usof').set('design_options',value)}},_pasteValueFromClipboard:function(){var self=this,isValid=!1,value=$ush.toString($ush.storage('usof').get('design_options')).trim();if(!value){return}
try{value=$ush.toPlainObject(value);for(var i in self.states){var state=self.states[i];if(state&&value[state]){isValid=!0;break}}}catch(err){}
if(isValid){$.each(self.groupParams,function(screen,groupParams){groupParams.setValues(self.defaultValues[screen]||{},!0)});self.setValue(value)}
self.$errorMessage.toggleClass('hidden',isValid)},_switchDuplicateValue:function(field,e,state){var self=this,$target=$(e.currentTarget),isUnlink=$target.hasClass('fa-unlink'),relations=[];if(!$ush.isUndefined(state)){isUnlink=state}
if(field.hasOwnProperty('_data')&&field.hasOwnProperty('screen')){$.each(self.groupParams[field.screen].fields,function(_name,item){if($.inArray(item.name,field._data.relations||[])!==-1){relations.push(item)}})}
$target.toggleClass('fa-link',isUnlink).toggleClass('fa-unlink',!isUnlink);if(relations.length){relations.map(function(item){item.$input.prop('disabled',isUnlink)});field.watchValue=isUnlink;if(isUnlink){field.$input.focus().on('input',self._changeRelationsValue.bind(self,relations)).trigger('input')}else{field.$input.off('input')}}},_changeRelationsValue:function(fields,e){var value=e.currentTarget.value;fields.map(function(usofField){if(usofField instanceof $usof.field){usofField.setValue(value)}})},_changeValue:function(usofField){var self=this,result={},enabledResponsives=[],valuesChanged={};$('[data-accordion-id].responsive',self.$container).each(function(_,node){var accordionId=$(node).data('accordionId'),props=self.defaultGroupValues[accordionId].default||{};for(var k in props){enabledResponsives.push(k);valuesChanged[k]=[];$.each(self.groupParams,function(_,groupParams){valuesChanged[k].push(groupParams.getValue(k))})}});$.each(self.groupParams,function(screen,groupParams){$.each(groupParams.getValues(),function(param,value){var defaultValue=self.defaultValues[screen][param],isValueChanged=!1;if(enabledResponsives.indexOf(param)>-1){for(var i in valuesChanged[param]){isValueChanged=valuesChanged[param][i]!==defaultValue;if(isValueChanged){break}}}
if(isValueChanged||value!==defaultValue){if(!$.isPlainObject(result[screen])){result[screen]={}}
if(param==='background-image'&&/http/.test(value)){value='url('+value+')'}
result[screen][param]=value}})});result=$ush.toString(result);if(result==='%7B%7D'){result=''}
self.$input.val(result);if(!self._lastResult||self._lastResult!==result){self._lastResult=result;self.trigger('change',result)}
self.__checkChangeValues();self.$btnCopyToClipboard.prop('disabled',!result);self.trigger('changeDesignField',usofField)},_resetValues:function(e){e.stopPropagation();var self=this,$target=$(e.currentTarget),$groupHeader=$target.closest('[data-accordion-id]'),groupName=$groupHeader.data('accordion-id');if($groupHeader.hasClass('responsive')){self._events.toggleResponsive(e)}
if(self.defaultGroupValues.hasOwnProperty(groupName)){$.each(self.defaultGroupValues[groupName],function(screen,defaultValues){var groupParams=self.groupParams[screen];groupParams.setValues($.extend(groupParams.getValues(),defaultValues));$.each(defaultValues,function(groupParams,name){var fields=groupParams.fields;if(fields.hasOwnProperty(name)&&fields[name].hasOwnProperty('_data')&&fields[name]._data.hasOwnProperty('relations')){var $link=$('i.fas',groupParams.$fields[name]);if($link.length&&$link.hasClass('fa-link')){$link.trigger('click')}}}.bind(self,groupParams))})}
var pid=$ush.timeout(function(){$groupHeader.removeClass('changed');$ush.clearTimeout(pid)},1000*0.5)},_toggleAccordion:function(e){var $target=$(e.currentTarget),$content=$('[data-accordion-content="'+$target.data('accordion-id')+'"]');if($target.hasClass('active')){$target.removeClass('active');$content.removeClass('active')}else{$target.siblings().removeClass('active');$content.siblings().removeClass('active');$target.addClass('active');$content.addClass('active')}},_toggleResponsive:function(e){e.preventDefault();e.stopPropagation();var self=this,$target=$(e.currentTarget),$header=$target.closest('[data-accordion-id]'),groupKey=$header.data('accordion-id'),isEnabled=$header.hasClass('responsive'),isFirstResponsive=!isEnabled?!$('.usof-design-options-header.responsive:first',self.$container).length:!1;$header.toggleClass('responsive',!isEnabled);if(!isEnabled){if(isFirstResponsive){self.trigger('syncResponsiveState',self._lastSelectedScreen)}
self.switchResponsiveState(self._lastSelectedScreen)}else{self.switchResponsiveState('default',!0)}
if(self.defaultGroupValues.hasOwnProperty(groupKey)){self.screensList.map(function(screen){var values=$.extend({},self.defaultGroupValues[groupKey][screen]||{});if(!isEnabled){$.each(values,function(prop){if(self.groupParams['default'].fields.hasOwnProperty(prop)){values[prop]=self.groupParams['default'].fields[prop].getValue()}})}
if(self.groupParams.hasOwnProperty(screen)&&self.groupParams[screen]instanceof $usof.GroupParams){values=$.extend(self.groupParams[screen].getValues(),values);self.groupParams[screen].setValues(values,!0)}
if(!isEnabled&&self.groupParams.hasOwnProperty(screen)){$.each(self.groupParams['default'].fields,function(_,field){if(field.hasOwnProperty('watchValue')){$('.fas',self.groupParams[screen].fields[field.name].$row).trigger('click',field.watchValue)}})}})}},_selectResponsiveState:function(e){var self=this,screen=$(e.currentTarget).data('responsive-state');self.switchResponsiveState(screen);self.trigger('syncResponsiveState',screen);self._lastSelectedScreen=screen},_usbSyncResponsiveState:function(_,screen){var self=this;self._lastSelectedScreen=screen||'default';self.switchResponsiveState(self._lastSelectedScreen)},switchResponsiveState:function(screen,hidden){var self=this;if(!screen){return}
var hasResponsiveClass=!hidden?'.responsive':':not(.responsive)'
var $target=$('[data-accordion-id]'+hasResponsiveClass,self.$container).next('[data-accordion-content]').find('[data-responsive-state="'+screen+'"]');$target.siblings().removeClass('active');$target.addClass('active').closest('.usof-design-options-content').find('> [data-responsive-state-content]').addClass('hidden').filter('[data-responsive-state-content="'+screen+'"]').removeClass('hidden')},checkChangeValues:function(){var self=this,currentGroupValues={};$.each(self.groupParams,function(screen,groupParams){$.each(groupParams.fields,function(_,field){var groupName=field.$row.closest('[data-accordion-content]').data('accordion-content');if(!currentGroupValues.hasOwnProperty(groupName)){currentGroupValues[groupName]={}}
if(!currentGroupValues[groupName].hasOwnProperty(screen)){currentGroupValues[groupName][screen]={}}
currentGroupValues[groupName][screen][field.name]=field.getValue()})});$.each(self.defaultGroupValues,function(groupName,screensList){var change=!1;$.each(screensList,function(screen,values){if(!currentGroupValues.hasOwnProperty(groupName)||!currentGroupValues[groupName].hasOwnProperty(screen)){return}
change=(change||JSON.stringify(values)!==JSON.stringify(currentGroupValues[groupName][screen]))});$('[data-accordion-id='+groupName+']',self.$container).toggleClass('changed',change)})},getValue:function(){var self=this,value=$.trim(self.$input.val());if(!self.hasStringValue&&value&&typeof value==='string'){value=$ush.toPlainObject(value)}
return value},setValue:function(value,quiet){var self=this;var savedValues={};if(typeof value==='string'){savedValues=$ush.toPlainObject(value)}else if($.isPlainObject(value)){savedValues=value}
var pid=$ush.timeout(function(){$.each(self.groupParams,function(screen,groupParams){if(!self.hasStringValue){groupParams.setValues(self.defaultValues[screen]||{},!0)}
var values=savedValues[screen]||{};propName='background-image';if(values.hasOwnProperty(propName)&&/url\(/.test(values[propName]||'')){values[propName]=values[propName].replace(/\s?url\("?(.*?)"?\)/gi,'$1')}
for(var k in values){if(!/border-(\w+)-style/.test(k)){continue}
values['border-style']=values[k];delete values[k]}
groupParams.setValues(values,!0);$.each(groupParams.fields,function(_,field){if(field.hasOwnProperty('_data')&&field._data.hasOwnProperty('relations')){var $row=field.$row,value=$.trim(field.getValue()),isLink=[];(field._data.relations||[]).map(function(name){if(value&&self.groupParams[field.screen].fields.hasOwnProperty(name)){isLink.push(value===$.trim(self.groupParams[field.screen].fields[name].getValue()))}});if(isLink.length){isLink=isLink.filter(function(v){return v==!0});if(isLink.length===3){var pid=$ush.timeout(function(){$('i.fas',$row).trigger('click');$ush.clearTimeout(pid)},1)}}}})});var responsiveGroups={};self.screensList.map(function(screen){var values=savedValues[screen]||{};$.each(self.defaultGroupValues,function(groupKey,screensList){var isEnabled=!1;$.each(screensList[screen],function(prop){if(!responsiveGroups[groupKey]){responsiveGroups[groupKey]=values.hasOwnProperty(prop)}})})});$.each(responsiveGroups,function(groupKey,isEnabled){$('[data-accordion-id="'+groupKey+'"]',self.$container).toggleClass('responsive',isEnabled)});self.checkChangeValues();self.switchResponsiveState('default',!0)},1);if(value){value=self.hasStringValue?value:$ush.toString(value)}
self.$input.val($ush.toString(value));if(!quiet){self.trigger('change',[value])}
if(!self.isVCParamValue()){$('> div',self.$container).removeClass('active')}},forceWPBValue:function(){var self=this;if(self.hasStringValue){self.setValue(self.getValue())}}}}(jQuery);!function($,undefined){var _window=window,_document=document;if(_window.$usof===undefined){return}
$usof.field.used_icons_info={init:function(){this.loaded=!1;this.$container=$('.usof-icons-info:first',this.$row);this.$button=$('.usof-button.type_show_used_icons',this.$container);this.$content=$('.usof-form-wrapper.for_used_icons',this.$container);this.$button.on('click',this._events.showIcons.bind(this))},_events:{showIcons:function(e){e.preventDefault();if(this.loaded){return}
this.$button.addClass('loading');this._request.call(this,'request')}},_request:function(type){this.loaded=!0;this.$content.addClass('hidden').html('');var data={type:type,action:'usof_used_icons_info',_nonce:this.$container.data('nonce')||''};$.post(ajaxurl,data,function(res){if(res.data.processing){this._request.call(this,'iteration')}else{this.$button.removeClass('loading');this.loaded=!1;if(!res.success){this._showMessage.call(this,res.data.message);return}
this.$content.toggleClass('hidden',!res.data.result).html(res.data.result)}}.bind(this))}}}(jQuery);!function($){var _window=window,_document=document;if(_window.$usof===undefined){return}
$usof.ButtonPreview=function(container){this.init(container)};$usof.ButtonPreview.prototype={init:function(container){this.$container=$(container);this.$btn=this.$container.find('.usof-btn');this.$groupParams=this.$container.closest('.usof-form-group-item');this.$style=$('style:first',this.$groupParams);this.groupParams=this.$groupParams.data('usofGroupParams');this.dependsOn=['h1_font_family','h2_font_family','h3_font_family','h4_font_family','h5_font_family','h6_font_family','body_font_family',];for(var fieldId in $usof.instance.fields){if(!$usof.instance.fields.hasOwnProperty(fieldId)){continue}
if($.inArray($usof.instance.fields[fieldId].name,this.dependsOn)===-1){continue}
$usof.instance.fields[fieldId].on('change',this.applyStyle.bind(this));}
for(var fieldId in this.groupParams.fields){if(!this.groupParams.fields.hasOwnProperty(fieldId)){continue}
this.groupParams.fields[fieldId].on('change',this.applyStyle.bind(this))}
this.applyStyle();},_getColorValue:function(name){if(this.groupParams instanceof $usof.GroupParams&&this.groupParams.fields[name]!==undefined&&this.groupParams.fields[name].type==='color'&&this.groupParams.fields[name].hasOwnProperty('getColorValue')){return this.groupParams.fields[name].getColorValue()}
return ''},applyStyle:function(){var self=this,classRandomPart=$ush.uniqid(),className='.usof-btn_'+classRandomPart,style={default:'',hover:'',};self.$btn.usMod('usof-btn',classRandomPart);var buttonFont=self.groupParams.getValue('font'),typographyOptions=$usof.getData('typographyOptions')||{},fontFamily;if($.inArray(buttonFont,Object.keys(typographyOptions))!==-1){fontFamily=(typographyOptions[buttonFont]||{})['font-family']||((typographyOptions[buttonFont]||{}).default||{})['font-family']||''}else{fontFamily=buttonFont}
if(fontFamily!=='none'&&fontFamily!==''&&fontFamily!=='null'){style.default+='font-family: '+fontFamily+'!important;'}
if(self.groupParams.getValue('text_style').indexOf('italic')!==-1){style.default+='font-style: italic !important;'}else{style.default+='font-style: normal !important;'}
if(self.groupParams.getValue('text_style').indexOf('uppercase')!==-1){style.default+='text-transform: uppercase !important;'}else{style.default+='text-transform: none !important;'}
style.default+='font-size: min('+self.groupParams.getValue('font_size')+', 50px) !important;';style.default+='line-height:'+self.groupParams.getValue('line_height')+' !important;';style.default+='font-weight:'+self.groupParams.getValue('font_weight')+' !important;';style.default+='padding:'+self.groupParams.getValue('height')+' '+self.groupParams.getValue('width')+' !important;';style.default+='border-radius:'+self.groupParams.getValue('border_radius')+' !important;';style.default+='letter-spacing:'+self.groupParams.getValue('letter_spacing')+' !important;';var colorBg=self._getColorValue('color_bg'),colorBorder=self._getColorValue('color_border'),colorBgHover=self._getColorValue('color_bg_hover'),colorBorderHover=self._getColorValue('color_border_hover'),color;if(colorBg==''){colorBg='transparent'}
if(colorBorder==''){colorBorder='transparent'}
if(colorBgHover==''){colorBgHover='transparent'}
if(colorBorderHover==''){colorBorderHover='transparent'}
style.default+='background:'+colorBg+' !important;';if(colorBorder.indexOf('gradient')!==-1){style.default+='border-image:'+colorBorder+' 1 !important;'}else{style.default+='border-color:'+colorBorder+' !important;'}
if(self._getColorValue('color_text').indexOf('gradient')!==-1){color=usofColorPicker.gradientParser(self._getColorValue('color_text')).hex;style.default+='color:'+color+' !important;'}else{self.$btn.css('color',self._getColorValue('color_text'))}
if(self._getColorValue('color_shadow')!=''){style.default+='box-shadow:'+self.groupParams.getValue('shadow_offset_h')+' '+self.groupParams.getValue('shadow_offset_v')+' '+self.groupParams.getValue('shadow_blur')+' '+self.groupParams.getValue('shadow_spread')+' '+self._getColorValue('color_shadow')+' ';if($.inArray('1',self.groupParams.getValue('shadow_inset'))!==-1){style.default+='inset'}
style.default+='!important;'}
self.$container.usMod('hov',self.groupParams.getValue('hover'));if(self.groupParams.getValue('hover')=='fade'){style.hover+='background:'+colorBgHover+' !important;'}else if(colorBgHover=='transparent'){style.hover+='background:'+colorBgHover+' !important;'}
if(self._getColorValue('color_shadow_hover')!=''){style.hover+='box-shadow:'+self.groupParams.getValue('shadow_hover_offset_h')+' '+self.groupParams.getValue('shadow_hover_offset_v')+' '+self.groupParams.getValue('shadow_hover_blur')+' '+self.groupParams.getValue('shadow_hover_spread')+' '+self._getColorValue('color_shadow_hover')+' ';if($.inArray('1',self.groupParams.getValue('shadow_hover_inset'))!==-1){style.hover+='inset'}
style.hover+='!important;'}
if(colorBorderHover.indexOf('gradient')!==-1){style.hover+='border-image:'+colorBorderHover+' 1 !important;'}else{style.hover+='border-color:'+colorBorderHover+' !important;'}
var colorHover;if(self._getColorValue('color_text_hover').indexOf('gradient')!==-1){colorHover=(usofColorPicker.gradientParser(self._getColorValue('color_text_hover'))).hex}else{colorHover=self._getColorValue('color_text_hover')}
style.hover+='color:'+colorHover+' !important;';var compiledStyle=className+'{%s}'.replace('%s',style.default);compiledStyle+=className+':before {border-width:'+self.groupParams.getValue('border_width')+' !important;}';compiledStyle+=className+':hover{%s}'.replace('%s',style.hover);if(self.groupParams.getValue('hover')=='slide'||(colorBorder.indexOf('gradient')!==-1||colorBgHover.indexOf('gradient')!==-1)){compiledStyle+=className+':after {background:'+colorBgHover+'!important;}'}
self.$style.text(compiledStyle)}}}(jQuery);!function($){var _window=window,_document=document;if(_window.$usof===undefined){return}
$usof.FormElmsPreview=function(container){this.init(container)};$usof.FormElmsPreview.prototype={init:function(container){this.$container=$(container);this.$group=this.$container.closest('.usof-form-group-item');this.$style=$('style:first',this.$group);this.$elms=$('> *',this.$container);this.group=this.$group.data('usofGroupParams')||{};this.dependsOn=['h1_font_family','h2_font_family','h3_font_family','h4_font_family','h5_font_family','h6_font_family','body_font_family',];if(this.group instanceof $usof.GroupParams&&this.group.hasOwnProperty('fields')){for(var i in this.group.fields){this.group.fields[i].on('change',this.applyStyle.bind(this))}}
this.applyStyle()},_getColorValue:function(name){if(this.group instanceof $usof.GroupParams&&this.group.fields[name]!==undefined&&this.group.fields[name].type==='color'&&this.group.fields[name].hasOwnProperty('getColorValue')){return this.group.fields[name].getColorValue()}
return ''},applyStyle:function(){var className='.usof-input-preview-elm',style={default:'',focus:''};var fieldFont=this.group.getValue('font'),typographyOptions=$usof.getData('typographyOptions')||{},fontFamily;if($.inArray(fieldFont,Object.keys(typographyOptions))!==-1){fontFamily=(typographyOptions[fieldFont]||{})['font-family']||((typographyOptions[fieldFont]||{}).default||{})['font-family']||''}else{fontFamily=fieldFont}
if(fontFamily!='none'&&fontFamily!=''){style.default+='font-family: '+fontFamily+'!important;'}
style.default+='font-size:'+this.group.getValue('font_size')+'!important;';style.default+='font-weight:'+this.group.getValue('font_weight')+'!important;';style.default+='letter-spacing:'+this.group.getValue('letter_spacing')+'!important;';style.default+='line-height:'+this.group.getValue('height')+'!important;';style.default+='padding: 0 '+this.group.getValue('padding')+'!important;';style.default+='border-radius:'+this.group.getValue('border_radius')+'!important;';style.default+='border-width:'+this.group.getValue('border_width')+'!important;';if(this._getColorValue('color_bg')){style.default+='background:'+this._getColorValue('color_bg')+'!important;'}
if(this._getColorValue('color_border')){style.default+='border-color:'+this._getColorValue('color_border')+'!important;'}
if(this._getColorValue('color_text')){style.default+='color:'+this._getColorValue('color_text')+'!important;'}
if(this._getColorValue('color_bg_focus')){style.focus+='background:'+this._getColorValue('color_bg_focus')+'!important;'}
if(this._getColorValue('color_border_focus')){style.focus+='border-color:'+this._getColorValue('color_border_focus')+'!important;'}
if(this._getColorValue('color_text_focus')){style.focus+='color:'+this._getColorValue('color_text_focus')+'!important;'}
if(this._getColorValue('color_shadow')!=''){style.default+='box-shadow:'+this.group.getValue('shadow_offset_h')+' '+this.group.getValue('shadow_offset_v')+' '+this.group.getValue('shadow_blur')+' '+this.group.getValue('shadow_spread')+' '+this._getColorValue('color_shadow')+' ';if($.inArray('1',this.group.getValue('shadow_inset'))!==-1){style.default+='inset'}
style.default+='!important;'}
if(this._getColorValue('color_shadow_focus')!=''||this._getColorValue('color_shadow')!=''){style.focus+='box-shadow:'+this.group.getValue('shadow_focus_offset_h')+' '+this.group.getValue('shadow_focus_offset_v')+' '+this.group.getValue('shadow_focus_blur')+' '+this.group.getValue('shadow_focus_spread')+' ';if(this._getColorValue('color_shadow_focus')!=''){style.focus+=this._getColorValue('color_shadow_focus')+' '}else{style.focus+=this._getColorValue('color_shadow')+' '}
if($.inArray('1',this.group.getValue('shadow_focus_inset'))!==-1){style.focus+='inset'}
style.focus+='!important;'}
var compiledStyle=className+'{%s}'.replace('%s',style.default);compiledStyle+=className+':focus{%s}'.replace('%s',style.focus);compiledStyle+='.usof-input-preview-select:after {';compiledStyle+='font-size:'+this.group.getValue('font_size')+';';compiledStyle+='margin: 0 '+this.group.getValue('padding')+';';compiledStyle+='color:'+this._getColorValue('color_text')+';';compiledStyle+='}';this.$style.text(compiledStyle)},}}(jQuery);jQuery(function($){function AutoOptimizeAssets(){this.assets={};this._data={action:'us_auto_optimize_assets'};this.$container=$('[data-name="optimize_assets_start"]');this.$button=$('.usof-button.type_auto_optimize',this.$container);this.$message=$('.usof-message.type_auto_optimize',this.$container);if(this.$button.is('[onclick]')){this._data=$.extend(this._data,this.$button[0].onclick()||{});this.$button.removeAttr('onclick')}
$('.usof-checkbox-list input[name="assets"]',this.$container).each(function(_,checkbox){this.assets[$(checkbox).attr('value')]=checkbox}.bind(this));this.$container.on('click','.usof-button.type_auto_optimize',this._events.clickButton.bind(this)).on('change','input[name="assets"]',this._events.clearMessage.bind(this))}
AutoOptimizeAssets.prototype={_events:{clickButton:function(e){if(!this.$button.hasClass('loading')){this.$button.addClass('loading');this._request.call(this,'request');this._events.clearMessage.call(this)}},clearMessage:function(e){this.$message.addClass('hidden').html('')}},_request:function(type){$.post($usof.ajaxUrl,$.extend(this._data,{type:type}),function(res){if(res.data.processing){this._request.call(this,'iteration')}else{this.$button.removeClass('loading');if($.trim(res.data.message)){this.showMessage.call(this,res.data.message)}
$('input[type="checkbox"]',this.$container).prop('checked',!1);if(res.data.used_assets){$.each(res.data.used_assets,function(_,asset_name){if(this.assets.hasOwnProperty(asset_name)){$(this.assets[asset_name]).prop('checked',!0)}}.bind(this));$usof.instance.valuesChanged.assets=res.data.assets_value;$usof.instance.save()}}}.bind(this),'json')},showMessage:function(html){this.$message.html(html).removeClass('hidden')}};$(new AutoOptimizeAssets)});!function($,undefined){var _window=window,_document=document;if(_window.$usof===undefined){return}
$usof.field.adobe_fonts={init:function(){var self=this;self.$btnAdobeFontsApply=self.$row.find('.usof-button.type_adobe_fonts_apply');self.$btnAdobeFontsReset=self.$row.find('.usof-button.type_adobe_fonts_reset');self.$typeKitIdField=self.$row.find('input[name="typekit_id"]');self.adobeFontsMessage=self.$row.find('.usof-message');self.$btnAdobeFontsApply.on('click',self.getAdobeFonts.bind(self));self.$btnAdobeFontsReset.on('click',self.resetAdobeFonts.bind(self));self.$typeKitIdField.on('change paste keyup',self.controlFields.bind(self));self.loadAdobeFonts();self.controlFields()},getAdobeFonts:function(){var self=this;self.saveChanges();self.$btnAdobeFontsApply.addClass('loading');self.$typeKitIdField.attr('disabled','');$.ajax({type:'POST',url:$usof.ajaxUrl,dataType:'json',data:{action:'usof_save_adobe_typekit',typekit_id:`${ self.$typeKitIdField.val() }`,},success:function(){location.reload()},error:function(response){self.$btnAdobeFontsApply.removeClass('loading');self.$typeKitIdField.removeAttr('disabled');self.adobeFontsMessage.addClass('status_error').text(response.responseJSON.message)},})},resetAdobeFonts:function(){var self=this;self.saveChanges();self.$btnAdobeFontsReset.addClass('loading');self.$typeKitIdField.attr('disabled','');$.ajax({type:'POST',url:$usof.ajaxUrl,dataType:'json',data:{action:'usof_reset_adobe_typekit',},success:function(){location.reload()}.bind(this)})},loadAdobeFonts:function(){var self=this;if(self.$typeKitIdField.val()){$('head').append('<link rel="stylesheet" href="https://use.typekit.net/'+self.$typeKitIdField.val()+'.css">')}},controlFields:function(){var self=this;if(!self.$typeKitIdField.val()){self.$btnAdobeFontsApply.attr('disabled','')}else{self.$btnAdobeFontsApply.removeAttr('disabled')}},saveChanges:function(){$usof.instance.save()}}}(jQuery)